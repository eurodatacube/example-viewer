{"version":1,"kind":"Notebook","sha256":"a79365eb0a94bfd2f5a3a91bce013c6f5ba6d45724050fe80d300c3753629296","slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.gran-chaco-phiweek","location":"/external_notebooks/eurodatacube/notebooks/notebooks/contributions/Gran_Chaco_phiweek.ipynb","dependencies":[],"frontmatter":{"title":"ESA EO \\phi- week 2020","content_includes_title":false,"kernelspec":{"name":"edc","display_name":"EDC 0.24.5 (Python3)","language":"python"},"github":"https://github.com/eurodatacube/example-viewer","subject":"Euro Data Cube Examples","numbering":{"title":{"offset":5}},"edit_url":"https://github.com/eurodatacube/example-viewer/blob/main/external_notebooks/eurodatacube/notebooks/notebooks/contributions/Gran_Chaco_phiweek.ipynb","thumbnail":"/example-viewer/build/80cee7db6cdc7002ceedda5689f889fa.jpeg","exports":[{"format":"ipynb","filename":"Gran_Chaco_phiweek.ipynb","url":"/example-viewer/build/Gran_Chaco_phiweek-0a12167056d46f4ba87469907cd871ff.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Side Event 2: Euro Data Cube - Hands-on Tutorial and Training Session","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AtoJyH0AtJ"}],"identifier":"side-event-2-euro-data-cube-hands-on-tutorial-and-training-session","label":"Side Event 2: Euro Data Cube - Hands-on Tutorial and Training Session","html_id":"side-event-2-euro-data-cube-hands-on-tutorial-and-training-session","implicit":true,"key":"jRByeiVnFk"},{"type":"thematicBreak","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"tsmPVhCa8r"}],"key":"TfoAuUR4GV"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"In the previous part of the session, you have already gained experience in navigating around the Euro Data Cube interface and using ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EFudiebmTK"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"GeoDB","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EUDWOnyA3C"}],"key":"ypUMc06Laz"},{"type":"text","value":". Now, we are going to show a use case example to demonstrate how you can combine some of what you have learnt with ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NWs9ESLi8s"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Sentinel Hub Services","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FZse7Nc5JO"}],"key":"gJBlnXB3S8"},{"type":"text","value":"!","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aYeEEWP21k"}],"key":"zBxAZyVCzB"}],"key":"sISsSVTKEK"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Use Case Example: Deforestation in the Gran Chaco Region","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GNbBSubc6T"}],"identifier":"use-case-example-deforestation-in-the-gran-chaco-region","label":"Use Case Example: Deforestation in the Gran Chaco Region","html_id":"use-case-example-deforestation-in-the-gran-chaco-region","implicit":true,"key":"X44qk9trHk"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"In this Jupyter Notebook we are going to investigate deforestation events happening in the Gran Chaco region that spans across parts of eastern Bolivia, western Paraguay, northern Argentina and a small part of the Brazilian state of Mato Grosso. The region has one of the highest rates of deforestation in the world, mainly linked to the expansion of cattle farming.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"LLdp3iXh3f"}],"key":"XxzPjC3Bu7"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"The following articles provide more context information on the subject: ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"YHkxQJKXd6"},{"type":"link","url":"https://earthobservatory.nasa.gov/images/146731/deforestation-in-argentinas-gran-chaco","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Deforestation in Argentina’s Gran Chaco\n","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"sDPno48HVt"}],"urlSource":"https://earthobservatory.nasa.gov/images/146731/deforestation-in-argentinas-gran-chaco","key":"xZULrGTyHd"},{"type":"text","value":", ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"mEF8HtYPkG"},{"type":"link","url":"https://earthobservatory.nasa.gov/images/92078/deforestation-in-paraguay","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Deforestation in Paraguay","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"yt91OKisB0"}],"urlSource":"https://earthobservatory.nasa.gov/images/92078/deforestation-in-paraguay","key":"NBUY9vmGIh"},{"type":"text","value":", ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"YoazYhSDuh"},{"type":"link","url":"https://www.worldwildlife.org/places/gran-chaco","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"WWF: Gran Chaco","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"DZPxgPVfw5"}],"urlSource":"https://www.worldwildlife.org/places/gran-chaco","key":"zhSDoTexhM"},{"type":"text","value":".","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"PHZoNdHSwZ"}],"key":"RV859yrfkk"}],"key":"Zch2vkBiBG"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"image","url":"/example-viewer/build/80cee7db6cdc7002ceedda5689f889fa.jpeg","alt":"Deforestation","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WQEDuqoRew","urlSource":"https://api.time.com/wp-content/uploads/2021/04/Amazon-Deforestation.jpg?w=800&quality=85"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Deforested areas in the rainforest, Brazil, on August 24, 2019. Carlos Fabal – AFP/Getty Images","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"WsN8XW7Im8"}],"key":"fx4Cf7p96P"}],"key":"PIe6RMRouy"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"break","key":"Nld154cMCf"},{"type":"paragraph","children":[{"type":"text","value":"Throughout the following examples we will see how to:","key":"JH6uMVWutQ"}],"key":"cHDWEbIXhV"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":4,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"request satellite imagery using the Python wrapper to the Sentinel Hub API service","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"UoenUqxcCj"}],"key":"VMdb6MPzVd"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"easily request metadata concerning images over a given area and time frame","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"JrnyuIlzJm"}],"key":"uqmzHo1U1y"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"extract basic statistical information for a given area and time frame","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"DoN0cZW9uP"}],"key":"BU9YbIMGaU"}],"key":"ckN0Z4He7h"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"First, we will access the ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"s758XxShOS"},{"type":"link","url":"http://www.globalforestwatch.org/about/","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Global Forest Watch","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"YqSwR0Lwxt"}],"urlSource":"http://www.globalforestwatch.org/about/","key":"rkmHeNGy16"},{"type":"text","value":" dataset (saved as a GeoDB in EDC) on deforestation in Gran Chaco. The original version can be downloaded ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"BB1Bjj1ASm"},{"type":"link","url":"https://data.globalforestwatch.org/datasets/gran-chaco-deforestation","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"here","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"Xco6qUXqET"}],"urlSource":"https://data.globalforestwatch.org/datasets/gran-chaco-deforestation","key":"JH57tSaQ7l"},{"type":"text","value":". The dataset, that runs from 2011 to early 2018, represents deforested areas as polygons, derived manually using 30-meter resolution Landsat images for the 55 scenes that cover the Gran Chaco.","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"KzfvnCrjPk"}],"key":"R8VKBcWh82"},{"type":"paragraph","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"To check the temporal and spatial accuracy of the polygons, we will select a small test subset in Paraguay and compare the polygons representing deforestation events in January 2018 to higher resolution Sentinel-2 images. In this section, we will see how to query data using Sentinel Hub’s python package, and how to get metadata from the Catalog API to select the correct images without wasting resources/time.","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"rIJXP8DGoQ"}],"key":"ZgGt1hzNf7"},{"type":"paragraph","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"We will then show you how to use the brand-new data fusion capabilities of Sentinel Hub services to mitigate the drawbacks of using optical sensors for deforestation detection.","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"HYo45HBWt2"}],"key":"JyrTbR8fa1"},{"type":"paragraph","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"Finally, we will investigate the time-series of Sentinel-2 images, deriving NDVI (Normalized Difference Vegetation Index) to see if the deforestation event can be automatically detected.","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"ooiWRj0z5z"}],"key":"M5SwCHGRLF"}],"key":"DyRsKZwbDs"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Load necessary libraries","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zhvGESsjyS"}],"identifier":"load-necessary-libraries","label":"Load necessary libraries","html_id":"load-necessary-libraries","implicit":true,"key":"rdDGKn5HZ8"}],"key":"tTPkFCBcBG"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# EDC\nfrom edc import setup_environment_variables\nfrom xcube_geodb.core.geodb import GeoDBClient\n\n# Sentinel Hub Py\nfrom sentinelhub import (SHConfig, BBox, bbox_to_dimensions, CRS, SentinelHubRequest, DataCollection, MimeType, FisRequest)\nfrom sentinelhub.geometry import Geometry\n\n# Utilities\nfrom pathlib import Path\nfrom oauthlib.oauth2 import BackendApplicationClient\nfrom requests_oauthlib import OAuth2Session\nfrom datetime import datetime as dt\nimport pandas as pd\nimport numpy as np\nimport tarfile\n\n# Geographical libraries\nimport geopandas\nfrom pyproj import Proj, transform\nfrom shapely.geometry import shape, box\nfrom shapely.ops import unary_union\n\n# Plotting\nimport IPython\nimport matplotlib.pyplot as plt\nimport matplotlib.dates as mdates\nimport matplotlib.ticker as ticker\nimport matplotlib.gridspec as gridspec\nfrom matplotlib import colors\nimport matplotlib.patches as mpatches\nfrom mpl_toolkits.axes_grid1.inset_locator import inset_axes\n\n# Rasterio\nimport rasterio\nfrom rasterio.plot import show\nimport rasterio.features\nfrom scipy.ndimage import morphology","key":"kaKqyEf2U9"},{"type":"output","id":"j_Ys1U4ciGakrTmC9ASpE","data":[],"key":"VgglFM4OnK"}],"key":"pB3GXconbB"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Setup environment variables","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gSKm4y4o6E"}],"identifier":"setup-environment-variables","label":"Setup environment variables","html_id":"setup-environment-variables","implicit":true,"key":"MWP2CkVn7e"}],"key":"TkTyZQjN6h"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"There are several options to set up your Sentinel Hub credentials, depending on how you want to access the services. In this workflow, as we will be working with the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"psL1LfSh1L"},{"type":"inlineCode","value":"sentinelhub-py","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KQG0o7kFFY"},{"type":"text","value":" package to run requests in Python, we set up an ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"m2WZ00yV1p"},{"type":"inlineCode","value":"SHConfig","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Esu26cgdD4"},{"type":"text","value":" object that will take care of identification with the services for us. Therefore, we assign the identification parameters provided by EDC to the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZBJJv5eWTL"},{"type":"inlineCode","value":"SHConfig","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"utEsDlmBOT"},{"type":"text","value":" object.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aKFC6PJIrl"}],"key":"oJHPi0BJXZ"}],"key":"nnLOQ9eymk"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# Get identification parameters from EDC\nsetup_environment_variables()\n\n# Assign environement variables for later use\nsh_client_id = %env SH_CLIENT_ID\nsh_client_secret = %env SH_CLIENT_SECRET\nsh_instance_id = %env SH_INSTANCE_ID\n\n# Setup SH services access\nconfig = SHConfig()\n\nconfig.sh_client_id = sh_client_id\nconfig.sh_client_secret = sh_client_secret\nconfig.instance_id = sh_instance_id","key":"Lt9cPpLGPd"},{"type":"output","id":"8LBVHVna-NJVCpWIKEnZ1","data":[{"output_type":"display_data","metadata":{},"data":{"text/markdown":{"content":"API credentials have automatically been injected for your active subscriptions.  \nThe following environment variables are now available:\n* `GEODB_API_SERVER_PORT`, `GEODB_API_SERVER_URL`, `GEODB_AUTH_AUD`, `GEODB_AUTH_CLIENT_ID`, `GEODB_AUTH_CLIENT_SECRET`, `GEODB_AUTH_DOMAIN`\n* `SH_CLIENT_ID`, `SH_CLIENT_NAME`, `SH_CLIENT_SECRET`, `SH_INSTANCE_ID`\n\nThe following additional environment variables have been loaded from `~/custom.env`:\n* `maxar_collection`\n* `planet_collection`\n* `pleiades_collection`\n* `s1grd_collection`\n* `spot_collection`\n","content_type":"text/markdown"},"text/plain":{"content":"<IPython.core.display.Markdown object>","content_type":"text/plain"}}}],"key":"c20nQrnvuE"}],"key":"EoqtrRNBCV"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Next, we set up access to the GeoDB, using ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DQv0YSbV4M"},{"type":"inlineCode","value":"GeoDBClient","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZRKmvZoPFq"},{"type":"text","value":" as shown in the previous section of this training session.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WFOOmrTzRN"}],"key":"vZEPFrOWiI"}],"key":"GVV3aGVvSF"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"geodb = GeoDBClient()","key":"xZMjRxxpgw"},{"type":"output","id":"8uRk3cAA6nv-_EvDFLGlZ","data":[],"key":"InNSalkVkC"}],"key":"IX3dfKrFq5"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gdu29FmSOu"}],"key":"qRNtPrePj5"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Request a truecolor image as overview of the selected area","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lAinlCtZVD"}],"identifier":"request-a-truecolor-image-as-overview-of-the-selected-area","label":"Request a truecolor image as overview of the selected area","html_id":"request-a-truecolor-image-as-overview-of-the-selected-area","implicit":true,"key":"fXNhHkEQZn"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Now that the credentials are set up, it is possible to request satellite images.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"XJmQbf9tkh"}],"key":"zg0lX5kndF"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"We will start by plotting an overview True Color RBG image from Sentinel-2 of the area that we will be working on.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"gT9luBMBXf"}],"key":"NGgKoBWPa0"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"DFyHhmBiD9"},{"type":"emphasis","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Sentinel Hub Process API","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"r0yvVEeHTA"}],"key":"hBPaXNzvzt"},{"type":"text","value":" will need the following information for a valid request:","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"slLTZeKZd3"}],"key":"HuVbWKfmk6"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":9,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"An ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"OVbqf75HOh"},{"type":"strong","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"AOI","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"AcQLm5ukrr"}],"key":"cbGzdZn6WC"},{"type":"text","value":" (area of interest): that contains the location’s coordinates (polygon or bounding box). The image size is pre-calculated according to the resolution desired.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"liotQIRgjn"}],"key":"dm0sNdF1M2"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"strong","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Evalscript","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"rd9nPN3cd4"}],"key":"DAg681Cjq1"},{"type":"text","value":" in which you specify the data products and their visualisation","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"on4Dh5uEpT"}],"key":"T4ReA5Q6pC"},{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"strong","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Request body","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"MFqQ1oiZiY"}],"key":"Sh3X3fRm8i"},{"type":"text","value":" with parameters about the location and time","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"Za9kdBnBMk"}],"key":"bY6KTenmns"}],"key":"KRxpWa1zu8"}],"key":"yDKcHbeblm"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Define coordinates for area of interest and create a bbox object","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YdY33cSPDY"}],"identifier":"define-coordinates-for-area-of-interest-and-create-a-bbox-object","label":"Define coordinates for area of interest and create a bbox object","html_id":"define-coordinates-for-area-of-interest-and-create-a-bbox-object","implicit":true,"key":"Eh4ykTvjT1"}],"key":"fCmThyx3o9"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# Select the coordinates (lower-left, upper right) of our AOI\naoi_bbox = [-60.28157336, -21.27560428, -60.12293070, -21.18495133]\n\n# Set AOI overview bbox\nresolution = 10\naoi_overview = BBox(bbox=aoi_bbox, crs=CRS.WGS84)  # Make a BBox object of the list of coordinates\naoi_overview_size = bbox_to_dimensions(aoi_overview, resolution=resolution)  # Automatically calculate the output size in px\n\nprint(f\"Output image size: {aoi_overview_size[0]} * {aoi_overview_size[1]} px\")","key":"jJe8x78isM"},{"type":"output","id":"RmKd-RGt79nrnqfsjCUy5","data":[{"name":"stdout","output_type":"stream","text":"Output image size: 1665 * 975 px\n"}],"key":"erECeDYyO0"}],"key":"GVWivIgrYZ"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Evalscript creation","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"f3fDnOnArm"}],"identifier":"evalscript-creation","label":"Evalscript creation","html_id":"evalscript-creation","implicit":true,"key":"DyUVplRkKK"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"An ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ZHseTBsra1"},{"type":"link","url":"https://docs.sentinel-hub.com/api/latest/evalscript/v3/","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Evalscript","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"bq6RdMvYyd"}],"urlSource":"https://docs.sentinel-hub.com/api/latest/evalscript/v3/","key":"cQV0YnEql4"},{"type":"text","value":" is a piece of Javascript code that allows you to define the input and output parameters of the data you would like to query, as well as specifying the processing to be applied to the satellite images.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"oPBYY5OHGs"}],"key":"g3yOB91coL"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"For the evalscript you must specify at least the two following functions:","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"W0BkPWECnT"}],"key":"hu37Oq9zXG"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":7,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"setup function: this sets up the input (i.e. which bands to call) and output settings (number of bands to return, format, etc...).","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"IFzoSFgVLT"}],"key":"cZM2N036DW"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"evaluatePixel function - this function is where you specify the processing (to derive new information from the images, or for visualisation) to be applied to the images.","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"fNE2IBk7Nb"}],"key":"pzht9PpgcQ"}],"key":"KyEOdyA9xo"}],"key":"CXw6RRO9w6"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"In the following Evalscript, we want to return an RGB True Color image. In the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UjLvzHyQd8"},{"type":"inlineCode","value":"setup","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MTq44LPP2Z"},{"type":"text","value":" function, we will specify that we want to use the Red (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ExBUeUtqj1"},{"type":"inlineCode","value":"B04","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fRRPV2WBqs"},{"type":"text","value":"), Green (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OPD8vci137"},{"type":"inlineCode","value":"B03","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IbNMuuRrAO"},{"type":"text","value":") and Blue (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Yn6qRBVfI6"},{"type":"inlineCode","value":"B02","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yEEcaYvLVu"},{"type":"text","value":") bands of Sentinel-2. Since we want a three-channel image (RGB), we specify that our output will have three bands. We use the convenient ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xEg9Qtpt2Q"},{"type":"inlineCode","value":"AUTO","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yJI7c5lxG4"},{"type":"text","value":" sample type for the returned data, as we are just going to visualise it. With ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UY1JcaXfoq"},{"type":"inlineCode","value":"AUTO","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"y6ZEuaKmPP"},{"type":"text","value":" values should range from 0-1, which will then automatically be stretched from the interval [0, 1] to [0, 255] and written into a UINT8 raster.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BYHAdQ7UqX"}],"key":"DfhhfMsBfy"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Because the image would be too dark if we return directly the band values scaled from 0 to 255, we apply a gain (multiplying the values by 3.5). This is just for visualisation purposes.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"THzhSFb9pM"}],"key":"aMzFudGmHg"}],"key":"V0XkxapgnG"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"evalscript_true_color = \"\"\"\n//VERSION=3\n\n// Set up the input and output settings\n\nfunction setup() {\n  return {\n    input: [\"B02\", \"B03\", \"B04\"],  //define input bands\n    output: { bands: 3, sampleType: SampleType.AUTO}  //define amount of channels in output image (RGB = 3)\n  };\n}\n\n// Map the input bands to the values in the output raster\n\nfunction evaluatePixel(sample) {\n  let gain = 3.5;\n  return [gain * sample.B04, gain * sample.B03, gain * sample.B02];    //map bands 4, 3, 2 to RGB channels and multiply by 3.5 for enhanced truecolor visualisation\n}\n\"\"\"","key":"ETJIUSadGI"},{"type":"output","id":"-NeLOQwpwLiHPjcJukxrx","data":[],"key":"nOsVeC6OdD"}],"key":"bBpcloZbji"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Request body creation","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uOD3iv5GNp"}],"identifier":"request-body-creation","label":"Request body creation","html_id":"request-body-creation","implicit":true,"key":"VPvnOfVcBI"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The run the Evalscript, we need to define the payload, or data parameters to send to Sentinel Hub Services. The Sentinel Hub python package simplifies the writing of the payload, by using the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"SCKiVWG7KG"},{"type":"inlineCode","value":"SentinelHubRequest","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ZN7NahC3GO"},{"type":"text","value":" class to pass the following input parameters:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"UZsOTpquUH"}],"key":"kZzdDuRUW2"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"the created evalscript","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"TQA68axG2o"}],"key":"E0vmjMYevQ"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"input data (data source and time interval)","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"wxwUhPkiLN"}],"key":"cGWwPDswnB"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"define the output (name and format)","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"l5uVv7fTZX"}],"key":"J9fNi7mWA3"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"define bbox","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"moxshYRWWA"}],"key":"CnR19BskIL"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"size of the requested image","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"Y79QPuqVMH"}],"key":"Orr8I15r4z"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"identification with the SHConfig object","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"t5wBQVCidA"}],"key":"lOI2l9Pnfz"}],"key":"XVvkwYfh8u"}],"key":"TtobCj1jX4"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"request = SentinelHubRequest(evalscript=evalscript_true_color,\n                             input_data=[SentinelHubRequest.input_data(data_collection=DataCollection.SENTINEL2_L2A,\n                                                                       time_interval=(\"2017-12-31\",\n                                                                                      \"2017-12-31\"))],\n                            responses=[SentinelHubRequest.output_response('default', MimeType.TIFF)],\n                            bbox=aoi_overview,  \n                            size=aoi_overview_size,\n                            config=config)","key":"GGLb0yND9q"},{"type":"output","id":"gmA2XzgUH6RDwTbjogueW","data":[],"key":"jYWBMKk9q6"}],"key":"eQujLT00bS"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now that the request is created, we just need to run it using the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AtJrZBlSxs"},{"type":"inlineCode","value":"get_data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"J8tRfQcL1p"},{"type":"text","value":" method.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZDAIfqniXx"}],"key":"qrlqNlYw1T"}],"key":"GJrZU5ahcO"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"overview = request.get_data()","key":"MRCpp4tbVL"},{"type":"output","id":"AYWYUwYut9SoR5MFoz9QD","data":[],"key":"YWtDPZKLwP"}],"key":"psbjVKrExj"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Plot the requested image","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"F3QHkqdw61"}],"identifier":"plot-the-requested-image","label":"Plot the requested image","html_id":"plot-the-requested-image","implicit":true,"key":"lckXp8DxfY"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"By using ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"e0WW9XzFXX"},{"type":"inlineCode","value":"get_data","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"r9hcFUVHhb"},{"type":"text","value":" without any additional parameters saved the results to the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"dFuSwntFjF"},{"type":"inlineCode","value":"overview","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"plh43p062F"},{"type":"text","value":" variable. Let’s plot it to look at the returned data.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ZnqPl2Bd9I"}],"key":"ag3Sd7piyu"}],"key":"IEMDjGwXLs"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"fig, ax = plt.subplots(nrows=1, ncols=1, figsize=(15,10))\nax.imshow(overview[0])\n\n# Plot configuration\nax.set_xticks([])\nax.set_yticks([])\nax.set_title(\"2017-12-31\")\n\nplt.show()","key":"sFub8SiczG"},{"type":"output","id":"7gRC7LtXg7u-hafx-OkBA","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"624ff3ddb27f08391f6ebb848f696516","path":"/example-viewer/build/624ff3ddb27f08391f6ebb848f696516.png"},"text/plain":{"content":"<Figure size 1500x1000 with 1 Axes>","content_type":"text/plain"}}}],"key":"FXNeHFFeKH"}],"key":"MwQkcOWwil"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Quizz: can you figure out how to request a falsecolor infrared image?","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wfeNbNHvNd"}],"identifier":"quizz-can-you-figure-out-how-to-request-a-falsecolor-infrared-image","label":"Quizz: can you figure out how to request a falsecolor infrared image?","html_id":"quizz-can-you-figure-out-how-to-request-a-falsecolor-infrared-image","implicit":true,"key":"vDbTHWJgyO"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Try to fill in the gaps in the evalscript below.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"ETx25InCxi"}],"key":"QbpqnrTpxf"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Hint: To receive a falsecolor infrared image you need to map Sentinel-2 Band 8 (NIR) to the red channel, Band 4 (RED) to the green channel, and Band 3 (GREEN) to the blue channel","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"jnyORTDwyD"}],"key":"HiJsngeZWq"},{"type":"text","value":".","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"HQC0RtWMP6"}],"key":"iKHffa4YoP"}],"key":"vjc2J0EMfe"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"evalscript_false_color = \"\"\"\n//VERSION=3\n\nfunction setup() {\n  return {\n    input: [\"\", \"\", \"\"],\n    output: { bands: 3 }\n  };\n}\n\nfunction evaluatePixel(sample) {\n  let gain = 2.5;\n  return [ , , ];\n}\n\"\"\"","key":"BELKMMUOjB"},{"type":"output","id":"FQbu5sKZqUK822CLejZ0H","data":[],"key":"Rag7DwIKF3"}],"key":"rPVGdqKcdU"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Uncomment the following cell for the solution. Make sure to run the following cell twice, one time for fetching the solution and a second time for running the Evalscript.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GKmn8XyeaT"}],"key":"wyZ4e4J7Hb"}],"key":"Ss1Q0qQvYK"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# %load https://raw.githubusercontent.com/sentinel-hub/code-snippets/master/phiweek2020/Solution.py","key":"QWnMraJuK4"},{"type":"output","id":"9Avanu8Cu1gfWtFIglpMM","data":[],"key":"wAv5GKRrRz"}],"key":"x40fJEmW6P"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now that we have the Evalscript, let’s run the request:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"z0cnEIaO6c"}],"key":"RTyJmhI0zb"}],"key":"MZ0jdDdafD"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"request = SentinelHubRequest(evalscript=evalscript_false_color,\n                             input_data=[SentinelHubRequest.input_data(data_collection=DataCollection.SENTINEL2_L2A,\n                                                                       time_interval=(\"2017-12-31\",\n                                                                                      \"2017-12-31\"))],\n                            responses=[SentinelHubRequest.output_response('default', MimeType.TIFF)],\n                            bbox=aoi_overview,  \n                            size=aoi_overview_size,\n                            config=config)\n\noverview_fc = request.get_data()","key":"BSVgRDhpTS"},{"type":"output","id":"4bWv9uvyPhcjk3ZJE-iDK","data":[],"key":"cQpDIoTSP8"}],"key":"TkzvSXtpD9"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Plot the False Color image","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XwYbAf0lJY"}],"identifier":"plot-the-false-color-image","label":"Plot the False Color image","html_id":"plot-the-false-color-image","implicit":true,"key":"giGmhfMTsd"}],"key":"uwm71B9tl8"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"fig, ax = plt.subplots(nrows=1, ncols=1, figsize=(15,10))\nax.imshow(overview_fc[0])\n\n# Plot configuration\nax.set_xticks([])\nax.set_yticks([])\nax.set_title(\"2017-12-31\")\n\nplt.show()","key":"VydznGWrfC"},{"type":"output","id":"PcUIb3jS9pg5bRftJcVxk","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"ad2542ac2be7795d1c9a00bd8aac2224","path":"/example-viewer/build/ad2542ac2be7795d1c9a00bd8aac2224.png"},"text/plain":{"content":"<Figure size 1500x1000 with 1 Axes>","content_type":"text/plain"}}}],"key":"fBlpCWy4fY"}],"key":"AvFVqtPvV8"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ph2GvpqJw4"}],"key":"Z0HzKARhL9"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Get the collection from GeoDB and data preparation","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cRzPJPzGcA"}],"identifier":"get-the-collection-from-geodb-and-data-preparation","label":"Get the collection from GeoDB and data preparation","html_id":"get-the-collection-from-geodb-and-data-preparation","implicit":true,"key":"yIMsqkI0il"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"In the next step we retrieve the prepared gran_chaco collection from GeoDB.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"WzhN9SRO2E"}],"key":"qmekmSpxtF"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"As a reminder, you can explore the original dataset ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"PtwBPsctzW"},{"type":"link","url":"https://data.globalforestwatch.org/datasets/gran-chaco-deforestation/data?geometry=-60.601%2C-20.023%2C-59.293%2C-19.797","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"here","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"V2OOEQf8I3"}],"urlSource":"https://data.globalforestwatch.org/datasets/gran-chaco-deforestation/data?geometry=-60.601%2C-20.023%2C-59.293%2C-19.797","key":"MGajN4WmxZ"},{"type":"text","value":".","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"PX0OHm4oUv"}],"key":"Lh63UQhOkU"}],"key":"AUE8R01YBY"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Check available collections in GeoDB","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ixbiQ8YDhP"}],"identifier":"check-available-collections-in-geodb","label":"Check available collections in GeoDB","html_id":"check-available-collections-in-geodb","implicit":true,"key":"xjtYNoKCbY"}],"key":"I7mcLtj1bq"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Using the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"J2rB59Her6"},{"type":"inlineCode","value":"geodb","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"c9hlrf9VlW"},{"type":"text","value":" client, let’s look at what collections are available.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IYGHhdGTVf"}],"key":"rVGgspJ7mK"}],"key":"thspTeKgM3"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# Lets get already existing collections\ngeodb.get_my_collections()","key":"vvG0Rfa5HV"},{"type":"output","id":"z2MB1_aCC2UVoepp5T2BS","data":[{"output_type":"execute_result","execution_count":13,"metadata":{},"data":{"text/html":{"content":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>owner</th>\n      <th>database</th>\n      <th>table_name</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>geodb_0b01bfcd-2d09-46f8-84e8-cb5720fba14c</td>\n      <td>geodb_0b01bfcd-2d09-46f8-84e8-cb5720fba14c</td>\n      <td>delineated_parcels_s</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>geodb_0b01bfcd-2d09-46f8-84e8-cb5720fba14c</td>\n      <td>geodb_0b01bfcd-2d09-46f8-84e8-cb5720fba14c</td>\n      <td>test_batic</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>geodb_0b01bfcd-2d09-46f8-84e8-cb5720fba14c</td>\n      <td>phi_week</td>\n      <td>alster</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>geodb_0b01bfcd-2d09-46f8-84e8-cb5720fba14c</td>\n      <td>phi_week</td>\n      <td>gran_chaco</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>geodb_0d6df427-8c09-41b9-abc9-64ce13a68125</td>\n      <td>geodb_0d6df427-8c09-41b9-abc9-64ce13a68125</td>\n      <td>land_use</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>865</th>\n      <td>geodb_lpis_iacs_admin</td>\n      <td>anja</td>\n      <td>N4a</td>\n    </tr>\n    <tr>\n      <th>866</th>\n      <td>geodb_lpis_iacs_admin</td>\n      <td>anja</td>\n      <td>race_indicators</td>\n    </tr>\n    <tr>\n      <th>867</th>\n      <td>geodb_lpis_iacs_admin</td>\n      <td>lpis_iacs</td>\n      <td>land_use_slo</td>\n    </tr>\n    <tr>\n      <th>868</th>\n      <td>geodb_lpis_iacs_admin</td>\n      <td>lpis_iacs</td>\n      <td>lpis_aut</td>\n    </tr>\n    <tr>\n      <th>869</th>\n      <td>geodb_lpis_iacs_admin</td>\n      <td>lpis_iacs</td>\n      <td>lpis_slo</td>\n    </tr>\n  </tbody>\n</table>\n<p>870 rows × 3 columns</p>\n</div>","content_type":"text/html"},"text/plain":{"content":"                                          owner  \\\n0    geodb_0b01bfcd-2d09-46f8-84e8-cb5720fba14c   \n1    geodb_0b01bfcd-2d09-46f8-84e8-cb5720fba14c   \n2    geodb_0b01bfcd-2d09-46f8-84e8-cb5720fba14c   \n3    geodb_0b01bfcd-2d09-46f8-84e8-cb5720fba14c   \n4    geodb_0d6df427-8c09-41b9-abc9-64ce13a68125   \n..                                          ...   \n865                       geodb_lpis_iacs_admin   \n866                       geodb_lpis_iacs_admin   \n867                       geodb_lpis_iacs_admin   \n868                       geodb_lpis_iacs_admin   \n869                       geodb_lpis_iacs_admin   \n\n                                       database            table_name  \n0    geodb_0b01bfcd-2d09-46f8-84e8-cb5720fba14c  delineated_parcels_s  \n1    geodb_0b01bfcd-2d09-46f8-84e8-cb5720fba14c            test_batic  \n2                                      phi_week                alster  \n3                                      phi_week            gran_chaco  \n4    geodb_0d6df427-8c09-41b9-abc9-64ce13a68125              land_use  \n..                                          ...                   ...  \n865                                        anja                   N4a  \n866                                        anja       race_indicators  \n867                                   lpis_iacs          land_use_slo  \n868                                   lpis_iacs              lpis_aut  \n869                                   lpis_iacs              lpis_slo  \n\n[870 rows x 3 columns]","content_type":"text/plain"}}}],"key":"J3Hak4Ustf"}],"key":"jYQoyfTo9J"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Query the collection by bbox to retrieve only the area we are interested in","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FVMynq37J8"}],"identifier":"query-the-collection-by-bbox-to-retrieve-only-the-area-we-are-interested-in","label":"Query the collection by bbox to retrieve only the area we are interested in","html_id":"query-the-collection-by-bbox-to-retrieve-only-the-area-we-are-interested-in","implicit":true,"key":"zAnBF0OgdE"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We are interested in the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"WUmYoqFn0l"},{"type":"inlineCode","value":"gran_chaco","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"lyZYstO6WQ"},{"type":"text","value":" GeoDB collection. However, we will not query it entirely in this exercise since we are only interested in a specific AOI that we defined further up. Therefore, not needing the whole dataset, we only retrieve the polygons that are contained in our area of interest by querying the dataset with our defined bbox.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"mfZ7Ow6AxO"}],"key":"x64O81uDql"}],"key":"ZmjFPYMewR"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"gran_chaco = geodb.get_collection_by_bbox('gran_chaco', database=\"phi_week\", bbox=aoi_bbox, bbox_crs=4326, comparison_mode=\"contains\")","key":"fFUh7MZfX2"},{"type":"output","id":"7U73FPy2VizgDLTUQgmgS","data":[],"key":"EsNE62RVNJ"}],"key":"MnspPQVGpS"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Let’s preview the collection subset that we have just queried.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YdNENE6P4c"}],"key":"ienGO5Mfi6"}],"key":"J8R0J52TyK"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"gran_chaco","key":"ciBdpnfOzL"},{"type":"output","id":"f6USANlvSwMjBQdXZYhcZ","data":[{"output_type":"execute_result","execution_count":15,"metadata":{},"data":{"text/html":{"content":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>id</th>\n      <th>created_at</th>\n      <th>modified_at</th>\n      <th>geometry</th>\n      <th>objectid</th>\n      <th>field_id</th>\n      <th>pais</th>\n      <th>prov_dep</th>\n      <th>municipios</th>\n      <th>date</th>\n      <th>shape_leng</th>\n      <th>shape_area</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>9333</td>\n      <td>2020-09-25T07:57:39.568135+00:00</td>\n      <td>None</td>\n      <td>POLYGON ((-60.26329 -21.27054, -60.26325 -21.2...</td>\n      <td>7784</td>\n      <td>9333</td>\n      <td>Paraguay</td>\n      <td>Boquerón</td>\n      <td>FILADELFIA</td>\n      <td>2011-12-31</td>\n      <td>3203.541559</td>\n      <td>5.661000e+05</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>9347</td>\n      <td>2020-09-25T07:57:39.568135+00:00</td>\n      <td>None</td>\n      <td>POLYGON ((-60.26322 -21.23245, -60.26334 -21.2...</td>\n      <td>7798</td>\n      <td>9347</td>\n      <td>Paraguay</td>\n      <td>Boquerón</td>\n      <td>FILADELFIA</td>\n      <td>2011-12-31</td>\n      <td>23061.565888</td>\n      <td>4.140725e+06</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>40758</td>\n      <td>2020-09-25T07:57:44.48827+00:00</td>\n      <td>None</td>\n      <td>POLYGON ((-60.26381 -21.25916, -60.26376 -21.2...</td>\n      <td>32303</td>\n      <td>40758</td>\n      <td>Paraguay</td>\n      <td>Boquerón</td>\n      <td>FILADELFIA</td>\n      <td>2014-10-31</td>\n      <td>247.465000</td>\n      <td>1.491147e+03</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>40763</td>\n      <td>2020-09-25T07:57:44.48827+00:00</td>\n      <td>None</td>\n      <td>POLYGON ((-60.26370 -21.25423, -60.26392 -21.2...</td>\n      <td>32308</td>\n      <td>40763</td>\n      <td>Paraguay</td>\n      <td>Boquerón</td>\n      <td>FILADELFIA</td>\n      <td>2014-10-31</td>\n      <td>156.980834</td>\n      <td>8.272126e+02</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>40768</td>\n      <td>2020-09-25T07:57:44.48827+00:00</td>\n      <td>None</td>\n      <td>POLYGON ((-60.26354 -21.24383, -60.26380 -21.2...</td>\n      <td>32313</td>\n      <td>40768</td>\n      <td>Paraguay</td>\n      <td>Boquerón</td>\n      <td>FILADELFIA</td>\n      <td>2014-10-31</td>\n      <td>244.941473</td>\n      <td>2.648666e+03</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>40770</td>\n      <td>2020-09-25T07:57:44.48827+00:00</td>\n      <td>None</td>\n      <td>POLYGON ((-60.26355 -21.23751, -60.26350 -21.2...</td>\n      <td>32315</td>\n      <td>40770</td>\n      <td>Paraguay</td>\n      <td>Boquerón</td>\n      <td>FILADELFIA</td>\n      <td>2014-10-31</td>\n      <td>258.094701</td>\n      <td>2.089448e+03</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>58546</td>\n      <td>2020-09-25T07:57:45.943354+00:00</td>\n      <td>None</td>\n      <td>POLYGON ((-60.19709 -21.20089, -60.19801 -21.2...</td>\n      <td>42365</td>\n      <td>58546</td>\n      <td>Paraguay</td>\n      <td>Boquerón</td>\n      <td>FILADELFIA</td>\n      <td>2015-10-31</td>\n      <td>35369.274281</td>\n      <td>5.651093e+06</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>58548</td>\n      <td>2020-09-25T07:57:45.943354+00:00</td>\n      <td>None</td>\n      <td>POLYGON ((-60.17358 -21.19005, -60.17543 -21.1...</td>\n      <td>42365</td>\n      <td>58548</td>\n      <td>Paraguay</td>\n      <td>Boquerón</td>\n      <td>FILADELFIA</td>\n      <td>2015-10-31</td>\n      <td>35369.274281</td>\n      <td>5.651093e+06</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>66517</td>\n      <td>2020-09-25T07:57:47.16828+00:00</td>\n      <td>None</td>\n      <td>POLYGON ((-60.23363 -21.25623, -60.24235 -21.2...</td>\n      <td>42700</td>\n      <td>66517</td>\n      <td>Paraguay</td>\n      <td>Boquerón</td>\n      <td>FILADELFIA</td>\n      <td>2016-06-30</td>\n      <td>63232.505444</td>\n      <td>1.189560e+07</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>66518</td>\n      <td>2020-09-25T07:57:47.16828+00:00</td>\n      <td>None</td>\n      <td>POLYGON ((-60.23382 -21.26173, -60.25247 -21.2...</td>\n      <td>42700</td>\n      <td>66518</td>\n      <td>Paraguay</td>\n      <td>Boquerón</td>\n      <td>FILADELFIA</td>\n      <td>2016-06-30</td>\n      <td>63232.505444</td>\n      <td>1.189560e+07</td>\n    </tr>\n    <tr>\n      <th>10</th>\n      <td>68177</td>\n      <td>2020-09-25T07:57:47.16828+00:00</td>\n      <td>None</td>\n      <td>POLYGON ((-60.23342 -21.26788, -60.23342 -21.2...</td>\n      <td>42806</td>\n      <td>68177</td>\n      <td>Paraguay</td>\n      <td>Boquerón</td>\n      <td>FILADELFIA</td>\n      <td>2016-08-31</td>\n      <td>54236.171652</td>\n      <td>1.099213e+07</td>\n    </tr>\n    <tr>\n      <th>11</th>\n      <td>68188</td>\n      <td>2020-09-25T07:57:47.16828+00:00</td>\n      <td>None</td>\n      <td>POLYGON ((-60.23990 -21.26734, -60.25252 -21.2...</td>\n      <td>42806</td>\n      <td>68188</td>\n      <td>Paraguay</td>\n      <td>Boquerón</td>\n      <td>FILADELFIA</td>\n      <td>2016-08-31</td>\n      <td>54236.171652</td>\n      <td>1.099213e+07</td>\n    </tr>\n    <tr>\n      <th>12</th>\n      <td>68189</td>\n      <td>2020-09-25T07:57:47.16828+00:00</td>\n      <td>None</td>\n      <td>POLYGON ((-60.22272 -21.27312, -60.23180 -21.2...</td>\n      <td>42806</td>\n      <td>68189</td>\n      <td>Paraguay</td>\n      <td>Boquerón</td>\n      <td>FILADELFIA</td>\n      <td>2016-08-31</td>\n      <td>54236.171652</td>\n      <td>1.099213e+07</td>\n    </tr>\n    <tr>\n      <th>13</th>\n      <td>69469</td>\n      <td>2020-09-25T07:57:47.16828+00:00</td>\n      <td>None</td>\n      <td>POLYGON ((-60.23374 -21.26714, -60.23990 -21.2...</td>\n      <td>42911</td>\n      <td>69469</td>\n      <td>Paraguay</td>\n      <td>Boquerón</td>\n      <td>FILADELFIA</td>\n      <td>2016-09-30</td>\n      <td>46417.194449</td>\n      <td>7.108902e+06</td>\n    </tr>\n    <tr>\n      <th>14</th>\n      <td>69474</td>\n      <td>2020-09-25T07:57:47.16828+00:00</td>\n      <td>None</td>\n      <td>POLYGON ((-60.23157 -21.26809, -60.23164 -21.2...</td>\n      <td>42911</td>\n      <td>69474</td>\n      <td>Paraguay</td>\n      <td>Boquerón</td>\n      <td>FILADELFIA</td>\n      <td>2016-09-30</td>\n      <td>46417.194449</td>\n      <td>7.108902e+06</td>\n    </tr>\n    <tr>\n      <th>15</th>\n      <td>70590</td>\n      <td>2020-09-25T07:57:48.497587+00:00</td>\n      <td>None</td>\n      <td>POLYGON ((-60.23386 -21.25709, -60.23372 -21.2...</td>\n      <td>42965</td>\n      <td>70590</td>\n      <td>Paraguay</td>\n      <td>Boquerón</td>\n      <td>FILADELFIA</td>\n      <td>2016-11-30</td>\n      <td>96005.066733</td>\n      <td>1.744413e+07</td>\n    </tr>\n    <tr>\n      <th>16</th>\n      <td>70591</td>\n      <td>2020-09-25T07:57:48.497587+00:00</td>\n      <td>None</td>\n      <td>POLYGON ((-60.24358 -21.25610, -60.25239 -21.2...</td>\n      <td>42965</td>\n      <td>70591</td>\n      <td>Paraguay</td>\n      <td>Boquerón</td>\n      <td>FILADELFIA</td>\n      <td>2016-11-30</td>\n      <td>96005.066733</td>\n      <td>1.744413e+07</td>\n    </tr>\n    <tr>\n      <th>17</th>\n      <td>75456</td>\n      <td>2020-09-25T07:57:48.497587+00:00</td>\n      <td>None</td>\n      <td>POLYGON ((-60.21706 -21.27261, -60.22272 -21.2...</td>\n      <td>43184</td>\n      <td>75456</td>\n      <td>Paraguay</td>\n      <td>Boquerón</td>\n      <td>FILADELFIA</td>\n      <td>2017-03-31</td>\n      <td>284316.143820</td>\n      <td>4.828256e+07</td>\n    </tr>\n    <tr>\n      <th>18</th>\n      <td>86719</td>\n      <td>2020-09-25T07:57:49.678146+00:00</td>\n      <td>None</td>\n      <td>POLYGON ((-60.17380 -21.19416, -60.16402 -21.1...</td>\n      <td>43679</td>\n      <td>86719</td>\n      <td>Paraguay</td>\n      <td>Boquerón</td>\n      <td>FILADELFIA</td>\n      <td>2017-12-31</td>\n      <td>174512.220879</td>\n      <td>3.070367e+07</td>\n    </tr>\n    <tr>\n      <th>19</th>\n      <td>86727</td>\n      <td>2020-09-25T07:57:49.678146+00:00</td>\n      <td>None</td>\n      <td>POLYGON ((-60.17478 -21.20611, -60.17436 -21.2...</td>\n      <td>43679</td>\n      <td>86727</td>\n      <td>Paraguay</td>\n      <td>Boquerón</td>\n      <td>FILADELFIA</td>\n      <td>2017-12-31</td>\n      <td>174512.220879</td>\n      <td>3.070367e+07</td>\n    </tr>\n    <tr>\n      <th>20</th>\n      <td>86731</td>\n      <td>2020-09-25T07:57:49.678146+00:00</td>\n      <td>None</td>\n      <td>POLYGON ((-60.18514 -21.19408, -60.18514 -21.1...</td>\n      <td>43679</td>\n      <td>86731</td>\n      <td>Paraguay</td>\n      <td>Boquerón</td>\n      <td>FILADELFIA</td>\n      <td>2017-12-31</td>\n      <td>174512.220879</td>\n      <td>3.070367e+07</td>\n    </tr>\n    <tr>\n      <th>21</th>\n      <td>86738</td>\n      <td>2020-09-25T07:57:49.678146+00:00</td>\n      <td>None</td>\n      <td>POLYGON ((-60.16414 -21.20403, -60.16396 -21.2...</td>\n      <td>43679</td>\n      <td>86738</td>\n      <td>Paraguay</td>\n      <td>Boquerón</td>\n      <td>FILADELFIA</td>\n      <td>2017-12-31</td>\n      <td>174512.220879</td>\n      <td>3.070367e+07</td>\n    </tr>\n    <tr>\n      <th>22</th>\n      <td>86742</td>\n      <td>2020-09-25T07:57:49.678146+00:00</td>\n      <td>None</td>\n      <td>POLYGON ((-60.17995 -21.19400, -60.17474 -21.1...</td>\n      <td>43679</td>\n      <td>86742</td>\n      <td>Paraguay</td>\n      <td>Boquerón</td>\n      <td>FILADELFIA</td>\n      <td>2017-12-31</td>\n      <td>174512.220879</td>\n      <td>3.070367e+07</td>\n    </tr>\n    <tr>\n      <th>23</th>\n      <td>86747</td>\n      <td>2020-09-25T07:57:49.678146+00:00</td>\n      <td>None</td>\n      <td>POLYGON ((-60.19185 -21.20799, -60.19147 -21.2...</td>\n      <td>43679</td>\n      <td>86747</td>\n      <td>Paraguay</td>\n      <td>Boquerón</td>\n      <td>FILADELFIA</td>\n      <td>2017-12-31</td>\n      <td>174512.220879</td>\n      <td>3.070367e+07</td>\n    </tr>\n    <tr>\n      <th>24</th>\n      <td>86749</td>\n      <td>2020-09-25T07:57:49.678146+00:00</td>\n      <td>None</td>\n      <td>POLYGON ((-60.19158 -21.20394, -60.19156 -21.2...</td>\n      <td>43679</td>\n      <td>86749</td>\n      <td>Paraguay</td>\n      <td>Boquerón</td>\n      <td>FILADELFIA</td>\n      <td>2017-12-31</td>\n      <td>174512.220879</td>\n      <td>3.070367e+07</td>\n    </tr>\n    <tr>\n      <th>25</th>\n      <td>88002</td>\n      <td>2020-09-25T07:57:49.678146+00:00</td>\n      <td>None</td>\n      <td>POLYGON ((-60.19158 -21.20394, -60.18492 -21.2...</td>\n      <td>43800</td>\n      <td>88002</td>\n      <td>Paraguay</td>\n      <td>Boquerón</td>\n      <td>FILADELFIA</td>\n      <td>2018-01-31</td>\n      <td>74575.618180</td>\n      <td>1.049673e+07</td>\n    </tr>\n    <tr>\n      <th>26</th>\n      <td>88006</td>\n      <td>2020-09-25T07:57:49.678146+00:00</td>\n      <td>None</td>\n      <td>POLYGON ((-60.18432 -21.19408, -60.17995 -21.1...</td>\n      <td>43800</td>\n      <td>88006</td>\n      <td>Paraguay</td>\n      <td>Boquerón</td>\n      <td>FILADELFIA</td>\n      <td>2018-01-31</td>\n      <td>74575.618180</td>\n      <td>1.049673e+07</td>\n    </tr>\n    <tr>\n      <th>27</th>\n      <td>88018</td>\n      <td>2020-09-25T07:57:49.678146+00:00</td>\n      <td>None</td>\n      <td>POLYGON ((-60.17365 -21.20509, -60.17372 -21.2...</td>\n      <td>43800</td>\n      <td>88018</td>\n      <td>Paraguay</td>\n      <td>Boquerón</td>\n      <td>FILADELFIA</td>\n      <td>2018-01-31</td>\n      <td>74575.618180</td>\n      <td>1.049673e+07</td>\n    </tr>\n    <tr>\n      <th>28</th>\n      <td>88019</td>\n      <td>2020-09-25T07:57:49.678146+00:00</td>\n      <td>None</td>\n      <td>POLYGON ((-60.16963 -21.21093, -60.16956 -21.2...</td>\n      <td>43800</td>\n      <td>88019</td>\n      <td>Paraguay</td>\n      <td>Boquerón</td>\n      <td>FILADELFIA</td>\n      <td>2018-01-31</td>\n      <td>74575.618180</td>\n      <td>1.049673e+07</td>\n    </tr>\n    <tr>\n      <th>29</th>\n      <td>88022</td>\n      <td>2020-09-25T07:57:49.678146+00:00</td>\n      <td>None</td>\n      <td>POLYGON ((-60.19696 -21.20406, -60.19563 -21.2...</td>\n      <td>43800</td>\n      <td>88022</td>\n      <td>Paraguay</td>\n      <td>Boquerón</td>\n      <td>FILADELFIA</td>\n      <td>2018-01-31</td>\n      <td>74575.618180</td>\n      <td>1.049673e+07</td>\n    </tr>\n    <tr>\n      <th>30</th>\n      <td>88024</td>\n      <td>2020-09-25T07:57:49.678146+00:00</td>\n      <td>None</td>\n      <td>POLYGON ((-60.18506 -21.20018, -60.18504 -21.2...</td>\n      <td>43800</td>\n      <td>88024</td>\n      <td>Paraguay</td>\n      <td>Boquerón</td>\n      <td>FILADELFIA</td>\n      <td>2018-01-31</td>\n      <td>74575.618180</td>\n      <td>1.049673e+07</td>\n    </tr>\n    <tr>\n      <th>31</th>\n      <td>88025</td>\n      <td>2020-09-25T07:57:49.678146+00:00</td>\n      <td>None</td>\n      <td>POLYGON ((-60.19580 -21.21018, -60.19576 -21.2...</td>\n      <td>43800</td>\n      <td>88025</td>\n      <td>Paraguay</td>\n      <td>Boquerón</td>\n      <td>FILADELFIA</td>\n      <td>2018-01-31</td>\n      <td>74575.618180</td>\n      <td>1.049673e+07</td>\n    </tr>\n    <tr>\n      <th>32</th>\n      <td>88028</td>\n      <td>2020-09-25T07:57:49.678146+00:00</td>\n      <td>None</td>\n      <td>POLYGON ((-60.17258 -21.19252, -60.17215 -21.1...</td>\n      <td>43800</td>\n      <td>88028</td>\n      <td>Paraguay</td>\n      <td>Boquerón</td>\n      <td>FILADELFIA</td>\n      <td>2018-01-31</td>\n      <td>74575.618180</td>\n      <td>1.049673e+07</td>\n    </tr>\n    <tr>\n      <th>33</th>\n      <td>88029</td>\n      <td>2020-09-25T07:57:49.678146+00:00</td>\n      <td>None</td>\n      <td>POLYGON ((-60.16966 -21.19277, -60.16953 -21.1...</td>\n      <td>43800</td>\n      <td>88029</td>\n      <td>Paraguay</td>\n      <td>Boquerón</td>\n      <td>FILADELFIA</td>\n      <td>2018-01-31</td>\n      <td>74575.618180</td>\n      <td>1.049673e+07</td>\n    </tr>\n    <tr>\n      <th>34</th>\n      <td>88030</td>\n      <td>2020-09-25T07:57:49.678146+00:00</td>\n      <td>None</td>\n      <td>POLYGON ((-60.19818 -21.20492, -60.19834 -21.2...</td>\n      <td>43800</td>\n      <td>88030</td>\n      <td>Paraguay</td>\n      <td>Boquerón</td>\n      <td>FILADELFIA</td>\n      <td>2018-01-31</td>\n      <td>74575.618180</td>\n      <td>1.049673e+07</td>\n    </tr>\n    <tr>\n      <th>35</th>\n      <td>88032</td>\n      <td>2020-09-25T07:57:49.678146+00:00</td>\n      <td>None</td>\n      <td>POLYGON ((-60.17366 -21.20509, -60.17365 -21.2...</td>\n      <td>43800</td>\n      <td>88032</td>\n      <td>Paraguay</td>\n      <td>Boquerón</td>\n      <td>FILADELFIA</td>\n      <td>2018-01-31</td>\n      <td>74575.618180</td>\n      <td>1.049673e+07</td>\n    </tr>\n  </tbody>\n</table>\n</div>","content_type":"text/html"},"text/plain":{"content":"       id                        created_at modified_at  \\\n0    9333  2020-09-25T07:57:39.568135+00:00        None   \n1    9347  2020-09-25T07:57:39.568135+00:00        None   \n2   40758   2020-09-25T07:57:44.48827+00:00        None   \n3   40763   2020-09-25T07:57:44.48827+00:00        None   \n4   40768   2020-09-25T07:57:44.48827+00:00        None   \n5   40770   2020-09-25T07:57:44.48827+00:00        None   \n6   58546  2020-09-25T07:57:45.943354+00:00        None   \n7   58548  2020-09-25T07:57:45.943354+00:00        None   \n8   66517   2020-09-25T07:57:47.16828+00:00        None   \n9   66518   2020-09-25T07:57:47.16828+00:00        None   \n10  68177   2020-09-25T07:57:47.16828+00:00        None   \n11  68188   2020-09-25T07:57:47.16828+00:00        None   \n12  68189   2020-09-25T07:57:47.16828+00:00        None   \n13  69469   2020-09-25T07:57:47.16828+00:00        None   \n14  69474   2020-09-25T07:57:47.16828+00:00        None   \n15  70590  2020-09-25T07:57:48.497587+00:00        None   \n16  70591  2020-09-25T07:57:48.497587+00:00        None   \n17  75456  2020-09-25T07:57:48.497587+00:00        None   \n18  86719  2020-09-25T07:57:49.678146+00:00        None   \n19  86727  2020-09-25T07:57:49.678146+00:00        None   \n20  86731  2020-09-25T07:57:49.678146+00:00        None   \n21  86738  2020-09-25T07:57:49.678146+00:00        None   \n22  86742  2020-09-25T07:57:49.678146+00:00        None   \n23  86747  2020-09-25T07:57:49.678146+00:00        None   \n24  86749  2020-09-25T07:57:49.678146+00:00        None   \n25  88002  2020-09-25T07:57:49.678146+00:00        None   \n26  88006  2020-09-25T07:57:49.678146+00:00        None   \n27  88018  2020-09-25T07:57:49.678146+00:00        None   \n28  88019  2020-09-25T07:57:49.678146+00:00        None   \n29  88022  2020-09-25T07:57:49.678146+00:00        None   \n30  88024  2020-09-25T07:57:49.678146+00:00        None   \n31  88025  2020-09-25T07:57:49.678146+00:00        None   \n32  88028  2020-09-25T07:57:49.678146+00:00        None   \n33  88029  2020-09-25T07:57:49.678146+00:00        None   \n34  88030  2020-09-25T07:57:49.678146+00:00        None   \n35  88032  2020-09-25T07:57:49.678146+00:00        None   \n\n                                             geometry  objectid  field_id  \\\n0   POLYGON ((-60.26329 -21.27054, -60.26325 -21.2...      7784      9333   \n1   POLYGON ((-60.26322 -21.23245, -60.26334 -21.2...      7798      9347   \n2   POLYGON ((-60.26381 -21.25916, -60.26376 -21.2...     32303     40758   \n3   POLYGON ((-60.26370 -21.25423, -60.26392 -21.2...     32308     40763   \n4   POLYGON ((-60.26354 -21.24383, -60.26380 -21.2...     32313     40768   \n5   POLYGON ((-60.26355 -21.23751, -60.26350 -21.2...     32315     40770   \n6   POLYGON ((-60.19709 -21.20089, -60.19801 -21.2...     42365     58546   \n7   POLYGON ((-60.17358 -21.19005, -60.17543 -21.1...     42365     58548   \n8   POLYGON ((-60.23363 -21.25623, -60.24235 -21.2...     42700     66517   \n9   POLYGON ((-60.23382 -21.26173, -60.25247 -21.2...     42700     66518   \n10  POLYGON ((-60.23342 -21.26788, -60.23342 -21.2...     42806     68177   \n11  POLYGON ((-60.23990 -21.26734, -60.25252 -21.2...     42806     68188   \n12  POLYGON ((-60.22272 -21.27312, -60.23180 -21.2...     42806     68189   \n13  POLYGON ((-60.23374 -21.26714, -60.23990 -21.2...     42911     69469   \n14  POLYGON ((-60.23157 -21.26809, -60.23164 -21.2...     42911     69474   \n15  POLYGON ((-60.23386 -21.25709, -60.23372 -21.2...     42965     70590   \n16  POLYGON ((-60.24358 -21.25610, -60.25239 -21.2...     42965     70591   \n17  POLYGON ((-60.21706 -21.27261, -60.22272 -21.2...     43184     75456   \n18  POLYGON ((-60.17380 -21.19416, -60.16402 -21.1...     43679     86719   \n19  POLYGON ((-60.17478 -21.20611, -60.17436 -21.2...     43679     86727   \n20  POLYGON ((-60.18514 -21.19408, -60.18514 -21.1...     43679     86731   \n21  POLYGON ((-60.16414 -21.20403, -60.16396 -21.2...     43679     86738   \n22  POLYGON ((-60.17995 -21.19400, -60.17474 -21.1...     43679     86742   \n23  POLYGON ((-60.19185 -21.20799, -60.19147 -21.2...     43679     86747   \n24  POLYGON ((-60.19158 -21.20394, -60.19156 -21.2...     43679     86749   \n25  POLYGON ((-60.19158 -21.20394, -60.18492 -21.2...     43800     88002   \n26  POLYGON ((-60.18432 -21.19408, -60.17995 -21.1...     43800     88006   \n27  POLYGON ((-60.17365 -21.20509, -60.17372 -21.2...     43800     88018   \n28  POLYGON ((-60.16963 -21.21093, -60.16956 -21.2...     43800     88019   \n29  POLYGON ((-60.19696 -21.20406, -60.19563 -21.2...     43800     88022   \n30  POLYGON ((-60.18506 -21.20018, -60.18504 -21.2...     43800     88024   \n31  POLYGON ((-60.19580 -21.21018, -60.19576 -21.2...     43800     88025   \n32  POLYGON ((-60.17258 -21.19252, -60.17215 -21.1...     43800     88028   \n33  POLYGON ((-60.16966 -21.19277, -60.16953 -21.1...     43800     88029   \n34  POLYGON ((-60.19818 -21.20492, -60.19834 -21.2...     43800     88030   \n35  POLYGON ((-60.17366 -21.20509, -60.17365 -21.2...     43800     88032   \n\n        pais  prov_dep  municipios        date     shape_leng    shape_area  \n0   Paraguay  Boquerón  FILADELFIA  2011-12-31    3203.541559  5.661000e+05  \n1   Paraguay  Boquerón  FILADELFIA  2011-12-31   23061.565888  4.140725e+06  \n2   Paraguay  Boquerón  FILADELFIA  2014-10-31     247.465000  1.491147e+03  \n3   Paraguay  Boquerón  FILADELFIA  2014-10-31     156.980834  8.272126e+02  \n4   Paraguay  Boquerón  FILADELFIA  2014-10-31     244.941473  2.648666e+03  \n5   Paraguay  Boquerón  FILADELFIA  2014-10-31     258.094701  2.089448e+03  \n6   Paraguay  Boquerón  FILADELFIA  2015-10-31   35369.274281  5.651093e+06  \n7   Paraguay  Boquerón  FILADELFIA  2015-10-31   35369.274281  5.651093e+06  \n8   Paraguay  Boquerón  FILADELFIA  2016-06-30   63232.505444  1.189560e+07  \n9   Paraguay  Boquerón  FILADELFIA  2016-06-30   63232.505444  1.189560e+07  \n10  Paraguay  Boquerón  FILADELFIA  2016-08-31   54236.171652  1.099213e+07  \n11  Paraguay  Boquerón  FILADELFIA  2016-08-31   54236.171652  1.099213e+07  \n12  Paraguay  Boquerón  FILADELFIA  2016-08-31   54236.171652  1.099213e+07  \n13  Paraguay  Boquerón  FILADELFIA  2016-09-30   46417.194449  7.108902e+06  \n14  Paraguay  Boquerón  FILADELFIA  2016-09-30   46417.194449  7.108902e+06  \n15  Paraguay  Boquerón  FILADELFIA  2016-11-30   96005.066733  1.744413e+07  \n16  Paraguay  Boquerón  FILADELFIA  2016-11-30   96005.066733  1.744413e+07  \n17  Paraguay  Boquerón  FILADELFIA  2017-03-31  284316.143820  4.828256e+07  \n18  Paraguay  Boquerón  FILADELFIA  2017-12-31  174512.220879  3.070367e+07  \n19  Paraguay  Boquerón  FILADELFIA  2017-12-31  174512.220879  3.070367e+07  \n20  Paraguay  Boquerón  FILADELFIA  2017-12-31  174512.220879  3.070367e+07  \n21  Paraguay  Boquerón  FILADELFIA  2017-12-31  174512.220879  3.070367e+07  \n22  Paraguay  Boquerón  FILADELFIA  2017-12-31  174512.220879  3.070367e+07  \n23  Paraguay  Boquerón  FILADELFIA  2017-12-31  174512.220879  3.070367e+07  \n24  Paraguay  Boquerón  FILADELFIA  2017-12-31  174512.220879  3.070367e+07  \n25  Paraguay  Boquerón  FILADELFIA  2018-01-31   74575.618180  1.049673e+07  \n26  Paraguay  Boquerón  FILADELFIA  2018-01-31   74575.618180  1.049673e+07  \n27  Paraguay  Boquerón  FILADELFIA  2018-01-31   74575.618180  1.049673e+07  \n28  Paraguay  Boquerón  FILADELFIA  2018-01-31   74575.618180  1.049673e+07  \n29  Paraguay  Boquerón  FILADELFIA  2018-01-31   74575.618180  1.049673e+07  \n30  Paraguay  Boquerón  FILADELFIA  2018-01-31   74575.618180  1.049673e+07  \n31  Paraguay  Boquerón  FILADELFIA  2018-01-31   74575.618180  1.049673e+07  \n32  Paraguay  Boquerón  FILADELFIA  2018-01-31   74575.618180  1.049673e+07  \n33  Paraguay  Boquerón  FILADELFIA  2018-01-31   74575.618180  1.049673e+07  \n34  Paraguay  Boquerón  FILADELFIA  2018-01-31   74575.618180  1.049673e+07  \n35  Paraguay  Boquerón  FILADELFIA  2018-01-31   74575.618180  1.049673e+07  ","content_type":"text/plain"}}}],"key":"QooQEgfZDK"}],"key":"gOruNFLL0l"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Data preparation","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"y5FjWDj6ED"}],"identifier":"data-preparation","label":"Data preparation","html_id":"data-preparation","implicit":true,"key":"oID80mddWG"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"As we can see above, in the subset of the GeoDB that we queried, there are deforestation events detected in 2011, 2014, 2015, 2016, 2017 and 2018. Let’s narrow down the dataset a little further and only select the polygons in 2018.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Tgj8VW3kax"}],"key":"kvBfASW9n1"}],"key":"a4g94byw5y"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"In the following cell, we convert the date strings to ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KySpaMZKEn"},{"type":"inlineCode","value":"datetime","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Ftj3lwBfdU"},{"type":"text","value":" objects to make the querying easier.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"O0EqaSArJl"}],"key":"Ji24Egko3n"}],"key":"i24xVlqs2i"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# Convert the dates to datetime objects and store in a new column\ngran_chaco[\"datetime\"] = pd.to_datetime(gran_chaco[\"date\"])","key":"Zlg9RYDzSj"},{"type":"output","id":"ScjTRkXxJSJRS6KrAdMOy","data":[],"key":"pfewjymGil"}],"key":"ZmE11NqWMs"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# Select only polygons from 2018\ngran_chaco_subset_2018 = gran_chaco[gran_chaco[\"datetime\"].dt.year == 2018]","key":"RdxJn1pGkb"},{"type":"output","id":"CHmjZe-AFUSEGgahwngBt","data":[],"key":"H1ip8pzqOB"}],"key":"YBq65GiEwq"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now, we can preview the subset that we have selected based on the year 2018.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yu7ipNMDDU"}],"key":"dgEj9rbKNu"}],"key":"BwoMPRUhkO"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"gran_chaco_subset_2018","key":"vPluw9D4mg"},{"type":"output","id":"9AyB6zlPu6z8ji5PPhJ16","data":[{"output_type":"execute_result","execution_count":18,"metadata":{},"data":{"text/html":{"content":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>id</th>\n      <th>created_at</th>\n      <th>modified_at</th>\n      <th>geometry</th>\n      <th>objectid</th>\n      <th>field_id</th>\n      <th>pais</th>\n      <th>prov_dep</th>\n      <th>municipios</th>\n      <th>date</th>\n      <th>shape_leng</th>\n      <th>shape_area</th>\n      <th>datetime</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>25</th>\n      <td>88002</td>\n      <td>2020-09-25T07:57:49.678146+00:00</td>\n      <td>None</td>\n      <td>POLYGON ((-60.19158 -21.20394, -60.18492 -21.2...</td>\n      <td>43800</td>\n      <td>88002</td>\n      <td>Paraguay</td>\n      <td>Boquerón</td>\n      <td>FILADELFIA</td>\n      <td>2018-01-31</td>\n      <td>74575.61818</td>\n      <td>1.049673e+07</td>\n      <td>2018-01-31</td>\n    </tr>\n    <tr>\n      <th>26</th>\n      <td>88006</td>\n      <td>2020-09-25T07:57:49.678146+00:00</td>\n      <td>None</td>\n      <td>POLYGON ((-60.18432 -21.19408, -60.17995 -21.1...</td>\n      <td>43800</td>\n      <td>88006</td>\n      <td>Paraguay</td>\n      <td>Boquerón</td>\n      <td>FILADELFIA</td>\n      <td>2018-01-31</td>\n      <td>74575.61818</td>\n      <td>1.049673e+07</td>\n      <td>2018-01-31</td>\n    </tr>\n    <tr>\n      <th>27</th>\n      <td>88018</td>\n      <td>2020-09-25T07:57:49.678146+00:00</td>\n      <td>None</td>\n      <td>POLYGON ((-60.17365 -21.20509, -60.17372 -21.2...</td>\n      <td>43800</td>\n      <td>88018</td>\n      <td>Paraguay</td>\n      <td>Boquerón</td>\n      <td>FILADELFIA</td>\n      <td>2018-01-31</td>\n      <td>74575.61818</td>\n      <td>1.049673e+07</td>\n      <td>2018-01-31</td>\n    </tr>\n    <tr>\n      <th>28</th>\n      <td>88019</td>\n      <td>2020-09-25T07:57:49.678146+00:00</td>\n      <td>None</td>\n      <td>POLYGON ((-60.16963 -21.21093, -60.16956 -21.2...</td>\n      <td>43800</td>\n      <td>88019</td>\n      <td>Paraguay</td>\n      <td>Boquerón</td>\n      <td>FILADELFIA</td>\n      <td>2018-01-31</td>\n      <td>74575.61818</td>\n      <td>1.049673e+07</td>\n      <td>2018-01-31</td>\n    </tr>\n    <tr>\n      <th>29</th>\n      <td>88022</td>\n      <td>2020-09-25T07:57:49.678146+00:00</td>\n      <td>None</td>\n      <td>POLYGON ((-60.19696 -21.20406, -60.19563 -21.2...</td>\n      <td>43800</td>\n      <td>88022</td>\n      <td>Paraguay</td>\n      <td>Boquerón</td>\n      <td>FILADELFIA</td>\n      <td>2018-01-31</td>\n      <td>74575.61818</td>\n      <td>1.049673e+07</td>\n      <td>2018-01-31</td>\n    </tr>\n    <tr>\n      <th>30</th>\n      <td>88024</td>\n      <td>2020-09-25T07:57:49.678146+00:00</td>\n      <td>None</td>\n      <td>POLYGON ((-60.18506 -21.20018, -60.18504 -21.2...</td>\n      <td>43800</td>\n      <td>88024</td>\n      <td>Paraguay</td>\n      <td>Boquerón</td>\n      <td>FILADELFIA</td>\n      <td>2018-01-31</td>\n      <td>74575.61818</td>\n      <td>1.049673e+07</td>\n      <td>2018-01-31</td>\n    </tr>\n    <tr>\n      <th>31</th>\n      <td>88025</td>\n      <td>2020-09-25T07:57:49.678146+00:00</td>\n      <td>None</td>\n      <td>POLYGON ((-60.19580 -21.21018, -60.19576 -21.2...</td>\n      <td>43800</td>\n      <td>88025</td>\n      <td>Paraguay</td>\n      <td>Boquerón</td>\n      <td>FILADELFIA</td>\n      <td>2018-01-31</td>\n      <td>74575.61818</td>\n      <td>1.049673e+07</td>\n      <td>2018-01-31</td>\n    </tr>\n    <tr>\n      <th>32</th>\n      <td>88028</td>\n      <td>2020-09-25T07:57:49.678146+00:00</td>\n      <td>None</td>\n      <td>POLYGON ((-60.17258 -21.19252, -60.17215 -21.1...</td>\n      <td>43800</td>\n      <td>88028</td>\n      <td>Paraguay</td>\n      <td>Boquerón</td>\n      <td>FILADELFIA</td>\n      <td>2018-01-31</td>\n      <td>74575.61818</td>\n      <td>1.049673e+07</td>\n      <td>2018-01-31</td>\n    </tr>\n    <tr>\n      <th>33</th>\n      <td>88029</td>\n      <td>2020-09-25T07:57:49.678146+00:00</td>\n      <td>None</td>\n      <td>POLYGON ((-60.16966 -21.19277, -60.16953 -21.1...</td>\n      <td>43800</td>\n      <td>88029</td>\n      <td>Paraguay</td>\n      <td>Boquerón</td>\n      <td>FILADELFIA</td>\n      <td>2018-01-31</td>\n      <td>74575.61818</td>\n      <td>1.049673e+07</td>\n      <td>2018-01-31</td>\n    </tr>\n    <tr>\n      <th>34</th>\n      <td>88030</td>\n      <td>2020-09-25T07:57:49.678146+00:00</td>\n      <td>None</td>\n      <td>POLYGON ((-60.19818 -21.20492, -60.19834 -21.2...</td>\n      <td>43800</td>\n      <td>88030</td>\n      <td>Paraguay</td>\n      <td>Boquerón</td>\n      <td>FILADELFIA</td>\n      <td>2018-01-31</td>\n      <td>74575.61818</td>\n      <td>1.049673e+07</td>\n      <td>2018-01-31</td>\n    </tr>\n    <tr>\n      <th>35</th>\n      <td>88032</td>\n      <td>2020-09-25T07:57:49.678146+00:00</td>\n      <td>None</td>\n      <td>POLYGON ((-60.17366 -21.20509, -60.17365 -21.2...</td>\n      <td>43800</td>\n      <td>88032</td>\n      <td>Paraguay</td>\n      <td>Boquerón</td>\n      <td>FILADELFIA</td>\n      <td>2018-01-31</td>\n      <td>74575.61818</td>\n      <td>1.049673e+07</td>\n      <td>2018-01-31</td>\n    </tr>\n  </tbody>\n</table>\n</div>","content_type":"text/html"},"text/plain":{"content":"       id                        created_at modified_at  \\\n25  88002  2020-09-25T07:57:49.678146+00:00        None   \n26  88006  2020-09-25T07:57:49.678146+00:00        None   \n27  88018  2020-09-25T07:57:49.678146+00:00        None   \n28  88019  2020-09-25T07:57:49.678146+00:00        None   \n29  88022  2020-09-25T07:57:49.678146+00:00        None   \n30  88024  2020-09-25T07:57:49.678146+00:00        None   \n31  88025  2020-09-25T07:57:49.678146+00:00        None   \n32  88028  2020-09-25T07:57:49.678146+00:00        None   \n33  88029  2020-09-25T07:57:49.678146+00:00        None   \n34  88030  2020-09-25T07:57:49.678146+00:00        None   \n35  88032  2020-09-25T07:57:49.678146+00:00        None   \n\n                                             geometry  objectid  field_id  \\\n25  POLYGON ((-60.19158 -21.20394, -60.18492 -21.2...     43800     88002   \n26  POLYGON ((-60.18432 -21.19408, -60.17995 -21.1...     43800     88006   \n27  POLYGON ((-60.17365 -21.20509, -60.17372 -21.2...     43800     88018   \n28  POLYGON ((-60.16963 -21.21093, -60.16956 -21.2...     43800     88019   \n29  POLYGON ((-60.19696 -21.20406, -60.19563 -21.2...     43800     88022   \n30  POLYGON ((-60.18506 -21.20018, -60.18504 -21.2...     43800     88024   \n31  POLYGON ((-60.19580 -21.21018, -60.19576 -21.2...     43800     88025   \n32  POLYGON ((-60.17258 -21.19252, -60.17215 -21.1...     43800     88028   \n33  POLYGON ((-60.16966 -21.19277, -60.16953 -21.1...     43800     88029   \n34  POLYGON ((-60.19818 -21.20492, -60.19834 -21.2...     43800     88030   \n35  POLYGON ((-60.17366 -21.20509, -60.17365 -21.2...     43800     88032   \n\n        pais  prov_dep  municipios        date   shape_leng    shape_area  \\\n25  Paraguay  Boquerón  FILADELFIA  2018-01-31  74575.61818  1.049673e+07   \n26  Paraguay  Boquerón  FILADELFIA  2018-01-31  74575.61818  1.049673e+07   \n27  Paraguay  Boquerón  FILADELFIA  2018-01-31  74575.61818  1.049673e+07   \n28  Paraguay  Boquerón  FILADELFIA  2018-01-31  74575.61818  1.049673e+07   \n29  Paraguay  Boquerón  FILADELFIA  2018-01-31  74575.61818  1.049673e+07   \n30  Paraguay  Boquerón  FILADELFIA  2018-01-31  74575.61818  1.049673e+07   \n31  Paraguay  Boquerón  FILADELFIA  2018-01-31  74575.61818  1.049673e+07   \n32  Paraguay  Boquerón  FILADELFIA  2018-01-31  74575.61818  1.049673e+07   \n33  Paraguay  Boquerón  FILADELFIA  2018-01-31  74575.61818  1.049673e+07   \n34  Paraguay  Boquerón  FILADELFIA  2018-01-31  74575.61818  1.049673e+07   \n35  Paraguay  Boquerón  FILADELFIA  2018-01-31  74575.61818  1.049673e+07   \n\n     datetime  \n25 2018-01-31  \n26 2018-01-31  \n27 2018-01-31  \n28 2018-01-31  \n29 2018-01-31  \n30 2018-01-31  \n31 2018-01-31  \n32 2018-01-31  \n33 2018-01-31  \n34 2018-01-31  \n35 2018-01-31  ","content_type":"text/plain"}}}],"key":"d1gHWlA9j7"}],"key":"dV3ZiRXqlZ"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# Plot all selected polygons\nIPython.display.GeoJSON(gran_chaco_subset_2018.__geo_interface__)","key":"U2isQ2ag4Q"},{"type":"output","id":"uwbzPsE7Ru7W6zz2T1k2m","data":[{"output_type":"display_data","metadata":{"application/geo+json":{"expanded":false,"root":"root"}},"data":{"application/geo+json":{"content_type":"application/geo+json","hash":"dccf28692db1f785b2d7987c4d2c913f","path":"/example-viewer/build/dccf28692db1f785b2d7987c4d2c913f.json"},"text/plain":{"content":"<IPython.display.GeoJSON object>","content_type":"text/plain"}}}],"key":"ODle5tSjTD"}],"key":"OSiC3mdluO"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Fun fact: thanks to Ipython, it is easy to zoom out to have an idea of the location of the polygons. Furthermore, you can click on an individual polygon to list the attributes of that specific shape in the dataframe.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"S17Qou1Sg3"}],"key":"JvtPvtyYiB"}],"key":"cU6Mcqu8Ew"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gTsvNTw9c5"}],"key":"SUA4KPUZcj"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Query Catalog API for dates with  available Sentinel-2 data before and after the registered deforestation event","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"eOjRujYguw"}],"identifier":"query-catalog-api-for-dates-with-available-sentinel-2-data-before-and-after-the-registered-deforestation-event","label":"Query Catalog API for dates with  available Sentinel-2 data before and after the registered deforestation event","html_id":"query-catalog-api-for-dates-with-available-sentinel-2-data-before-and-after-the-registered-deforestation-event","implicit":true,"key":"j1VIhspWMm"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"For our selected AOI, we will check if the registered deforestation date in the dataset that we are querying is correct. To do so, we will look at the closest cloud-free Sentinel images before and after the date assigned to the polygon (here, ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"BZpbcoye0i"},{"type":"inlineCode","value":"2018-01-31","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"zuxMuM1CLi"},{"type":"text","value":").","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"yf0TW8nR4c"}],"key":"ASF28vwCEj"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Rather than query all the Sentinel-2 images in a given period around the date of interest, which would be a waste of resources particularly in cloudy areas, we can use the Catalog API service to list metadata about the images that will guide our choice in the selection. The Catalog service allows us to return the dates of images intersecting the AOI, but other essential parameters, such as the scene’s overall cloud cover.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"C4OLSrlbkp"}],"key":"KtAs9orSBg"}],"key":"IXHlXiS13I"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Create an OAuth2 session and create a token for it","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UY5M2Zmg1c"}],"identifier":"create-an-oauth2-session-and-create-a-token-for-it","label":"Create an OAuth2 session and create a token for it","html_id":"create-an-oauth2-session-and-create-a-token-for-it","implicit":true,"key":"BlZ4xcmqzn"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"In order to send a request to the Catalog API we need to create a token first. Let’s start by creating an OAuth session.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"w7Vepq9RAx"}],"key":"lGbfx9UKeH"}],"key":"nbRmGRgdrq"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# Create a session\nclient = BackendApplicationClient(client_id=sh_client_id)\noauth = OAuth2Session(client=client)","key":"yrxo0qOYsZ"},{"type":"output","id":"71_rkj8TG4C3hM-dOmNVq","data":[],"key":"lgNyQxrcqB"}],"key":"YjYTInmtpF"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The token acts like an ID we provide the API with to verify us as a registered user. This token is temporary (about 1h) for security reasons. If when running a Catalog request an authentification error is thrown, just execute the following cell again to obtain a new token.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"j1HtoF1ko3"}],"key":"kTnLpkulhT"}],"key":"okNXGQEsW3"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# Get token for the session\ntoken = oauth.fetch_token(token_url='https://services.sentinel-hub.com/oauth/token',\n                          client_id=sh_client_id, client_secret=sh_client_secret)","key":"VpGRYwfUch"},{"type":"output","id":"yrGnawJx9x4xgEshl-MHp","data":[],"key":"D32qvYS7V5"}],"key":"Zt2lso8Ed7"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Create the Catalog API request","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wjGyq3SLhD"}],"identifier":"create-the-catalog-api-request","label":"Create the Catalog API request","html_id":"create-the-catalog-api-request","implicit":true,"key":"gtvXwODwSK"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"We specify the service endpoint URL, set the Content-Type to ‘application/json’ because we only want to receive a list of dates with available Sentinel-2 data within the selected period. We also set the ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"k7U2eRtZp4"},{"type":"inlineCode","value":"collection","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"fccvOXnjMN"},{"type":"text","value":" that we want to query (here Sentinel-2 L1C), and the time range we are interested in.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"f9D6Bds9xP"}],"key":"hKZsjXDUgo"}],"key":"rP65nbpnsg"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# Set the Catalog API url\ncatalog_url = \"https://services.sentinel-hub.com/api/v1/catalog/\"\n\n# Set the header\nheaders = {\n  'Content-Type': 'application/json'\n}\n\n# Set the Catalog request parameters\ncollections = \"sentinel-2-l1c\"\ndatetime= \"2017-10-01T00:00:00Z/2018-02-15T23:59:59Z\"  # We set a wide time range to get an idea of the available data","key":"Quc9SrqnQE"},{"type":"output","id":"eh5hgxfLIFz9XRn4vRXab","data":[],"key":"OmE7Epw856"}],"key":"QF0E9G438T"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# Run the catalog request\nresponse = oauth.request(\"GET\", f\"https://services.sentinel-hub.com/api/v1/catalog/collections/{collections}/items?bbox={aoi_bbox[0]},{aoi_bbox[1]},{aoi_bbox[2]},{aoi_bbox[3]}&datetime={datetime}&limit=20\", headers=headers)\ncatalog_results = response.json()","key":"rKXVKdwD1u"},{"type":"output","id":"cdtEsSP_hCMBUSSBsgXNx","data":[],"key":"ZH5nhoSJEm"}],"key":"UDWTULFA5W"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# Fetch the dates and cloud cover values\navailable_data = []\nfor entry in catalog_results[\"features\"]:\n    available_data.append((entry[\"properties\"][\"datetime\"], entry[\"properties\"][\"eo:cloud_cover\"]))\n    \nprint(available_data)","key":"OrTbsE2LhE"},{"type":"output","id":"2J85xwhcY3e4XM9Dwc7v3","data":[{"name":"stdout","output_type":"stream","text":"[('2018-02-14T14:10:42Z', 0.0), ('2018-02-09T14:10:39Z', 1.74), ('2018-02-04T14:10:42Z', 0.34), ('2018-01-30T14:10:39Z', 20.4), ('2018-01-20T14:14:24Z', 47.4), ('2018-01-15T14:10:50Z', 77.53), ('2018-01-10T14:10:37Z', 48.09), ('2017-12-31T14:13:44Z', 5.99), ('2017-12-26T14:10:40Z', 59.38), ('2017-12-21T14:10:33Z', 81.81), ('2017-12-11T14:10:34Z', 1.43), ('2017-12-06T14:10:41Z', 69.5), ('2017-12-01T14:12:55Z', 25.88), ('2017-11-21T14:14:18Z', 0.08), ('2017-11-16T14:10:43Z', 57.75), ('2017-11-11T14:10:32Z', 17.35), ('2017-10-27T14:11:07Z', 47.9), ('2017-10-22T14:10:32Z', 100.0), ('2017-10-07T14:10:44Z', 12.11), ('2017-10-02T14:11:57Z', 57.92)]\n"}],"key":"eua8tBvvKu"}],"key":"TPdtTgmQtf"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WUw4iipuOi"}],"key":"aY8Ys0Dhmh"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Filter the available dates","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YUhEawwcj9"}],"identifier":"filter-the-available-dates","label":"Filter the available dates","html_id":"filter-the-available-dates","implicit":true,"key":"gT5sptXDxk"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We now have a list of images and their respective cloud cover available, we can filter out for the closest dates to the deforestation event marked in our database, taking in account the cloud cover.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ikwjoNahPw"}],"key":"aevzAk51sy"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Let’s select the images with less than 10% cloud cover over the entire scene.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"rfvjZ4cMIa"}],"key":"A25pdWHbIh"}],"key":"h0VmrpPXjq"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# Set the date of interest. Since all the dates are the same in our subset, we take the first one.\ndeforestation_date = dt.strptime(gran_chaco_subset_2018.date.values[0], \"%Y-%m-%d\")\n\n# Cloud cover percentage filter\ncc = 10\n\n# We want to select the dates that have less than the set % of cloud cover\navailable_datetimes = [dt.strptime(x[0], \"%Y-%m-%dT%H:%M:%SZ\") for x in available_data if x[1] <= cc]\n\n# Find the index before and after our date of interest\npast_dates = [date for date in available_datetimes if date < deforestation_date]\nfuture_dates = [date for date in available_datetimes if date >= deforestation_date]\n\nbefore_ind = available_datetimes.index(max(past_dates))\nafter_ind = available_datetimes.index(min(future_dates))","key":"QmQDb7waUy"},{"type":"output","id":"c9dGiOXzJGc9oqgxhKbOl","data":[],"key":"hhOOlUzkOZ"}],"key":"Mf087cWYF8"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"print(f\"Closest date with less than {cc}% cloud cover. Before: {available_datetimes[before_ind]}; After: {available_datetimes[after_ind]}\")","key":"h9J3TcNF4E"},{"type":"output","id":"f0qog5uBTbYaAi_QfozYu","data":[{"name":"stdout","output_type":"stream","text":"Closest date with less than 10% cloud cover. Before: 2017-12-31 14:13:44; After: 2018-02-04 14:10:42\n"}],"key":"To8BIm8Maw"}],"key":"EkYY5Dclf4"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hznAJRYpJR"}],"key":"goYtmVLDtm"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Query Sentinel-2 images","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lHmFZKqvvF"}],"identifier":"query-sentinel-2-images","label":"Query Sentinel-2 images","html_id":"query-sentinel-2-images","implicit":true,"key":"QnWESLFTXW"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Now we have the dates that we are interested in, we will query the images using ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"IyLScADMxm"},{"type":"inlineCode","value":"sentinelhub-py","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"W86Tnsz8XK"},{"type":"text","value":", as we did for the True Color and False Color RGB images.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"O9Z2mb4jka"}],"key":"Ir60U6LB4a"}],"key":"m4JjhtdszR"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"First we set the bounding box to cover our selected field based on the geometry of the object in the database. We will set a buffer to make sure that we cover the entire set of polygons. Note that the buffer values are in degrees since the coordinates are in ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IcSmzIcCFU"},{"type":"inlineCode","value":"WGS84","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Fx0h971tqT"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vDDQoGAPRT"}],"key":"cWglBTHrP7"}],"key":"JMoh0Cw35c"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# Set AOI bounding box for our example polygons and image size according to desired resolution\nresolution = 10\naoi = BBox(bbox=box(*gran_chaco_subset_2018.total_bounds).buffer(0.001).bounds, crs=CRS.WGS84)\naoi_size = bbox_to_dimensions(aoi, resolution=resolution)","key":"aXq5nIrfvv"},{"type":"output","id":"N6eicgbXgEAY7qlfooCS0","data":[],"key":"Fx81cPQ6zD"}],"key":"bLMT6fOlKp"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"In our request, we will do things a little differently from the previous requests. Indeed, to be able to plot the extent of the fields in our image, we need it to be georeferenced. Therefore, using the numpy array returned when calling the request is not sufficient. To get a georeferenced image, we will save the response as a ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pmBzimNLTQ"},{"type":"inlineCode","value":"geotiff","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wwwtZ87v7r"},{"type":"text","value":" locally, then open it with a geospatial library later (here we will use ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xb9eyzNvf9"},{"type":"inlineCode","value":"rasterio","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Zo34Nub04v"},{"type":"text","value":").","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NmMOjRe3k5"}],"key":"fBIP9e7fug"}],"key":"FYphV9VR9T"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We will make two requests: one for the date before the event, that we selected earlier, and one after. Before each request, we make a directory to save the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RdpQSinqJ7"},{"type":"inlineCode","value":"geotiff","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mXw93LIgnY"},{"type":"text","value":"s and set the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nzSgXZqgvg"},{"type":"inlineCode","value":"save_data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"M3Jx60seeD"},{"type":"text","value":" parameter to ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DhrGH76gJy"},{"type":"inlineCode","value":"True","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lskXAJmylO"},{"type":"text","value":" in the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UXcMS2WmaG"},{"type":"inlineCode","value":"get_data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wCPn9HIdZK"},{"type":"text","value":" method. Note, make sure that you delete any previous requests in the folders (if they exist).","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JkqTpOJBSE"}],"key":"RaDfx3ykGd"}],"key":"RP811JF2ww"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# Make a directory to save the response\nPath('./results/before').mkdir(parents=True, exist_ok=True)\n  \nrequest = SentinelHubRequest(evalscript=evalscript_true_color,\n                             input_data=[SentinelHubRequest.input_data(data_collection=DataCollection.SENTINEL2_L2A,\n                                                                       time_interval=(dt.strftime(available_datetimes[before_ind], \"%Y-%m-%d\"),\n                                                                                      dt.strftime(available_datetimes[before_ind], \"%Y-%m-%d\")))],\n                            responses=[SentinelHubRequest.output_response('default', MimeType.TIFF)],\n                            bbox=aoi,  \n                            size=aoi_size,\n                            data_folder='./results/before/',\n                            config=config)\n\ntrue_color_before = request.get_data(save_data=True)","key":"yi0Zdbcedo"},{"type":"output","id":"ZyejFvv2jmPUs_eGIlLCE","data":[],"key":"JjJu9N2pUR"}],"key":"E8WB71amiT"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# Make a directory to save the response\nPath('./results/after').mkdir(parents=True, exist_ok=True)\n  \nrequest = SentinelHubRequest(evalscript=evalscript_true_color,\n                             input_data=[SentinelHubRequest.input_data(data_collection=DataCollection.SENTINEL2_L2A,\n                                                                       time_interval=(dt.strftime(available_datetimes[after_ind], \"%Y-%m-%d\"),\n                                                                                      dt.strftime(available_datetimes[after_ind], \"%Y-%m-%d\")))],\n                            responses=[SentinelHubRequest.output_response('default', MimeType.TIFF)],\n                            bbox=aoi,  \n                            size=aoi_size,\n                            data_folder='./results/after/',\n                            config=config)\n\ntrue_color_after = request.get_data(save_data=True)","key":"lFdGqwMPP8"},{"type":"output","id":"RLDL1UZZp739UwxABgcBW","data":[],"key":"Pdb67lFDfl"}],"key":"Yat1jeQ387"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now that we have downloaded the data, let’s fetch the path to the resulting ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oUxS4IgXkQ"},{"type":"inlineCode","value":"geotiff","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fCO3j7qRNf"},{"type":"text","value":"s and open them with rasterio.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bC8c0k8AgI"}],"key":"dL4UpmhaXr"}],"key":"vawaJQV7cA"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# Get folder name created\nfld_a = [f for f in Path(\"./results/before/\").iterdir() if f.is_dir()][0]\nfld_b = [f for f in Path(\"./results/after/\").iterdir() if f.is_dir()][0]\n\n# Open raster with Rasterio\nraster_before = rasterio.open(str(fld_a.joinpath(\"response.tiff\")))\nraster_after = rasterio.open(str(fld_b.joinpath(\"response.tiff\")))","key":"hsLOk5SqxO"},{"type":"output","id":"YjWjM4d-Sm17c9HEYpn6J","data":[],"key":"sSToWLXh3x"}],"key":"MXtvUGWsTo"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Plot the raster images saved locally and show the outline of the selected polygons in the database","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FRV2dS7crj"}],"identifier":"plot-the-raster-images-saved-locally-and-show-the-outline-of-the-selected-polygons-in-the-database","label":"Plot the raster images saved locally and show the outline of the selected polygons in the database","html_id":"plot-the-raster-images-saved-locally-and-show-the-outline-of-the-selected-polygons-in-the-database","implicit":true,"key":"pRtcEbIsDA"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Here will plot the georeferenced rasterio rasters and add the parcel outlines over the images.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Qwu3Y09xT9"}],"key":"GyIf0ydKf4"}],"key":"LiKB453rdl"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"fig, (ax, ax1) = plt.subplots(nrows=1, ncols=2, figsize=(18, 10))\n\n# Plot images before and after\nshow(raster_before, ax=ax)\nshow(raster_after, ax=ax1)\n\n# Plot the field outline over the images\ngran_chaco_subset_2018.plot(ax=ax, edgecolor=\"red\", facecolor=\"none\", linewidth=2)\ngran_chaco_subset_2018.plot(ax=ax1, edgecolor=\"red\", facecolor=\"none\", linewidth=2)\n\n# Plot configuration\nfor axs in [ax, ax1]:\n    axs.set_xticks([])\n    axs.set_yticks([])\n\nax.set_title(dt.strftime(available_datetimes[before_ind], \"%Y-%m-%d\"))\nax1.set_title(dt.strftime(available_datetimes[after_ind], \"%Y-%m-%d\"))\n\nplt.show()","key":"el5tsO0sds"},{"type":"output","id":"-OV-gfZwLB5PFYS0IESR-","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"909f35a6e5ed0497d8a33b9782feaf27","path":"/example-viewer/build/909f35a6e5ed0497d8a33b9782feaf27.png"},"text/plain":{"content":"<Figure size 1800x1000 with 2 Axes>","content_type":"text/plain"}}}],"key":"Xx1ENl8r1l"}],"key":"XLWLRNtAG3"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"In the image above, we notice several points:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ABiBOumvJY"}],"key":"vGOez0S50P"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"For some of the smaller polygons we can see that the deforestation happened between the 31","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"K2UFeRc8me"},{"type":"superscript","children":[{"type":"text","value":"st","key":"EhgLLMiZOg"}],"key":"SijtH3tBej"},{"type":"text","value":" December 2017 and 4","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"GlJVLdhBx3"},{"type":"superscript","children":[{"type":"text","value":"th","key":"le4JC0qXLY"}],"key":"oeYv3PBsi7"},{"type":"text","value":" February 2018. Due to cloud coverage, we cannot narrow down the date any more. But we will get back to this point later in the process.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"iXUeVdQy1Z"}],"key":"uWtnVNPKbh"}],"key":"poBK3CbRzA"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"The larger polygons that were identified as deforested in January 2018 in the dataset were already partly deforested in December 2017.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"tlC5mCiD1F"}],"key":"FXdyzmUKY7"}],"key":"dIWD9sz9op"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Certain areas delimited manually based on the Landsat images seems shifted compared to the Sentinel-2 images: i.e. the large polygon top centre. This shift may be due to the difference in resolution or slight geolocalisation differences between the sensors.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"ZQsLSu1tVj"}],"key":"TjnkCJUVha"}],"key":"H0Tdot4CQU"}],"key":"q3OxGYfzxh"}],"key":"g5wwiUpvxj"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Compare with Landsat imagery","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MusXTCSwdV"}],"identifier":"compare-with-landsat-imagery","label":"Compare with Landsat imagery","html_id":"compare-with-landsat-imagery","implicit":true,"key":"ZTupJqNBiD"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"To see the field delination on a Landsat image, we can query a Landsat image as we did for Sentinel.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"sUaxin258i"}],"key":"qIfMsJfolT"}],"key":"mItlsjUW5L"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Quizz: what is the easiest way to write an Evalscript for Landsat True Color?","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QBJCcBKQcx"}],"identifier":"quizz-what-is-the-easiest-way-to-write-an-evalscript-for-landsat-true-color","label":"Quizz: what is the easiest way to write an Evalscript for Landsat True Color?","html_id":"quizz-what-is-the-easiest-way-to-write-an-evalscript-for-landsat-true-color","implicit":true,"key":"alXZvmAmNz"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Based on Landsat ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"HnSqOxc9AJ"},{"type":"link","url":"https://docs.sentinel-hub.com/api/latest/data/landsat-8/","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"bands","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"VYYYUfeMCt"}],"urlSource":"https://docs.sentinel-hub.com/api/latest/data/landsat-8/","key":"zI5O1Ee71H"},{"type":"text","value":" available, how would you return a True Color image using the Evalscript?","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"C9WUdseRRT"}],"key":"TfpOTKQOWB"}],"key":"YoUUIMGRsh"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"evalscript_landsat_true_color = \"\"\"\"\"\"\n\n# Adjust the image size for the change in resolution\naoi_size_landsat = bbox_to_dimensions(aoi, resolution=30)","key":"XQSe5lcT6w"},{"type":"output","id":"Z_TX_ZrFrKaN-Ny_omlvJ","data":[],"key":"AZfazBAfCd"}],"key":"KDO1YPAfQk"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Uncomment the following cell for the solution. Make sure to run the following cell twice, one time for fetching the solution and a second time for running the Evalscript.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"M466WpDZDo"}],"key":"cKUvdrzU4y"}],"key":"efwDlV9v2y"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# %load https://raw.githubusercontent.com/sentinel-hub/code-snippets/master/phiweek2020/Solution2.py","key":"nU2WVRD56O"},{"type":"output","id":"_Ykq3PiWG-885CZRw0wYs","data":[],"key":"gvFwReCZLW"}],"key":"j8gKQ3ut8l"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Bonus question: how would you improve the resolution of the True Color image?","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"r64tNgYCQH"}],"key":"FQGjoYvS7B"}],"key":"VgRo0aUqxJ"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"evalscript_landsat_true_color_improved = \"\"\"\"\"\"","key":"CdGHwDnzzc"},{"type":"output","id":"snqACCIKrl8sHurkAqRRg","data":[],"key":"DqC5WZdxwb"}],"key":"s2TOkr3eSo"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Uncomment the following cell for the solution. Make sure to run the following cell twice, one time for fetching the solution and a second time for running the Evalscript.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OGDzv9heMn"}],"key":"QfAsXoKXHv"}],"key":"gD1wAEFpVk"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# %load https://raw.githubusercontent.com/sentinel-hub/code-snippets/master/phiweek2020/Solution3.py","key":"Xm0TPGYaEZ"},{"type":"output","id":"HhYXrJCbS7e_HI1BXSu_n","data":[],"key":"dZhGFIxFcq"}],"key":"RQpiUqhxL2"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Run the query (using the Evalscript of your choice) for two dates that were preselected.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wkv1HPJyUt"}],"key":"anmdI0mmje"}],"key":"YHNU1Dq4Rz"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# Make a directory to save the request\nPath('./results/landsat/before').mkdir(parents=True, exist_ok=True)\n  \nrequest = SentinelHubRequest(evalscript=evalscript_landsat_true_color,\n                             input_data=[SentinelHubRequest.input_data(data_collection=DataCollection.LANDSAT8,\n                                                                       time_interval=(\"2017-12-16\",\n                                                                                      \"2017-12-16\"))],\n                            responses=[SentinelHubRequest.output_response('default', MimeType.TIFF)],\n                            bbox=aoi,  \n                            size=aoi_size_landsat,\n                            data_folder='./results/landsat/before',\n                            config=config)\n\ntrue_color_landsat= request.get_data(save_data=True)","key":"mKPnm9mSeK"},{"type":"output","id":"m5u-QFzgmJ423aeipCFiV","data":[],"key":"dupJ7NXSc0"}],"key":"RUxcgNcEqW"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# Make a directory to save the request\nPath('./results/landsat/after').mkdir(parents=True, exist_ok=True)\n  \nrequest = SentinelHubRequest(evalscript=evalscript_landsat_true_color,\n                             input_data=[SentinelHubRequest.input_data(data_collection=DataCollection.LANDSAT8,\n                                                                       time_interval=(\"2018-01-17\",\n                                                                                      \"2018-01-17\"))],\n                            responses=[SentinelHubRequest.output_response('default', MimeType.TIFF)],\n                            bbox=aoi,  \n                            size=aoi_size_landsat,\n                            data_folder='./results/landsat/after',\n                            config=config)\n\ntrue_color_landsat= request.get_data(save_data=True)","key":"TGsKnXYWNM"},{"type":"output","id":"3mgfDeJXNkUF6eIFLaC7z","data":[],"key":"HDtw1UtTbO"}],"key":"ifx9RNm46J"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"As we did for Sentinel-2, fetch the latest folder and open the image with Rasterio.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XMyb7asPml"}],"key":"TDnklmSn1l"}],"key":"tuCsJNtYDB"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# Get folder name created\nfld_lb = [f for f in Path(\"./results/landsat/before\").iterdir() if f.is_dir()][0]\nfld_la = [f for f in Path(\"./results/landsat/after\").iterdir() if f.is_dir()][0]\n\n# Open raster with Rasterio\nraster_landsat_before = rasterio.open(str(fld_lb.joinpath(\"response.tiff\")))\nraster_landsat_after = rasterio.open(str(fld_la.joinpath(\"response.tiff\")))","key":"LydKQRsrCR"},{"type":"output","id":"q8vRcPYVCiNhrWzd347o3","data":[],"key":"PQ73SGzhTx"}],"key":"ECtgrjTQBj"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Plot the Landsat scene saved locally and show the outline of the selected field in the database","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"x6yJNBtiBO"}],"identifier":"plot-the-landsat-scene-saved-locally-and-show-the-outline-of-the-selected-field-in-the-database","label":"Plot the Landsat scene saved locally and show the outline of the selected field in the database","html_id":"plot-the-landsat-scene-saved-locally-and-show-the-outline-of-the-selected-field-in-the-database","implicit":true,"key":"qT28bQUHRE"}],"key":"w6rbcrmE2r"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"fig, (ax, ax1) = plt.subplots(nrows=1, ncols=2, figsize=(18, 10))\n\n# Plot images before and after\nshow(raster_landsat_before, ax=ax)\nshow(raster_landsat_after, ax=ax1)\n\n# Plot the field outline over the images\ngran_chaco_subset_2018.plot(ax=ax, edgecolor=\"red\", facecolor=\"none\", linewidth=2)\ngran_chaco_subset_2018.plot(ax=ax1, edgecolor=\"red\", facecolor=\"none\", linewidth=2)\n\n# Plot configuration\nfor axs in [ax, ax1]:\n    axs.set_xticks([])\n    axs.set_yticks([])\n\nax.set_title(\"2017-12-16\")\nax1.set_title(\"2018-01-17\")\n\nplt.show()","key":"SZ0MZ4oKGv"},{"type":"output","id":"urkaOLir4e1XPpgRREvvW","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"09f0808806b1f1aef3dee709aba79bc8","path":"/example-viewer/build/09f0808806b1f1aef3dee709aba79bc8.png"},"text/plain":{"content":"<Figure size 1800x1000 with 2 Axes>","content_type":"text/plain"}}}],"key":"pn7ZBX4grU"}],"key":"voGMzERdtn"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Looking at the Landsat images in December 2017 and January 2018, provides more information on how the polygons were delineated. Indeed, owing to the revisit time of Landsat (14 days) and cloud cover, some of the deforestation events that happened end of December 2017 (as we saw in the Sentinel-2 images) were missed. The Landsat acquisition on 17","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tJmaorJtfw"},{"type":"superscript","children":[{"type":"text","value":"th","key":"Li00VWoORP"}],"key":"Ze2B4FXY78"},{"type":"text","value":" January 2018 provides more insight into the timing of the deforestation. Nevertheless, two of the polygon were already partly deforested in December 2017, which could mean that the dataset contains operator errors. The images also show that the 31","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AsNysH1LvO"},{"type":"superscript","children":[{"type":"text","value":"st","key":"GL754aZ7Z8"}],"key":"Pcl5dHzV4Y"},{"type":"text","value":" January 2018 indicated in the dataset is an arbitrary date representing the entire month of January.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NSpBDi537s"}],"key":"rkzFRonUqW"}],"key":"fMy22t7gZN"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UUTAX8CeHz"}],"key":"tGppE2K0ab"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"“Filling in the Gaps” or how to use data fusion to mitigate gaps in optical imagery time series","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HzftAyyS22"}],"identifier":"filling-in-the-gaps-or-how-to-use-data-fusion-to-mitigate-gaps-in-optical-imagery-time-series","label":"“Filling in the Gaps” or how to use data fusion to mitigate gaps in optical imagery time series","html_id":"filling-in-the-gaps-or-how-to-use-data-fusion-to-mitigate-gaps-in-optical-imagery-time-series","implicit":true,"key":"hoKPHbyZqC"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"In the previous section, we were able to fetch Sentinel-2 images to observe deforestation events. However, in January all the scenes acquired were completely cloud covered. As a recap, let’s just look at cloud cover for that time of year using the previous catalog request.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"cUV7kuDFce"}],"key":"H8AWxYMOhs"}],"key":"KnVUfdNNlS"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"fig, ax = plt.subplots(nrows=1, ncols=1, figsize=(18, 10))\n\n# Plot the cloud cover for available dates\nax.plot([dt.strptime(x[0], \"%Y-%m-%dT%H:%M:%SZ\") for x in available_data], [x[1] for x in available_data], marker='o',\n        markersize=12, linestyle=\"none\", color=\"black\")\n\n# Highlight January\nax.fill_between((dt.strptime(\"2018-01-01\", \"%Y-%m-%d\"), dt.strptime(\"2018-01-31\", \"%Y-%m-%d\")), (0,0), (100,100), color=\"red\", alpha=0.3)\n\n# Plot 10% level\nax.plot([dt.strptime(x[0], \"%Y-%m-%dT%H:%M:%SZ\") for x in available_data], [10 for x in available_data], linestyle=\"--\", linewidth=2, color=\"black\")\n\n# Plot configuration\nax.set_ylim(0,100)\nax.set_ylabel(\"Cloud cover percentage\")\nax.set_xlabel(\"Date\")\n\nplt.show()","key":"kis3yXxCj0"},{"type":"output","id":"1Tm_quHFCBsI3en9BBOwk","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"0fe69697504e4786eaa1f80da1cd31ad","path":"/example-viewer/build/0fe69697504e4786eaa1f80da1cd31ad.png"},"text/plain":{"content":"<Figure size 1800x1000 with 1 Axes>","content_type":"text/plain"}}}],"key":"izszqGick9"}],"key":"iqK1Y3MClr"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We also know that the deforestation happened before the 17","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yWE3ts40Ss"},{"type":"superscript","children":[{"type":"text","value":"th","key":"QziIWvcmq9"}],"key":"MBoZ6CoLdS"},{"type":"text","value":" January 2018, when looking at the Landsat image. But is there any way of checking with another satellite platform that isn’t affected by clouds?","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fQjUeanQuD"}],"key":"fd7TaG7Su1"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"By combining optical imagery with SAR (Synthetic Aperture Radar), the shortcomings of cloud cover can be (partly) mitigated. In this example, we will use Sentinel-1 images. Although the revisit frequency of Sentinel-1 is similar to Sentinel-2 (approximately 6 days at the equator), the additional data may be used to increase the temporal resolution of time-series regardless of local atmospheric conditions.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"wyzNL6Z2PK"}],"key":"vzvgj8QlnQ"}],"key":"xvxZRsycSd"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Datafusion","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OOa9nXQ5xg"}],"identifier":"datafusion","label":"Datafusion","html_id":"datafusion","implicit":true,"key":"VyRzZNBEf9"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We recently wrote a ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"LjkgZeDnUN"},{"type":"link","url":"https://medium.com/sentinel-hub/data-fusion-combine-satellite-datasets-to-unlock-new-possibilities-26356c481169","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"blog post","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ajBPUMrnNr"}],"urlSource":"https://medium.com/sentinel-hub/data-fusion-combine-satellite-datasets-to-unlock-new-possibilities-26356c481169","key":"BNTmIvnI04"},{"type":"text","value":" about the new datafusion capabilities of Sentinel Hub services. Here, we will combine Sentinel-2 and Sentinel-1 images to detect deforestation event that happened in January.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"QcHspKlAD0"}],"key":"sIPUWGOTw9"}],"key":"cUp4bUfezQ"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"First we will use the Catalog API service again to obtain the list of available Sentinel-1 acquisitions in January 2018.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wmIjLSFfGz"}],"key":"V5d3lOkUrc"}],"key":"PmKpWzOUuC"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# Set the Catalog API url\ncatalog_url = \"https://services.sentinel-hub.com/api/v1/catalog/\"\n\n# Set the header\nheaders = {\n  'Content-Type': 'application/json'\n}\n\n# Set the Catalog request parameters\ncollections = \"sentinel-1-grd\"  # This time, we use the Sentinel 1 collection\ndatetime= \"2018-01-01T00:00:00Z/2018-01-31T23:59:59Z\"  # Time range over January 2018\n\n# Run the catalog request\nresponse = oauth.request(\"GET\", f\"https://services.sentinel-hub.com/api/v1/catalog/collections/{collections}/items?bbox={aoi_bbox[0]},{aoi_bbox[1]},{aoi_bbox[2]},{aoi_bbox[3]}&datetime={datetime}&limit=20\", headers=headers)\ncatalog_results = response.json()\n\n# Fetch the dates and write to a list\ns1_dates = []\n\nfor entry in catalog_results[\"features\"]:\n    s1_dates.append(entry[\"properties\"][\"datetime\"])\n    \nprint(s1_dates)","key":"YZhjeJiwDR"},{"type":"output","id":"IvkoVS_0oaQ890wrm9EHR","data":[{"name":"stdout","output_type":"stream","text":"['2018-01-26T09:27:02Z', '2018-01-25T22:33:01Z', '2018-01-14T09:27:02Z', '2018-01-13T22:33:01Z', '2018-01-02T09:27:03Z', '2018-01-01T22:33:02Z']\n"}],"key":"Wf7q9qhHuK"}],"key":"wHHBbJhd86"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"With the Catalog service API, we see that there are 6 images available for January 2018.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YCwi3KJMY8"}],"key":"Rg6X40dbAD"},{"type":"heading","depth":4,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Evalscript","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"n4TxTVWLrl"}],"identifier":"evalscript","label":"Evalscript","html_id":"evalscript","implicit":true,"key":"YHcvJncVdA"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"In the following Evalscript we will perform the following steps for each pixel in the image:","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"NgJM0iI6PH"}],"key":"eSzztpGTns"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":7,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"check if the pixel’s NDVI (see below) value has dropped between December and February. If it hasn’t, we will assume there was no deforestation in January and return the Sentinel-2 True Color RGB.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"inT7pm21ci"}],"key":"SCTIsrxerL"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"if the NDVI has dropped from above 0.4 to below 0.4 (an empirical threshold that we set), we then look at the backscatter between different Sentinel-1 dates.","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"MLzHrte2Ji"}],"key":"N6m4IY4WaA"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"if the drop in backscatter from a date to another is larger than a given value (once again empirically determined), then we return a colour according to the date.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"kiBExtIfDI"}],"key":"rahqnIrRCU"}],"key":"oOAyqlbXxQ"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"To perform the operations in the list above, we need:","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"yEBEx4ug4w"}],"key":"ZwQYoavDg8"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":13,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"the closest cloud-free Sentinel-2 image before January","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"YHpMl1HRua"}],"key":"vYmxkOQ23l"},{"type":"listItem","spread":true,"position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"the closest cloud-free Sentinel-2 image after January","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"ONjAdBUTDs"}],"key":"Xoo9K82zZD"},{"type":"listItem","spread":true,"position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"all Sentinel-1 images in January","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"GQXtr332ka"}],"key":"gZNgt4Ec8c"}],"key":"bkEJ9Kg1k4"}],"key":"v1iOhP9via"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"break","key":"eIIWoBhxwe"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"NDVI (Normalized difference vegetation index)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"My80LfcSbp"}],"key":"adg0m9BEeD"}],"key":"Fg0chOM14w"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The well known and widely used NDVI is a simple, but effective index for quantifying green vegetation. It normalizes green leaf scattering in Near Infra-red wavelengths with chlorophyll absorption in red wavelengths.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"McKM8Na9Kj"}],"key":"IKNh1OuiLJ"}],"key":"awnd0Rx0sd"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"The value range of the NDVI is -1 to 1. Negative values of NDVI (values approaching -1) correspond to water. Values close to zero (-0.1 to 0.1) generally correspond to barren areas of rock, sand, or snow. Low, positive values represent shrub and grassland (approximately 0.2 to 0.4), while high values indicate temperate and tropical rainforests (values approaching 1).","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"aKf7p4tssT"}],"key":"VrSdSmMsUu"},{"type":"break","key":"h9hkoVHezE"}],"key":"VEqfXkaVa6"}],"key":"sUn1h1K0Ek"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Here we color coded the changes as follows:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"w5dvJTD6ss"}],"key":"fNZxwF4ckS"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"2018-01-01 -> 2018-01-02 = ORANGE","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"sF1SI6f7FG"}],"key":"nN9Di6hl7Q"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"2018-01-02 -> 2018-01-13 = WHITE","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"P0V1jFHwPN"}],"key":"LeIiYN7YxV"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"2018-01-13 -> 2018-01-14 = BLUE","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"szh896rnoP"}],"key":"cPcT6aFIJV"},{"type":"paragraph","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"2018-01-14 -> 2018-01-25 = GREEN","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"nFBBtnkSQM"}],"key":"YlObmUwtmn"},{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"2018-01-25 -> 2018-01-26 = RED","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"ZY6o2fFiST"}],"key":"D34wvwQlVh"}],"key":"Pacbrub7IF"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"evalscript_data_fusion = \"\"\"\n//VERSION=3\n\nfunction setup (){\n  return {\n    input: [\n      {datasource: \"s1\", bands:[\"VH\"]},\n      {datasource: \"s2_before\", bands:[\"B02\", \"B03\", \"B04\", \"B08\"]},\n      {datasource: \"s2_after\", bands:[\"B02\", \"B03\", \"B04\", \"B08\"]}],\n    output: [\n      {id: \"default\", bands: 3}\n    ],\n    mosaicking: \"ORBIT\"\n  };\n}\n  \n// visualizes decibels from -20 to 0\nfunction toDb(linear) {\n  // the following commented out lines are simplified below\n  // var log = 10 * Math.log(linear) / Math.LN10\n  // var val = Math.max(0, (log + 20) / 20)\n  return Math.max(0, Math.log(linear) * 0.21714724095 + 1)\n}\n  \nfunction evaluatePixel(samples, scenes) {\n\n  // Get samples from different specified datasources\n  var s1 = samples.s1;\n  var s2before = samples.s2_before[0];\n  var s2after = samples.s2_after[0];\n \n  // Calculate NDVI before January and after\n  let ndvi_before = index(s2before.B08, s2before.B04);\n  let ndvi_after = index(s2after.B08, s2after.B04);\n  \n  // Gain for RGB images\n  var gain = 3;\n\n  // If NDVI drop between dates is more than 0.4, query S1 data,\n  // otherwise return True Color\n  if (ndvi_before > 0.4 && ndvi_after < 0.4){\n  \n    // Db difference threshold\n    let threshold_bc = 0.2;\n      \n    // Return different dates by color\n    if (toDb(s1[5].VH) - toDb(s1[4].VH) > threshold_bc){\n      return[255/255, 153/255, 51/255]\n    } else if (toDb(s1[4].VH) - toDb(s1[3].VH)  > threshold_bc){\n      return [255/255, 255/255, 255/255]\n    } else if (toDb(s1[3].VH) - toDb(s1[2].VH)  > threshold_bc){\n      return [0, 0, 255/255]\n    } else if (toDb(s1[2].VH) - toDb(s1[1].VH)  > threshold_bc){\n      return [0, 255/255, 0]\n    } else if (toDb(s1[1].VH) - toDb(s1[0].VH)  > threshold_bc){\n      return [255/255, 0, 0] // RED\n    } else {\n      return [s2after.B04 * gain, s2after.B03 * gain, s2after.B02 * gain];\n    }\n  } else {\n    return [s2after.B04 * gain, s2after.B03 * gain, s2after.B02 * gain];\n  }\n}\n\"\"\"","key":"Fdyret8zkB"},{"type":"output","id":"uslI_tUfWYwJWEwwGm6-F","data":[],"key":"dO3hL0V7Y8"}],"key":"yefU4zwPzm"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Building the request body","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VBMZHtc1nt"}],"identifier":"building-the-request-body","label":"Building the request body","html_id":"building-the-request-body","implicit":true,"key":"T7UvnSYHwN"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"When calling multiple sources of satellite data, the request body is written slightly differently to a request using a single sensor. In the following request, we need to specify as inputs: the Sentinel-1 images during January, the Sentinel-2 images before and after January. The latter are called as two separate data sources to save the number of images queried.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"cYswApQAD4"}],"key":"afobI1HFA4"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"In the input data section we show you two different ways of selecting the input parameters for the different data sources:","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"IfRIU9k8Oi"}],"key":"D1qADjSTmw"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":7,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"as a dictionary, which allows more control over the parameters","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"vizxlmZHN2"}],"key":"iDlGtTi19C"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"as a ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"PVoC36P3RG"},{"type":"inlineCode","value":"SentinelHubRequest.input_data","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"U16slX7t1F"},{"type":"text","value":" object","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"EMEpEhOpH8"}],"key":"kd8COAOwxU"}],"key":"nsV3DrnWMM"}],"key":"yjeKwUFh4b"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"request = SentinelHubRequest(\n  evalscript=evalscript_data_fusion,\n  input_data=[\n    {'type': 'S1GRD',\n     \"id\": \"s1\",\n     \"dataFilter\": {\n          \"timeRange\": {\n            \"from\": \"2018-01-01T00:00:00Z\",\n            \"to\": \"2018-01-31T23:59:59Z\"\n          }\n        },\n     \"processing\": {\n                    \"orthorectify\": \"true\"\n                   }\n    },\n    SentinelHubRequest.input_data(\n      data_collection=DataCollection.SENTINEL2_L2A,\n      time_interval=('2017-12-31', '2017-12-31'),        \n      other_args = {\"id\":\"s2_before\"}\n    ),\n    SentinelHubRequest.input_data(\n      data_collection=DataCollection.SENTINEL2_L2A,\n      time_interval=('2018-02-04', '2018-02-04'),        \n      other_args = {\"id\":\"s2_after\"}\n    ),\n    \n  ],\n  responses=[\n    SentinelHubRequest.output_response('default', MimeType.TIFF),\n    \n  ],\n  bbox=aoi,  \n  size=aoi_size,\n  config=config\n)\ndatafusion_results = request.get_data() ","key":"bxSkAfsIk0"},{"type":"output","id":"Cf2He0a8xXu7R1mTCnfeB","data":[],"key":"U6RttJ9YNk"}],"key":"RRNfGNbZI9"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Plot the resulting image","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Kvmf82umaF"}],"identifier":"plot-the-resulting-image","label":"Plot the resulting image","html_id":"plot-the-resulting-image","implicit":true,"key":"KgtWvoh27H"}],"key":"yKznQbQHKC"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"fig, ax = plt.subplots(nrows=1, ncols=1, figsize=(18, 10))\n\n# Plot the image\nax.imshow(datafusion_results[0])\n\n# Plot configuration\nfor axs in [ax, ax1]:\n    axs.set_xticks([])\n    axs.set_yticks([])\n    \npatches = [mpatches.Patch(color=\"orange\", label=\"2018-01-01 - 2018-01-02\"),\n           mpatches.Patch(facecolor=\"white\", edgecolor=\"black\", label=\"2018-01-02 - 2018-01-13\") ,\n           mpatches.Patch(color=\"blue\", label=\"2018-01-13 - 2018-01-14\"),\n           mpatches.Patch(color=\"lime\", label=\"2018-01-14 - 2018-01-25\"),\n           mpatches.Patch(color=\"red\", label=\"2018-01-25 - 2018-01-26\")]\n\nplt.legend(handles=patches, bbox_to_anchor=(1.05, 1), title=\"Deforestation timing:\", loc=2, borderaxespad=0. )\n\nax.set_title(\"Deforestation detection with Sentinel-1\")\nplt.show()","key":"dq3ysCk35o"},{"type":"output","id":"UFK3iToNNkq4hcFymS7Zs","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"58489ad4cbbcb257e136c78bd109f084","path":"/example-viewer/build/58489ad4cbbcb257e136c78bd109f084.png"},"text/plain":{"content":"<Figure size 1800x1000 with 1 Axes>","content_type":"text/plain"}}}],"key":"NnIJRuCpi2"}],"key":"r1lvl02qDb"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Thanks to the use of datafusion, we have managed to narrow down the date of deforestation, despite the large gap in optical satellite images (cloudless scenes) during January.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GGAzmBE2eb"}],"key":"ix7MlQSc6H"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"This approach is useful for a visual analysis of images, but is difficultly scalable. In the next section, we will touch upon the automation of the workflow for deforestation event detection.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ZyyfSFpnJk"}],"key":"dn1tuoYo11"}],"key":"dwBRvJPLXi"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mZl2dvP0F6"}],"key":"PUlH7Sw7Ld"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Thoughts about automated detection of deforestation events","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"V0hPZzDa6x"}],"identifier":"thoughts-about-automated-detection-of-deforestation-events","label":"Thoughts about automated detection of deforestation events","html_id":"thoughts-about-automated-detection-of-deforestation-events","implicit":true,"key":"bq3Hn23GKW"}],"key":"qQYZ3ze7Qc"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"As we have seen previously, the manual delineation of deforested parcels using optical images presents several challenges. Furthermore, the method requires significant efforts and time to be scaled up to larger areas. To investigate the potential of automated detection of deforestation, we will make use of the FIS (Feature Info Service) to extract Sentinel-2 derived variables over a given period.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MNel3hysaT"}],"key":"BZdfa2UT4x"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"In the following steps, we will query NDVI values over the entire time-series of available Sentinel-2 data to investigate trends.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"B93Mvx4Nkk"}],"key":"yG6PIgFU1W"}],"key":"M5psC30Bhc"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"First, we select a test field from our dataset. We choose a field that was fully forested in December 2017 and fully cleared in February 2018.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Pn9uNERB1e"}],"key":"yGPAkPEcNk"}],"key":"Ryq5sYgtrY"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# Select a test field\nfield = gran_chaco_subset_2018[gran_chaco_subset_2018[\"field_id\"] == 88025]","key":"IMcsXfAHkt"},{"type":"output","id":"w2SVl43_AcJlT0E2o8YZ-","data":[],"key":"F0Q1VjzXra"}],"key":"BZWvb2yfxh"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# Plot the field\nIPython.display.GeoJSON(field.__geo_interface__)","key":"COEWeyzMmO"},{"type":"output","id":"SoDa9IAcZ8GpgO7iQtEKf","data":[{"output_type":"display_data","metadata":{"application/geo+json":{"expanded":false,"root":"root"}},"data":{"application/geo+json":{"content":"{\"bbox\":[-60.19843220307759,-21.21303092065055,-60.1957618989118,-21.21017631991039],\"features\":[{\"bbox\":[-60.19843220307759,-21.21303092065055,-60.1957618989118,-21.21017631991039],\"geometry\":{\"coordinates\":[[[-60.19580365440283,-21.21017631991039],[-60.1957618989118,-21.21296613658804],[-60.19839128840967,-21.21303092065055],[-60.19843220307759,-21.21209410444676],[-60.19580365440283,-21.21017631991039]]],\"type\":\"Polygon\"},\"id\":\"31\",\"properties\":{\"created_at\":\"2020-09-25T07:57:49.678146+00:00\",\"date\":\"2018-01-31\",\"datetime\":\"2018-01-31T00:00:00.000000\",\"field_id\":88025,\"id\":88025,\"modified_at\":null,\"municipios\":\"FILADELFIA\",\"objectid\":43800,\"pais\":\"Paraguay\",\"prov_dep\":\"Boquerón\",\"shape_area\":10496734.2585813,\"shape_leng\":74575.6181798881},\"type\":\"Feature\"}],\"type\":\"FeatureCollection\"}","content_type":"application/geo+json"},"text/plain":{"content":"<IPython.display.GeoJSON object>","content_type":"text/plain"}}}],"key":"LcdAWh5UcV"}],"key":"T9DnLG0pYA"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The Sentinel Hub Python package also allows to use FIS. In the following steps we will build several requests in order to investigate the data in logical steps.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DtxBLccZR6"}],"key":"VWFZRSJHc9"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"In the first request we will query NDVI for the period ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"rRSmVr9j8r"},{"type":"inlineCode","value":"2015-01-01","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"L1cX2VY5eJ"},{"type":"text","value":" to ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"y1XwEuZ1jP"},{"type":"inlineCode","value":"2018-02-14","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"WXzjToWdH9"},{"type":"text","value":". The request looks a lot like the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"grz3pAu1lI"},{"type":"inlineCode","value":"SentinelHubRequest","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"mghEzTYNz3"},{"type":"text","value":" previously used.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"YI4gcNH7KP"}],"key":"ZTUuUHSgLy"}],"key":"dBSPZXB9oC"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# Request NDVI until February 2018\nfis_request = FisRequest(layer='NDVI',\n                         data_collection=DataCollection.SENTINEL2_L1C,\n                         geometry_list=[Geometry(field.geometry.values[0], crs=CRS.WGS84)],\n                         time=('2015-01-01', '2018-02-14'),\n                         resolution='10m',\n                         data_folder='./data',\n                         maxcc=0.1,\n                         config=config\n                         )\nndvi = fis_request.get_data(save_data=False)","key":"uBI3RAgs38"},{"type":"output","id":"lMZcqIK2w9fdZKuyYeIPv","data":[],"key":"Il1WsQ1xuJ"}],"key":"LXnsAOVc6I"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Let’s look at the results of our first request.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vfmLARRLDq"}],"key":"K6zBvbGDTh"}],"key":"tFcdZQcFGR"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"FIS request returns a list of dictionaries and is difficult to read. To make the results more readable, we created a small function to convert the results to a Pandas Dataframe.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Br7srXmQpx"}],"key":"fwOKO5YEFM"}],"key":"p6hRnBI6Je"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"def fis_data_to_dataframe(fis_data):\n    \"\"\" Creates a DataFrame from list of FIS responses\n    \"\"\"\n    COLUMNS = ['date', 'min', 'max', 'mean', 'stDev']\n    data = []\n    for fd in fis_data:\n        for channel, channel_stats in fd.items():\n            if channel == 'C0':                \n                for stat in channel_stats:\n                    row = [dt.strptime(stat['date'], \"%Y-%m-%d\")]\n                    for column in COLUMNS[1:]:\n                        row.append(stat['basicStats'][column])\n                        data.append(row)\n        \n    # Save to pandas dataframe and reset index\n    df = pd.DataFrame(data, columns=COLUMNS).sort_values(['date']).drop_duplicates()\n    df.reset_index(drop=True, inplace=True)\n    \n    return df","key":"UD3jUA7uvD"},{"type":"output","id":"djRS1tnTPbB5VbYi4ZBaT","data":[],"key":"eUqjTLx3lO"}],"key":"KyyAtoxten"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# Convert the FIS results to a dataframe\nndvi_df = fis_data_to_dataframe(ndvi)\n\n# Drop a date (visually identified as hazy)\nndvi_df.drop(ndvi_df.loc[ndvi_df['date']==\"2016-12-01\"].index, inplace=True)","key":"sM3c9Spc0w"},{"type":"output","id":"3XPgwU6pOJbEDDP4Y9xeK","data":[],"key":"mC4lvbnfV5"}],"key":"kQtkUczl87"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"In the next cell, we plot the results of the first request, nicely formatted in a Pandas Dataframe.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EaQBg31gBU"}],"key":"scxFPYMS9X"}],"key":"H3inqpIgKk"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"ndvi_df","key":"wYzCI1TKzD"},{"type":"output","id":"xDJ5-32jaGQ7jxC88Z0ys","data":[{"output_type":"execute_result","execution_count":51,"metadata":{},"data":{"text/html":{"content":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>date</th>\n      <th>min</th>\n      <th>max</th>\n      <th>mean</th>\n      <th>stDev</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>2015-08-19</td>\n      <td>0.296769</td>\n      <td>0.491071</td>\n      <td>0.394382</td>\n      <td>0.038699</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>2016-05-05</td>\n      <td>0.554760</td>\n      <td>0.674749</td>\n      <td>0.611015</td>\n      <td>0.017103</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>2016-05-25</td>\n      <td>0.549717</td>\n      <td>0.671712</td>\n      <td>0.608374</td>\n      <td>0.018733</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>2016-06-14</td>\n      <td>0.493660</td>\n      <td>0.647059</td>\n      <td>0.569957</td>\n      <td>0.025341</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>2016-07-24</td>\n      <td>0.331935</td>\n      <td>0.554909</td>\n      <td>0.459868</td>\n      <td>0.045902</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>2016-08-13</td>\n      <td>0.259259</td>\n      <td>0.461212</td>\n      <td>0.369056</td>\n      <td>0.038158</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>2016-09-22</td>\n      <td>0.231492</td>\n      <td>0.396070</td>\n      <td>0.314037</td>\n      <td>0.032888</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>2016-11-01</td>\n      <td>0.350860</td>\n      <td>0.557269</td>\n      <td>0.452450</td>\n      <td>0.030195</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>2017-01-30</td>\n      <td>0.384566</td>\n      <td>0.584973</td>\n      <td>0.474981</td>\n      <td>0.033159</td>\n    </tr>\n    <tr>\n      <th>10</th>\n      <td>2017-07-14</td>\n      <td>0.372168</td>\n      <td>0.587928</td>\n      <td>0.474271</td>\n      <td>0.040521</td>\n    </tr>\n    <tr>\n      <th>11</th>\n      <td>2017-08-03</td>\n      <td>0.315810</td>\n      <td>0.538263</td>\n      <td>0.428944</td>\n      <td>0.041209</td>\n    </tr>\n    <tr>\n      <th>12</th>\n      <td>2017-08-23</td>\n      <td>0.276899</td>\n      <td>0.470610</td>\n      <td>0.362794</td>\n      <td>0.037320</td>\n    </tr>\n    <tr>\n      <th>13</th>\n      <td>2017-09-12</td>\n      <td>0.215407</td>\n      <td>0.345781</td>\n      <td>0.276094</td>\n      <td>0.024354</td>\n    </tr>\n    <tr>\n      <th>14</th>\n      <td>2017-09-17</td>\n      <td>0.254438</td>\n      <td>0.373612</td>\n      <td>0.314785</td>\n      <td>0.020758</td>\n    </tr>\n    <tr>\n      <th>15</th>\n      <td>2017-11-21</td>\n      <td>0.262090</td>\n      <td>0.482441</td>\n      <td>0.358059</td>\n      <td>0.035789</td>\n    </tr>\n    <tr>\n      <th>16</th>\n      <td>2017-12-11</td>\n      <td>0.576687</td>\n      <td>0.723410</td>\n      <td>0.669601</td>\n      <td>0.025504</td>\n    </tr>\n    <tr>\n      <th>17</th>\n      <td>2017-12-31</td>\n      <td>0.649654</td>\n      <td>0.759532</td>\n      <td>0.712077</td>\n      <td>0.022596</td>\n    </tr>\n    <tr>\n      <th>18</th>\n      <td>2018-02-04</td>\n      <td>0.167570</td>\n      <td>0.383191</td>\n      <td>0.233119</td>\n      <td>0.029782</td>\n    </tr>\n    <tr>\n      <th>19</th>\n      <td>2018-02-09</td>\n      <td>0.125267</td>\n      <td>0.381443</td>\n      <td>0.179558</td>\n      <td>0.032394</td>\n    </tr>\n    <tr>\n      <th>20</th>\n      <td>2018-02-14</td>\n      <td>0.161290</td>\n      <td>0.419245</td>\n      <td>0.229381</td>\n      <td>0.031654</td>\n    </tr>\n  </tbody>\n</table>\n</div>","content_type":"text/html"},"text/plain":{"content":"         date       min       max      mean     stDev\n0  2015-08-19  0.296769  0.491071  0.394382  0.038699\n1  2016-05-05  0.554760  0.674749  0.611015  0.017103\n2  2016-05-25  0.549717  0.671712  0.608374  0.018733\n3  2016-06-14  0.493660  0.647059  0.569957  0.025341\n4  2016-07-24  0.331935  0.554909  0.459868  0.045902\n5  2016-08-13  0.259259  0.461212  0.369056  0.038158\n6  2016-09-22  0.231492  0.396070  0.314037  0.032888\n7  2016-11-01  0.350860  0.557269  0.452450  0.030195\n9  2017-01-30  0.384566  0.584973  0.474981  0.033159\n10 2017-07-14  0.372168  0.587928  0.474271  0.040521\n11 2017-08-03  0.315810  0.538263  0.428944  0.041209\n12 2017-08-23  0.276899  0.470610  0.362794  0.037320\n13 2017-09-12  0.215407  0.345781  0.276094  0.024354\n14 2017-09-17  0.254438  0.373612  0.314785  0.020758\n15 2017-11-21  0.262090  0.482441  0.358059  0.035789\n16 2017-12-11  0.576687  0.723410  0.669601  0.025504\n17 2017-12-31  0.649654  0.759532  0.712077  0.022596\n18 2018-02-04  0.167570  0.383191  0.233119  0.029782\n19 2018-02-09  0.125267  0.381443  0.179558  0.032394\n20 2018-02-14  0.161290  0.419245  0.229381  0.031654","content_type":"text/plain"}}}],"key":"ECHwvrR8pa"}],"key":"Hl7YjAOYNv"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Next, we build a second request that runs from February 2018 to today, to see how NDVI evolves after deforestation has happened.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xu1JsIP1QN"}],"key":"XLKE9cyXKv"}],"key":"ORLo7DLOiV"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# Build the request after deforestation\nfis_request = FisRequest(layer='NDVI',\n                         data_collection=DataCollection.SENTINEL2_L1C,\n                         geometry_list=[Geometry(field.geometry.values[0], crs=CRS.WGS84)],\n                         time=('2018-02-14', dt.today()),\n                         resolution='10m',\n                         data_folder='./data',\n                         maxcc=0.05,\n                         config=config\n                         )\n\n# Run the request\nndvi_updated = fis_request.get_data(save_data=False)\n\n# Convert the results to a dataframe\nndvi_df_updated = fis_data_to_dataframe(ndvi_updated)","key":"r8Q6HTWP4L"},{"type":"output","id":"o8-qNa8Ema01ySY4aG8Iy","data":[],"key":"LLA4GkK8ib"}],"key":"kD31o6mqmV"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Finally, we are interested in comparing the temporal evolution of NDVI to that of a parcel that was not deforested. To do so, we selected an area that was still forested in September 2020>","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ITADqFlpeP"}],"key":"oOs5sy4apG"}],"key":"WTyqg2R1uA"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# We select a parcel of forest of approximately the same size of our field for comparison purposes\nforest = [ -60.19555112, -21.23150358, -60.18345680, -21.22224216]\naoi_forest = BBox(bbox=forest, crs=CRS.WGS84)","key":"SFUlWxSKuB"},{"type":"output","id":"ovMtyUp8ezgB1wpul8fJU","data":[],"key":"C9IUHG4rVa"}],"key":"POCdaObHWg"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# Build the request\nfis_request = FisRequest(layer='NDVI',\n                         data_collection=DataCollection.SENTINEL2_L1C,\n                         geometry_list=[aoi_forest],\n                         time=('2015-01-01', dt.today()),\n                         resolution='10m',\n                         maxcc=0.05,\n                         config=config\n                         )\n# Run the request\nforest_patch = fis_request.get_data(save_data=False)\n\n# Convert the results to a dataframe\nforest_df = fis_data_to_dataframe(forest_patch)\n\n# Drop a date (visually identified as hazy)\nforest_df.drop(forest_df.loc[forest_df['date']==\"2018-09-12\"].index, inplace=True)","key":"qz1yXp1BRH"},{"type":"output","id":"LHYl9IJQGIo_uuZd4eVbH","data":[],"key":"OA3BsKHzkc"}],"key":"S4k5uBwodl"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Plot the mean NDVI of the selected field over the date range","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SS6cFpsqEv"}],"identifier":"plot-the-mean-ndvi-of-the-selected-field-over-the-date-range","label":"Plot the mean NDVI of the selected field over the date range","html_id":"plot-the-mean-ndvi-of-the-selected-field-over-the-date-range","implicit":true,"key":"Z2dvF1w7tf"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Now our data is ready, we can plot it in steps.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"JHDhAPYpbT"}],"key":"jrEN4jr4GI"}],"key":"zMIBqbDMWo"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"def plot_timeline(step=1):\n    \"\"\"Plot timeline.\"\"\"\n    \n    # Check step value\n    if (step < 1 or step >4):\n        raise ValueError(\"Step out of range 1-4\")\n        \n    # Setup subplots\n    fig = plt.figure(figsize=(18,14))\n    gs = fig.add_gridspec(2, 2)\n    ax = fig.add_subplot(gs[1, :])\n    ax2 = fig.add_subplot(gs[0, 0])\n    ax2.set_title('gs[1, :-1]')\n    ax3 = fig.add_subplot(gs[0, 1])\n    ax3.set_title('gs[1, :-1]')\n\n    ###########\n    # 1. Plot the rasters of the field as a reminder\n    show(raster_before, ax=ax2)\n    ax2.set_title(dt.strftime(available_datetimes[before_ind], \"%Y-%m-%d\"))\n    show(raster_after, ax=ax3)\n    ax3.set_title(dt.strftime(available_datetimes[after_ind], \"%Y-%m-%d\"))\n\n    # 2. Plot the mean NDVI until the deforestation\n    ndvi_df.plot(x='date', y='mean', ax=ax, linestyle='-', marker='.', label=r\"Mean NDVI of the field $\\pm 1\\sigma$\" )\n\n    # Plot the standard deviation as a shaded area\n    ax.fill_between(ndvi_df.date,\n                    (ndvi_df[\"mean\"] - ndvi_df[\"stDev\"]),\n                    (ndvi_df[\"mean\"] + ndvi_df[\"stDev\"]),\n                    alpha=0.3)\n\n    # Highlight before and after dates\n    ax.scatter([\"2017-12-31\", \"2018-02-04\"], [ndvi_df[ndvi_df[\"date\"]==\"2017-12-31\"][\"mean\"], ndvi_df[ndvi_df[\"date\"]==\"2018-02-04\"][\"mean\"]], marker=\"o\", s=65, color=\"red\")\n\n    ###########\n    if step >= 2:\n        # 2. Plot period after the identified deforestation event\n        ndvi_df_updated.plot(x='date', y='mean', ax=ax, linestyle='-', marker='.',\n                             color=\"indianred\", label=\"Period after deforestation\" )\n        ax.fill_between(ndvi_df_updated.date, ndvi_df_updated[\"mean\"] - ndvi_df_updated[\"stDev\"],\n                        ndvi_df_updated[\"mean\"] + ndvi_df_updated[\"stDev\"],\n                        alpha=0.3, color=\"indianred\")\n\n    ###########\n    if step >= 3:\n        # 3. Plot dry season months\n        ax.fill_between((\"2015-08-01\", \"2015-10-30\"), (0,0), (1,1), color=\"lightgrey\", alpha=0.7)\n        ax.fill_between((\"2016-08-01\", \"2016-10-30\"), (0,0), (1,1), color=\"lightgrey\", alpha=0.7)\n        ax.fill_between((\"2017-08-01\", \"2017-10-30\"), (0,0), (1,1), color=\"lightgrey\", alpha=0.7)\n        ax.fill_between((\"2018-08-01\", \"2018-10-30\"), (0,0), (1,1), color=\"lightgrey\", alpha=0.7)\n        ax.fill_between((\"2019-08-01\", \"2019-10-30\"), (0,0), (1,1), color=\"lightgrey\", alpha=0.7)\n        ax.fill_between((\"2020-08-01\", \"2020-10-30\"), (0,0), (1,1), color=\"lightgrey\", alpha=0.7)\n\n    ###########\n    if step == 4:\n        # 4. Plot forest patch NDVI\n        forest_df.plot(x='date', y='mean', ax=ax, linestyle='-', marker='.', color=\"forestgreen\", label=\"Patch of forest close to AOI\" )\n    \n    # Plot configuration\n    ax.legend()\n    ax.set_ylabel(\"NDVI\")\n    ax.set_xlabel(\"Date\")\n    ax.set_ylim(0, 1)\n\n    ax.tick_params(axis='both', direction='inout', )\n    ax.xaxis.set_major_locator(mdates.MonthLocator(interval=2))\n    ax.yaxis.set_major_locator(plt.MultipleLocator(0.1))\n    ax.yaxis.set_ticks_position(\"both\")\n\n    for axs in [ax2, ax3]:\n        field.plot(ax=axs, edgecolor=\"red\", facecolor=\"none\", linewidth=2)\n        axs.set_xticks([])\n        axs.set_yticks([])\n\n    plt.show()","key":"dwzTRGRzap"},{"type":"output","id":"WPAJ9b2oRy9kRCSHecyog","data":[],"key":"HjyLgBC4Bm"}],"key":"YlDn8lJZLF"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Plot the data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"K2IHnUDI3C"}],"identifier":"plot-the-data","label":"Plot the data","html_id":"plot-the-data","implicit":true,"key":"piub2TS3bt"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Plot the time series by changing the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"s6xI9JaIfH"},{"type":"inlineCode","value":"step","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"cBuOhSp9Hs"},{"type":"text","value":" parameter incresingly from 1 to 4, and observe the graph at each step>","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"s7WV6kGfos"}],"key":"dHkzoG4Xay"}],"key":"OyjaQ0PPPR"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"plot_timeline(step=4)","key":"gHagRtFpSy"},{"type":"output","id":"6XvyzFmtTlkHL9HDYmPG9","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"bb177cbaccbf3a28cc6b6a339cb15948","path":"/example-viewer/build/bb177cbaccbf3a28cc6b6a339cb15948.png"},"text/plain":{"content":"<Figure size 1800x1400 with 3 Axes>","content_type":"text/plain"}}}],"key":"EHXlVbEumP"}],"key":"T8mgl6poxx"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Exploring time-series of satellite imagery with FIS is an easy way to understand the data without having to query dozens of images.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uCtuqwV9Nh"}],"key":"n3RSVB5Meu"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"What does the time series of data tell us?","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"TwNmmO5ksu"}],"key":"PH8RzzV1QE"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Step 1:","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"IpTHy4px8w"}],"key":"bZXKJ7K8ee"}],"key":"Tn9IQtt1CY"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"The NDVI values have small variations over the years, but we notice a very sharp decrease at the time of the identified deforestation event (before and after deforestation are highlighted in red). Can this drop in NDVI be used to detect deforestation?","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Z2K1Vf3hAI"}],"key":"rd9s1zMR1P"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"strong","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Step 2:","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"srHMzQcsxa"}],"key":"VwkGOegXNq"}],"key":"tnlGZ1o3ep"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"When looking at the entire time-series of our field until today, we notice large variations in NDVI, with high values followed by large drops. These trends represent cultivated fields that are harvested and cannot be differentiated from deforestation events.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"dRTi08vOUa"}],"key":"vKaAEJgrw9"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"strong","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Step 3:","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"Z9mDmm8nr1"}],"key":"pldkzvJa5o"}],"key":"hOFIP6CnpY"},{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"If we shade the dry season each year, we can see that there is a drop in NDVI for forested areas. Furthermore, the harvesting period also corresponds to the dry season. We also notice more variation in the data outside of the dry season.","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"DQU5x44ejz"}],"key":"jzLHuacGVp"},{"type":"paragraph","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"strong","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"Step 4:","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"Qs9pgq5ik0"}],"key":"a2YY1xtXcY"}],"key":"yjvzhyd0Qs"},{"type":"paragraph","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"By plotting the entire time-series of available Sentinel-2 data for a forested patch close the to the selected field, we can compare trends between forested areas and areas after deforestation then cultivation. We can also see that the drop in NDVI for the forest isn’t as pronounced during the dry season than for cultivated fields.","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"oa8vVWzUlr"}],"key":"Eod2S8QhYO"},{"type":"paragraph","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"This graph, along with the previous plots, can provide hints on how to implement an automated workflow to detect a deforestation event, without confusing deforestation with harvesting. Maybe you have some ideas? If you want to explore the subject in more detail, you can run through the following “bonus” section...","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"mC4CRg9gtq"}],"key":"mt6C6JX8Xb"}],"key":"t6psCZZ1Ya"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aHWHsJRpUi"}],"key":"Sq2QyHlXPr"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"END OF GUIDED TUTORIAL","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KYXhggBj6N"}],"key":"ELM6AyQhG1"}],"key":"f01GvywWnV"}],"key":"lyjDuQqLq9"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZeNoUUX6KD"}],"key":"Jl2OCkUGs4"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Bonus example: testing the implementation of an automated deforestation detection method using Sentinel-2 images","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bcQ6BfMbYA"}],"identifier":"bonus-example-testing-the-implementation-of-an-automated-deforestation-detection-method-using-sentinel-2-images","label":"Bonus example: testing the implementation of an automated deforestation detection method using Sentinel-2 images","html_id":"bonus-example-testing-the-implementation-of-an-automated-deforestation-detection-method-using-sentinel-2-images","implicit":true,"key":"iUTfVqnKZG"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"If you want to continue exploring test cases of Sentinel Hub services in the Euro Data Cube, the following cells show an example workflow that automatically detects deforestation events from Sentinel-2 images.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"VM0bkV6oPw"}],"key":"mXkKaNuWyP"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"This empirical method was designed to showcase Sentinel hub features and probably only works locally. If you think of a better solution, don’t hesitate to implement it and share it with the World through the EDC Marketplace!","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"ZgxhdqHmku"}],"key":"AzYpIXxtF8"}],"key":"PKM3zTA8uM"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"NDVI comparison before / after a deforestation event","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WooJ7NNlUy"}],"identifier":"ndvi-comparison-before-after-a-deforestation-event","label":"NDVI comparison before / after a deforestation event","html_id":"ndvi-comparison-before-after-a-deforestation-event","implicit":true,"key":"R3Fm3ASWIX"}],"key":"AGGtulckZe"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"In the previous graph, we have seen that even after a deforestation event, there are periods where the NDVI peaks, and is followed by a sharp drop.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"X0cHVpuoDG"}],"key":"Ryl9aXxoc9"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"First, let’s inspect the difference between the maximum NDVI before the know deforestation date, and an other peak later on.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"KSmkuS0F5Q"}],"key":"KyQKbSCRcM"}],"key":"NhxrK30jBC"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Looking at the graph we will compare the True Color and NDVI images of the selected field on ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SzAekEclKT"},{"type":"inlineCode","value":"2017-12-31","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PnZsForKhK"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AFe7K8suuz"},{"type":"inlineCode","value":"2018-11-11","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EKfwzIfvNm"},{"type":"text","value":". We start by requesting a True Color RGB and NDVI band in the Evalscript.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KdRIpZGIBI"}],"key":"SxEwyEZpTp"}],"key":"qg1M9MDEeY"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"evalscript_multi_response = \"\"\"\n//VERSION=3\n\nfunction setup() {\n  return {\n    input: [\"B02\", \"B03\", \"B04\", \"B08\"],\n    output: [{\n        id: \"truecolor\",\n        bands: 3\n        },\n        {\n        id: \"ndvi\",\n        bands: 1,\n        sampleType: SampleType.UINT16\n        }\n    ]\n  };\n}\n\nfunction evaluatePixel(sample) {\n  let ndvi = index(sample.B08, sample.B04);\n  \n  let gain = 3.5;\n  return {\"truecolor\": [gain * sample.B04, gain * sample.B03, gain * sample.B02],\n         \"ndvi\": [10000 * ndvi + 10000]};\n}\n\"\"\"","key":"szlmzrBJrD"},{"type":"output","id":"JimudrJeyhSr7qae9n4Ux","data":[],"key":"ETlDyN81Gd"}],"key":"uI7xUn1YCd"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Note that we returned ndvi as ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IYWidzykd9"},{"type":"inlineCode","value":"UINT16","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gNXaspUH2u"},{"type":"text","value":" with the following operation: ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gMkR5lxXcW"},{"type":"inlineCode","value":"[10000 * ndvi + 10000]","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RkLa5dfyLa"}],"key":"wW3CptGLDW"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"This trick reduces the size of the returned image, as well as the number of Processing Units used with Sentinel Hub’s process API. You can then convert the returned product back to floats by doing: ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"sNIwTW0Jm7"},{"type":"inlineCode","value":"ndvi_float = (ndvi - 10000.)/10000.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"sLt6bWhyj6"}],"key":"B10Ha9G69T"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Of course, you can request the NDVI band as ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"oxkbYw1XaE"},{"type":"inlineCode","value":"FLOAT32","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"xxt7NhD5Pj"},{"type":"text","value":" directly if you wish.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Pjjx1huNgq"}],"key":"Zpq2ENXus3"}],"key":"EXoE2vDsSJ"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# Set AOI bounding box for our example field and image size according to desired resolution\nresolution = 10\naoi_field = BBox(bbox=field.geometry.bounds.values.tolist()[0], crs=CRS.WGS84)\naoi_field_size = bbox_to_dimensions(aoi, resolution=resolution)","key":"FPfaQcfhQR"},{"type":"output","id":"IIgDwvlHv6NbDgt-b3v7-","data":[],"key":"sjcrI2agV3"}],"key":"DpnS6hrR02"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"In the next cell we create the request body in a loop for both dates and append the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mS5iaEhIFx"},{"type":"inlineCode","value":"SentinelHubRequest","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mQXWGOkF28"},{"type":"text","value":" to a list.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mijApDWzLr"}],"key":"Bb8uOZWKLb"}],"key":"Ieqv1JdNpV"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"date_list = [\"2017-12-31\", \"2018-11-11\"]\nrequests = []\n\nfor date in date_list:\n    requests.append(SentinelHubRequest(evalscript=evalscript_multi_response,\n                                       input_data=[SentinelHubRequest.input_data(data_collection=DataCollection.SENTINEL2_L2A,\n                                                                                 time_interval=(date,\n                                                                                                date))],\n                                responses=[SentinelHubRequest.output_response('truecolor', MimeType.TIFF),\n                                           SentinelHubRequest.output_response('ndvi', MimeType.TIFF)],\n                                bbox=aoi_field,  \n                                size=aoi_field_size,\n                                config=config))","key":"AnFBqW1gBu"},{"type":"output","id":"RglshrAgw7tgy61ce3BSU","data":[],"key":"LwWsmJFyX7"}],"key":"ruY0PmMV0R"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# Fetch the data for both requests\nt1 = requests[0].get_data()\nt2 = requests[1].get_data()","key":"uckdCSs23Y"},{"type":"output","id":"pJtbmleCKOMJnaDRn62cj","data":[],"key":"zDpOpEPEMC"}],"key":"BwUo9bEZKr"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":5,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Plot the True Color image and NDVI for the two selected dates","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"V8AKLoyR9h"}],"identifier":"plot-the-true-color-image-and-ndvi-for-the-two-selected-dates","label":"Plot the True Color image and NDVI for the two selected dates","html_id":"plot-the-true-color-image-and-ndvi-for-the-two-selected-dates","implicit":true,"key":"XNC9gIbjv5"}],"key":"xLxT45HQmg"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"fig = plt.figure(figsize=(16,14))\ngs = fig.add_gridspec(2, 2, width_ratios=(20, 20),wspace=0.1, hspace=0.1)\n\n# Setup subplots\nax = fig.add_subplot(gs[0, 0])\nax1 = fig.add_subplot(gs[0, 1])\nax3 = fig.add_subplot(gs[1, 0])\nax4 = fig.add_subplot(gs[1, 1])\n\n# Plot True Color images\nax.imshow(t1[0]['truecolor.tif'])\nax1.imshow(t2[0]['truecolor.tif'])\n\n# Plot NDVI (converting to floats)\nndvi_pl = ax3.imshow((t1[0]['ndvi.tif'] - 10000.)/10000., cmap=\"Greens\", vmin=0, vmax=1)\nax4.imshow((t2[0]['ndvi.tif'] - 10000.)/10000., cmap=\"Greens\", vmin=0, vmax=1)\n\n# Plot configuration\nfor axs in [ax, ax1, ax3, ax4]:\n    axs.set_xticks([])\n    axs.set_yticks([])\n    \nax.set_ylabel(\"True Color RGB\")\nax3.set_ylabel(\"NDVI\")\nax.set_title(\"2017-12-11\")\nax1.set_title(\"2018-11-11\")\n\n# Setup colorbar\naxins = inset_axes(ax4, \n               width=\"5%\",  \n               height=\"100%\",  \n               loc='lower left',\n               bbox_to_anchor=(1.05, 0.0, 1, 1),\n               bbox_transform=ax4.transAxes,\n               borderpad=0,\n               )\n\ncb = fig.colorbar(ndvi_pl, cax=axins)\n\nplt.show()","key":"i2Jmykbl1x"},{"type":"output","id":"AppS8WYc6pHGYV__5Qp9H","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"9056164dab6c6859c214294cb0bd87d8","path":"/example-viewer/build/9056164dab6c6859c214294cb0bd87d8.png"},"text/plain":{"content":"<Figure size 1600x1400 with 5 Axes>","content_type":"text/plain"}}}],"key":"R3dtt3uhuV"}],"key":"idJoG9EJ5L"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The above image shows that it is difficult to differenciate between forest and cultures. The NDVI values are also similar between crops and forest, even though a pattern in the cultivated field is visible. Nevertheless, the values are similar if averaged over the field.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JmvVX3MFj2"}],"key":"D3pCNP3adE"}],"key":"lIDvfaKelA"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Implementation of an empirical automated approach","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yV4JMRqYsa"}],"identifier":"implementation-of-an-empirical-automated-approach","label":"Implementation of an empirical automated approach","html_id":"implementation-of-an-empirical-automated-approach","implicit":true,"key":"FCrZ2EUMx2"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Based on the graph of NDVI values over time, we saw that a drop in NDVI doesn’t always signify a deforestation event, and can also be linked to harvesting fields. We also saw in the plot above, that it is very difficult to differentiate the NDVi of forest and cultivated deforested parcels. However, the graph showed that the minimum NDVI observed during the dry season is higher for forested areas than for cultivated areas.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"M9aNbjeFtB"}],"key":"yOIiG1Dzxe"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Based on these observations we will design an algorithm that accounts for the following points:","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"U3aDfsrwRF"}],"key":"UgXniUvbzv"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":7,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"We will loop through each available image (with less than 5% cloud cover) in a given period.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"XuTHehaixm"}],"key":"EDwHAHt7uH"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"For each image, if the NDVI of the dry season preceding the date is higher than an arbitrary threshold, we consider that the pixel was forested the previous year.","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"shgxeQMhnf"}],"key":"z3Be1U9vui"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"If the pixel is considered as forested the previous year, we compare the difference in NDVI with the previous date in the time-series, looking for a large drop in NDVI. If we observe a drop (more than an arbitrary threshold), then we assume a deforestation event. However, a pixel can only be deforested once: only the first event in the time series is recorded.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"OAcDzql0yG"}],"key":"XGwgFhOif3"}],"key":"Q3XRRSj54C"}],"key":"YZwOL3BOi9"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"First we will set a time period (three months for this example), then use the Catalog API to fetch the valid images over our area of interest (here the overall area defined at the beginning of the Jupyter Notebook.)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Rf8mJAXFE9"}],"key":"dHwPBhirH9"}],"key":"RE8UJ5dsK2"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# Set start and end date of each period\nSTART_DATE = '2018-01-01'\nEND_DATE = '2018-03-31'\n\n# Query the period using Catalog API (if you get a token error, don't forget to request a new token higher up)\ncollections = \"sentinel-2-l1c\"\ndatetime= f\"{START_DATE}T00:00:00Z/{END_DATE}T23:59:59Z\"\n\n# Run the catalog request\nresponse = oauth.request(\"GET\", f\"https://services.sentinel-hub.com/api/v1/catalog/collections/{collections}/items?bbox={aoi_bbox[0]},{aoi_bbox[1]},{aoi_bbox[2]},{aoi_bbox[3]}&datetime={datetime}&limit=20\", headers=headers)\ncatalog_results = response.json()\n\n# Fetch the dates and cloud cover values\navailable_data = []\nfor entry in catalog_results[\"features\"]:\n    available_data.append((entry[\"properties\"][\"datetime\"], entry[\"properties\"][\"eo:cloud_cover\"]))\n\n# Make a list of dates for cloud_cover less than 5%\ncloud_free_dates = [x[0] for x in available_data if x[1] <= 5]\n\n# Reverse to match Evalscript output\ncloud_free_dates.reverse()","key":"JfLYyYn7RU"},{"type":"output","id":"rqOy2UwaSPgpYMQd3QJhq","data":[],"key":"L6Gzz929Lm"}],"key":"QAnNWkicYL"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"In the following Evalscript, we will request 4 data outputs for each available image in 2018:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"am0Iez9Rcz"}],"key":"khwVpobFv9"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"B02 (Blue)","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"lJJJyQ1ZiJ"}],"key":"sPeUUZUbYN"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"B03 (Green)","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"bhBqVjrBAZ"}],"key":"nQ8dDebDjr"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"B04 (Red)","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"L55SzjyZZu"}],"key":"onZcFfR37e"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"A binary product containing the “deforested” pixels (value = 1) for further processing.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"jSznvJfHI1"}],"key":"oQYzHdY6j6"}],"key":"mni1V7E5Rp"}],"key":"JvHiGiOFdZ"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"deforestation_basic_evalscript = \"\"\"\n//VERSION=3\n\n// number of days with a valid image\nconst n_days = {number_days};\n\n\nfunction setup (){{\n  // Sentinel Hub's function that prepares inputs/outputs\n  return {{\n    input: [\n      // We need 2 datasources for S2L2A, because we are \n      // querying 2 different time ranges\n      {{datasource: \"l2a_winter\", bands:[\"B04\", \"B08\"]}},\n      {{datasource: \"l2a\", bands:[\"B02\", \"B03\", \"B04\", \"B08\"]}}],\n    output: [\n      {{id: \"deforestation_band\", bands: n_days , sampleType: \"UINT8\"}},\n      {{id: \"B02\", bands: n_days , sampleType: \"UINT16\"}},\n      {{id: \"B03\", bands: n_days , sampleType: \"UINT16\"}},\n      {{id: \"B04\", bands: n_days , sampleType: \"UINT16\"}}\n  ],\n  mosaicking: \"ORBIT\"\n  }};\n}}\n\n\nfunction evaluatePixel(samples, scenes) {{\n  // Sentinel Hub's function that processes the data\n  \n  var S2L2A_scenes = scenes.l2a.scenes;\n  var L2AW = samples.l2a_winter;\n  var S2L2A = samples.l2a;\n\n  // 1. Calculate the average NDVI in the winter of the previous year\n  var ndvi = 0;\n\n  for (var i = 0; i < L2AW.length; i++) {{\n    ndvi += index(L2AW[i].B08, L2AW[i].B04);\n  }}\n\n  var avg_ndvi = ndvi / L2AW.length;\n    \n  // 2. Run through all the dates in 2018 and detect deforestation events\n\n  //  Initialise data\n  var cloudless_bands = {{'B02':new Array(n_days).fill(0),\n                         'B03':new Array(n_days).fill(0),\n                         'B04':new Array(n_days).fill(0),\n                         'representation':new Array(n_days).fill(0)}};\n                         \n  var count = 0;\n  var deforestation_sum = 0;\n  var deforestation = [];\n\n  for (var j = S2L2A.length-2; j >= 0; j--){{\n    if (index(S2L2A[j+1].B08, S2L2A[j+1].B04) - index(S2L2A[j].B08, S2L2A[j].B04) > 0.2){{\n      if (avg_ndvi >= 0.35 && deforestation_sum == 0 && index(S2L2A[j].B08, S2L2A[j].B04) < 0.4){{\n        deforestation.push(1);\n        deforestation_sum += 1;\n      }} else {{\n        deforestation.push(0);\n      }}\n    }} else{{\n      deforestation.push(0);\n    }}\n    // Fill bands with data\n    cloudless_bands['B02'][count] = S2L2A[j].B02 * 65535;\n    cloudless_bands['B03'][count] = S2L2A[j].B03 * 65535;\n    cloudless_bands['B04'][count] = S2L2A[j].B04 * 65535;\n    \n    count += 1;\n  }}\n  \n\n  return {{\"deforestation_band\": deforestation,\n          \"B02\": cloudless_bands.B02,\n          \"B03\": cloudless_bands.B03,\n          \"B04\": cloudless_bands.B04}};\n}}\n\"\"\"","key":"hLcfVFJ7V8"},{"type":"output","id":"4nQLId55hpv1yuz8NQFcI","data":[],"key":"e2vOzRw6Or"}],"key":"znAL074FDm"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"In the follwing cell we build the request, and run it, saving the results to a file, since we want to open the files with rasterio to vectorise the results.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jYGvsAtyYU"}],"key":"SOxbGrQw7R"}],"key":"nlscnDNhsK"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"request = SentinelHubRequest(\n  evalscript=deforestation_basic_evalscript.format(number_days=len(cloud_free_dates)-1),\n  input_data=[\n    SentinelHubRequest.input_data(\n      data_collection=DataCollection.SENTINEL2_L2A,\n      time_interval=(START_DATE, END_DATE),        \n      other_args = {\"dataFilter\":{\"maxCloudCoverage\":\"5\"},\"id\":\"l2a\"}\n    ),\n    SentinelHubRequest.input_data(\n      data_collection=DataCollection.SENTINEL2_L2A,\n      time_interval=('2017-08-01', '2017-10-01'),        \n      other_args = {\"dataFilter\":{\"maxCloudCoverage\":\"5\"},\"id\":\"l2a_winter\"}\n    ),\n    \n  ],\n  responses=[\n    SentinelHubRequest.output_response('deforestation_band', MimeType.TIFF),\n    SentinelHubRequest.output_response('B02', MimeType.TIFF),\n    SentinelHubRequest.output_response('B03', MimeType.TIFF),\n    SentinelHubRequest.output_response('B04', MimeType.TIFF),\n    \n  ],\n  bbox=aoi_overview,  \n  size=aoi_overview_size,\n  data_folder='./results/deforestation',\n\n  config=config\n)\nresponse = request.get_data(save_data=True) ","key":"Xh48fKbJq7"},{"type":"output","id":"DhSmCyRbrE6ny2c9c1_CE","data":[],"key":"plqHpP5t1f"}],"key":"CzGd9UYb3g"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The response is stored as a tar, so we need to decompress it.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mSUVauXDEr"}],"key":"HKGnOLxJoe"}],"key":"ZA0lDefkRJ"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# Fetch folder created in the destination directory\nfld_d = [f for f in Path(\"./results/deforestation/\").iterdir() if f.is_dir()][0]\n\n# Extract the tar file\nwith tarfile.open(fld_d.joinpath(\"response.tar\") , 'r') as tar:\n    tar.extractall(path=fld_d)","key":"PTaixbyb3P"},{"type":"output","id":"gLb1vTyOwq7enjoba9Xv3","data":[],"key":"TX9OQ5xL9F"}],"key":"ssyIrUoe9l"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Plot the automatically detected deforested areas on the RGB image","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fgLEw7chWK"}],"identifier":"plot-the-automatically-detected-deforested-areas-on-the-rgb-image","label":"Plot the automatically detected deforested areas on the RGB image","html_id":"plot-the-automatically-detected-deforested-areas-on-the-rgb-image","implicit":true,"key":"PibQDvc6OI"}],"key":"UBb6dJYRzT"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"For easier plotting we will define a function.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QLFvEi345J"}],"key":"sK6uiLQCqe"}],"key":"h8HVHSkmer"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"def plot_fields_RGB(r, g, b, fields, t=0, gain=2, alpha=0.5, title=None):\n    \n    rgb_stack = np.stack((r[:,:,t], g[:,:,t], b[:,:,t]), axis=2)\n    deforested_plots = np.ma.masked_where(fields[:,:,t] == 0, fields[:,:,t])\n\n\n    # make a color map of fixed colors\n    cmap = colors.ListedColormap(['red'])\n    bounds=[0,1]\n    norm = colors.BoundaryNorm(bounds, cmap.N)\n\n    fig, ax = plt.subplots(nrows=1, ncols=1, figsize=(20,20))\n    ax.imshow(rgb_stack * gain)\n    ax.imshow(deforested_plots, cmap=cmap, norm=norm, interpolation='none', alpha=alpha)\n    \n    # Plot configuration\n    ax.set_xticks([])\n    ax.set_yticks([])\n    \n    patches = [mpatches.Patch(color=\"red\", label=\"Deforested area\", alpha=0.9)]\n    plt.legend(handles=patches, loc=2)\n\n    ax.set_title(title)\n    plt.show()","key":"PCMLzssJ6a"},{"type":"output","id":"n3WGKHL4_nEuFPeLXY09G","data":[],"key":"JW9s478Uoz"}],"key":"NNvtkdFhj2"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Since we are running a per-pixel analysis in the Evalscript, noise may appear in the results. We have defined a function in the cell below that allows us to remove spurious pixels and return a “cleaner” result.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jowh4KcthF"}],"key":"B1omXAD3h1"}],"key":"pqFJiN9tqJ"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# Clean deforestation band\ndef erode_dilate(array, size, dim=0):\n    \n    if dim >= 1:\n        er = morphology.grey_erosion(array, size=(size, size, dim))\n        dil = morphology.grey_dilation(er, size=(size, size, dim))\n    else:\n        er = morphology.grey_erosion(array, size=(size, size))\n        dil = morphology.grey_dilation(er, size=(size, size))\n    \n    \n    return dil","key":"nAvahjBOmC"},{"type":"output","id":"bcUegk28mm4wWF6jZV9a6","data":[],"key":"BK5UyXHWTy"}],"key":"PXCoaBnnwI"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# Fetch the responses from the returned variable and assign them to individual variables\n# The division by 65535 converts the UINT16 DN back to Reflectance\nB02 = response[0]['B02.tif'] / 65535\nB03 = response[0]['B03.tif'] / 65535\nB04 = response[0]['B04.tif'] / 65535\n\n# Clean the deforested array \ndeforest_raster = erode_dilate(response[0][\"deforestation_band.tif\"], 3, dim=1)\n\n# Free the returned variavle from our SentinelHub request\nresponse = None","key":"CWHah9qIBe"},{"type":"output","id":"WfMHLZiQxAxO8G8GtBrTO","data":[],"key":"HcUwl7uIp8"}],"key":"FHEy8Vt1ta"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Finally we can plot the data in the next cell. In the function below, ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dCXJYeWfLy"},{"type":"inlineCode","value":"t","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"g9jgHtYPHw"},{"type":"text","value":" corresponds to the time slice, ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"v7o1oFFk09"},{"type":"inlineCode","value":"gain","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fM5JPMamF1"},{"type":"text","value":" to the multiplication factor of the RGB image for visualisation, and we fetch the time step from the catalog API (the date corresponds to ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RRmyjDRBBI"},{"type":"inlineCode","value":"t","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ajEI40RhZh"},{"type":"text","value":" + 1, since we skip the first timestep in the Evalscript)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"D9cdNCU2la"}],"key":"isdpsQ6UVN"}],"key":"zCNAsU3H82"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# Plot the RGB image for a date with the raster\nplot_fields_RGB(B04, B03, B02, deforest_raster, t = 0, gain=3, title=cloud_free_dates[1])","key":"zCoBMhB0OO"},{"type":"output","id":"9kjGqhZrcjKWeaVemW3cP","data":[{"name":"stderr","output_type":"stream","text":"Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"b704895ea24c1fe0a9fdd68e5996afbd","path":"/example-viewer/build/b704895ea24c1fe0a9fdd68e5996afbd.png"},"text/plain":{"content":"<Figure size 2000x2000 with 1 Axes>","content_type":"text/plain"}}}],"key":"bHqMyJd6IL"}],"key":"rUwSLSJ4Tj"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Convert results to polygons","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oXKJt5X3LC"}],"identifier":"convert-results-to-polygons","label":"Convert results to polygons","html_id":"convert-results-to-polygons","implicit":true,"key":"RSBylittJo"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Now that we have saved the binary ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"h2yer8p8wE"},{"type":"inlineCode","value":"deforestation","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"NCaOs2yrJw"},{"type":"text","value":" raster locally, we can use ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"MTrRij58h4"},{"type":"inlineCode","value":"rasterio","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Y4RUsLJAXU"},{"type":"text","value":" to convert the raster to polygons, in order to update the database that we queried at the start of this notebook.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"oSfBXetbRe"}],"key":"zEWiKslWUE"}],"key":"M6pB9aVAdT"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# Open the deforestation band\ndeforestation_raw = []\ndeforestation_cleaned = []\n\nwith rasterio.open(fld_d.joinpath(\"deforestation_band.tif\")) as dataset:\n    # Loop over bands\n    for bnd in range(dataset.count):\n        dataset_band = dataset.read(bnd+1)\n       \n        # Clean the polygons with an erosion / dilation step\n        clean_defor = erode_dilate(dataset_band, 3)\n        \n        # Calculate polygons from both cleaned and raw rasters\n        raw_shapes = list(rasterio.features.shapes(dataset_band,\n                                                   transform=dataset.transform))\n        clean_shapes = list(rasterio.features.shapes(clean_defor,\n                                                     transform=dataset.transform))\n\n        raw_polygons = [shape(geom) for geom, value in raw_shapes if value == 1]\n        clean_polygons = [shape(geom) for geom, value in clean_shapes if value == 1]\n\n        # Make a multipolygon and conver to GeoSeries\n        deforestation_raw.append(geopandas.GeoSeries(unary_union(raw_polygons)))\n        deforestation_cleaned.append(geopandas.GeoSeries(unary_union(clean_polygons)))","key":"gcO2YZfiAi"},{"type":"output","id":"hypbAQ8Qckj4i3ym81ANe","data":[],"key":"FddTCZuiA8"}],"key":"pFyTu72iwv"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Let’s compare the polyons from the first time step to see how the cleaning step performs.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zxa2A8Fi5B"}],"key":"C4p11606i1"}],"key":"QlB0X7WGet"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"fig, ax = plt.subplots(nrows=1, ncols=1, figsize=(18,12))\n\nraw = deforestation_raw[0].plot(ax=ax, color=\"red\", label=\"Raw deforestation detection band\")\nclean = deforestation_cleaned[0].plot(ax=ax, color=\"black\", label=\"Cleaned deforestation detection band\")\n\n# Plot configuration\nax.set_xlim(-60.20, -60.26)\nax.set_xticks([])\nax.set_yticks([])\nplt.show()","key":"oEzff3B6WH"},{"type":"output","id":"VDS-Qvm6GaxOIf9U5HHT9","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"c3b8848855d7547f18185884a2840410","path":"/example-viewer/build/c3b8848855d7547f18185884a2840410.png"},"text/plain":{"content":"<Figure size 1800x1200 with 1 Axes>","content_type":"text/plain"}}}],"key":"rJccgeoNVx"}],"key":"CZyfAo1pFo"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"In the plot above, the raw deforestation polygons are plotted in red and the cleaned polygons in black. The erosion dilation step removes a lot of individual scattered pixels, but is a little too “agressive” in some of the plots. Nevertheless, most fields are correctly represented and noise is removed.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cvyrJlzLBK"}],"key":"YcuQrqeUPh"}],"key":"SAzYWrgjBc"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"“Looping the loop”: adding the polygons back into a dataframe","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BqMmfQNoSb"}],"identifier":"looping-the-loop-adding-the-polygons-back-into-a-dataframe","label":"“Looping the loop”: adding the polygons back into a dataframe","html_id":"looping-the-loop-adding-the-polygons-back-into-a-dataframe","implicit":true,"key":"Vx0Fim6VcS"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Now we have a set of polygons representing deforestation, we can add them into our existing dataset.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"zcvLqWnnbf"}],"key":"IlzgCmSyrj"}],"key":"Gol2b5f1OC"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# Create a geopandas with our polygons\nrdf = geopandas.GeoDataFrame(pd.concat(deforestation_cleaned, ignore_index=True) )\n\n# Add metadata\nrdf[\"pais\"] = \"Paraguay\"\nrdf[\"prov_dep\"] = \"Boquerón\"\nrdf[\"date\"] = [x.split(\"T\")[0] for x in cloud_free_dates[1:]]\n\n# Rename the geometry column\nrdf.rename(columns={0: 'geometry'}, inplace=True)\n\n# Show the created geopandas\nrdf","key":"vnJXJAcdtl"},{"type":"output","id":"PZPGEZ_ssFbzFV8PZ3C4N","data":[{"output_type":"execute_result","execution_count":72,"metadata":{},"data":{"text/html":{"content":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>geometry</th>\n      <th>pais</th>\n      <th>prov_dep</th>\n      <th>date</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>MULTIPOLYGON (((-60.21011 -21.21229, -60.20973...</td>\n      <td>Paraguay</td>\n      <td>Boquerón</td>\n      <td>2018-02-09</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>MULTIPOLYGON (((-60.25718 -21.21229, -60.25709...</td>\n      <td>Paraguay</td>\n      <td>Boquerón</td>\n      <td>2018-02-14</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>MULTIPOLYGON (((-60.12455 -21.19267, -60.12455...</td>\n      <td>Paraguay</td>\n      <td>Boquerón</td>\n      <td>2018-02-24</td>\n    </tr>\n  </tbody>\n</table>\n</div>","content_type":"text/html"},"text/plain":{"content":"                                            geometry      pais  prov_dep  \\\n0  MULTIPOLYGON (((-60.21011 -21.21229, -60.20973...  Paraguay  Boquerón   \n1  MULTIPOLYGON (((-60.25718 -21.21229, -60.25709...  Paraguay  Boquerón   \n2  MULTIPOLYGON (((-60.12455 -21.19267, -60.12455...  Paraguay  Boquerón   \n\n         date  \n0  2018-02-09  \n1  2018-02-14  \n2  2018-02-24  ","content_type":"text/plain"}}}],"key":"vLBZ7OhrdH"}],"key":"TvlUQlRU7J"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now we have a correctly formatted ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"l3dAZORYRO"},{"type":"inlineCode","value":"geopandas","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uxwVO9wcVP"},{"type":"text","value":" Dataframe, we can append it to the database that we queried at the start of this tutorial.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MfRRmG5nLt"}],"key":"iiXRmaKQ7r"}],"key":"iPp1204upD"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"gran_chaco_updated = gran_chaco.append(rdf)","key":"prjiEHlFXV"},{"type":"output","id":"TwC-NHa4HJa_apIilECVf","data":[],"key":"r6M4FTGriu"}],"key":"Qo5IorXcO3"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# Let's look at the updated dataframe\ngran_chaco_updated","key":"hsJjGpGPyN"},{"type":"output","id":"_DNeLFiiTBjawtQ7biJnn","data":[{"output_type":"execute_result","execution_count":74,"metadata":{},"data":{"text/html":{"content":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>id</th>\n      <th>created_at</th>\n      <th>modified_at</th>\n      <th>geometry</th>\n      <th>objectid</th>\n      <th>field_id</th>\n      <th>pais</th>\n      <th>prov_dep</th>\n      <th>municipios</th>\n      <th>date</th>\n      <th>shape_leng</th>\n      <th>shape_area</th>\n      <th>datetime</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>9333.0</td>\n      <td>2020-09-25T07:57:39.568135+00:00</td>\n      <td>None</td>\n      <td>POLYGON ((-60.26329 -21.27054, -60.26325 -21.2...</td>\n      <td>7784.0</td>\n      <td>9333.0</td>\n      <td>Paraguay</td>\n      <td>Boquerón</td>\n      <td>FILADELFIA</td>\n      <td>2011-12-31</td>\n      <td>3203.541559</td>\n      <td>5.661000e+05</td>\n      <td>2011-12-31</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>9347.0</td>\n      <td>2020-09-25T07:57:39.568135+00:00</td>\n      <td>None</td>\n      <td>POLYGON ((-60.26322 -21.23245, -60.26334 -21.2...</td>\n      <td>7798.0</td>\n      <td>9347.0</td>\n      <td>Paraguay</td>\n      <td>Boquerón</td>\n      <td>FILADELFIA</td>\n      <td>2011-12-31</td>\n      <td>23061.565888</td>\n      <td>4.140725e+06</td>\n      <td>2011-12-31</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>40758.0</td>\n      <td>2020-09-25T07:57:44.48827+00:00</td>\n      <td>None</td>\n      <td>POLYGON ((-60.26381 -21.25916, -60.26376 -21.2...</td>\n      <td>32303.0</td>\n      <td>40758.0</td>\n      <td>Paraguay</td>\n      <td>Boquerón</td>\n      <td>FILADELFIA</td>\n      <td>2014-10-31</td>\n      <td>247.465000</td>\n      <td>1.491147e+03</td>\n      <td>2014-10-31</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>40763.0</td>\n      <td>2020-09-25T07:57:44.48827+00:00</td>\n      <td>None</td>\n      <td>POLYGON ((-60.26370 -21.25423, -60.26392 -21.2...</td>\n      <td>32308.0</td>\n      <td>40763.0</td>\n      <td>Paraguay</td>\n      <td>Boquerón</td>\n      <td>FILADELFIA</td>\n      <td>2014-10-31</td>\n      <td>156.980834</td>\n      <td>8.272126e+02</td>\n      <td>2014-10-31</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>40768.0</td>\n      <td>2020-09-25T07:57:44.48827+00:00</td>\n      <td>None</td>\n      <td>POLYGON ((-60.26354 -21.24383, -60.26380 -21.2...</td>\n      <td>32313.0</td>\n      <td>40768.0</td>\n      <td>Paraguay</td>\n      <td>Boquerón</td>\n      <td>FILADELFIA</td>\n      <td>2014-10-31</td>\n      <td>244.941473</td>\n      <td>2.648666e+03</td>\n      <td>2014-10-31</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>40770.0</td>\n      <td>2020-09-25T07:57:44.48827+00:00</td>\n      <td>None</td>\n      <td>POLYGON ((-60.26355 -21.23751, -60.26350 -21.2...</td>\n      <td>32315.0</td>\n      <td>40770.0</td>\n      <td>Paraguay</td>\n      <td>Boquerón</td>\n      <td>FILADELFIA</td>\n      <td>2014-10-31</td>\n      <td>258.094701</td>\n      <td>2.089448e+03</td>\n      <td>2014-10-31</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>58546.0</td>\n      <td>2020-09-25T07:57:45.943354+00:00</td>\n      <td>None</td>\n      <td>POLYGON ((-60.19709 -21.20089, -60.19801 -21.2...</td>\n      <td>42365.0</td>\n      <td>58546.0</td>\n      <td>Paraguay</td>\n      <td>Boquerón</td>\n      <td>FILADELFIA</td>\n      <td>2015-10-31</td>\n      <td>35369.274281</td>\n      <td>5.651093e+06</td>\n      <td>2015-10-31</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>58548.0</td>\n      <td>2020-09-25T07:57:45.943354+00:00</td>\n      <td>None</td>\n      <td>POLYGON ((-60.17358 -21.19005, -60.17543 -21.1...</td>\n      <td>42365.0</td>\n      <td>58548.0</td>\n      <td>Paraguay</td>\n      <td>Boquerón</td>\n      <td>FILADELFIA</td>\n      <td>2015-10-31</td>\n      <td>35369.274281</td>\n      <td>5.651093e+06</td>\n      <td>2015-10-31</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>66517.0</td>\n      <td>2020-09-25T07:57:47.16828+00:00</td>\n      <td>None</td>\n      <td>POLYGON ((-60.23363 -21.25623, -60.24235 -21.2...</td>\n      <td>42700.0</td>\n      <td>66517.0</td>\n      <td>Paraguay</td>\n      <td>Boquerón</td>\n      <td>FILADELFIA</td>\n      <td>2016-06-30</td>\n      <td>63232.505444</td>\n      <td>1.189560e+07</td>\n      <td>2016-06-30</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>66518.0</td>\n      <td>2020-09-25T07:57:47.16828+00:00</td>\n      <td>None</td>\n      <td>POLYGON ((-60.23382 -21.26173, -60.25247 -21.2...</td>\n      <td>42700.0</td>\n      <td>66518.0</td>\n      <td>Paraguay</td>\n      <td>Boquerón</td>\n      <td>FILADELFIA</td>\n      <td>2016-06-30</td>\n      <td>63232.505444</td>\n      <td>1.189560e+07</td>\n      <td>2016-06-30</td>\n    </tr>\n    <tr>\n      <th>10</th>\n      <td>68177.0</td>\n      <td>2020-09-25T07:57:47.16828+00:00</td>\n      <td>None</td>\n      <td>POLYGON ((-60.23342 -21.26788, -60.23342 -21.2...</td>\n      <td>42806.0</td>\n      <td>68177.0</td>\n      <td>Paraguay</td>\n      <td>Boquerón</td>\n      <td>FILADELFIA</td>\n      <td>2016-08-31</td>\n      <td>54236.171652</td>\n      <td>1.099213e+07</td>\n      <td>2016-08-31</td>\n    </tr>\n    <tr>\n      <th>11</th>\n      <td>68188.0</td>\n      <td>2020-09-25T07:57:47.16828+00:00</td>\n      <td>None</td>\n      <td>POLYGON ((-60.23990 -21.26734, -60.25252 -21.2...</td>\n      <td>42806.0</td>\n      <td>68188.0</td>\n      <td>Paraguay</td>\n      <td>Boquerón</td>\n      <td>FILADELFIA</td>\n      <td>2016-08-31</td>\n      <td>54236.171652</td>\n      <td>1.099213e+07</td>\n      <td>2016-08-31</td>\n    </tr>\n    <tr>\n      <th>12</th>\n      <td>68189.0</td>\n      <td>2020-09-25T07:57:47.16828+00:00</td>\n      <td>None</td>\n      <td>POLYGON ((-60.22272 -21.27312, -60.23180 -21.2...</td>\n      <td>42806.0</td>\n      <td>68189.0</td>\n      <td>Paraguay</td>\n      <td>Boquerón</td>\n      <td>FILADELFIA</td>\n      <td>2016-08-31</td>\n      <td>54236.171652</td>\n      <td>1.099213e+07</td>\n      <td>2016-08-31</td>\n    </tr>\n    <tr>\n      <th>13</th>\n      <td>69469.0</td>\n      <td>2020-09-25T07:57:47.16828+00:00</td>\n      <td>None</td>\n      <td>POLYGON ((-60.23374 -21.26714, -60.23990 -21.2...</td>\n      <td>42911.0</td>\n      <td>69469.0</td>\n      <td>Paraguay</td>\n      <td>Boquerón</td>\n      <td>FILADELFIA</td>\n      <td>2016-09-30</td>\n      <td>46417.194449</td>\n      <td>7.108902e+06</td>\n      <td>2016-09-30</td>\n    </tr>\n    <tr>\n      <th>14</th>\n      <td>69474.0</td>\n      <td>2020-09-25T07:57:47.16828+00:00</td>\n      <td>None</td>\n      <td>POLYGON ((-60.23157 -21.26809, -60.23164 -21.2...</td>\n      <td>42911.0</td>\n      <td>69474.0</td>\n      <td>Paraguay</td>\n      <td>Boquerón</td>\n      <td>FILADELFIA</td>\n      <td>2016-09-30</td>\n      <td>46417.194449</td>\n      <td>7.108902e+06</td>\n      <td>2016-09-30</td>\n    </tr>\n    <tr>\n      <th>15</th>\n      <td>70590.0</td>\n      <td>2020-09-25T07:57:48.497587+00:00</td>\n      <td>None</td>\n      <td>POLYGON ((-60.23386 -21.25709, -60.23372 -21.2...</td>\n      <td>42965.0</td>\n      <td>70590.0</td>\n      <td>Paraguay</td>\n      <td>Boquerón</td>\n      <td>FILADELFIA</td>\n      <td>2016-11-30</td>\n      <td>96005.066733</td>\n      <td>1.744413e+07</td>\n      <td>2016-11-30</td>\n    </tr>\n    <tr>\n      <th>16</th>\n      <td>70591.0</td>\n      <td>2020-09-25T07:57:48.497587+00:00</td>\n      <td>None</td>\n      <td>POLYGON ((-60.24358 -21.25610, -60.25239 -21.2...</td>\n      <td>42965.0</td>\n      <td>70591.0</td>\n      <td>Paraguay</td>\n      <td>Boquerón</td>\n      <td>FILADELFIA</td>\n      <td>2016-11-30</td>\n      <td>96005.066733</td>\n      <td>1.744413e+07</td>\n      <td>2016-11-30</td>\n    </tr>\n    <tr>\n      <th>17</th>\n      <td>75456.0</td>\n      <td>2020-09-25T07:57:48.497587+00:00</td>\n      <td>None</td>\n      <td>POLYGON ((-60.21706 -21.27261, -60.22272 -21.2...</td>\n      <td>43184.0</td>\n      <td>75456.0</td>\n      <td>Paraguay</td>\n      <td>Boquerón</td>\n      <td>FILADELFIA</td>\n      <td>2017-03-31</td>\n      <td>284316.143820</td>\n      <td>4.828256e+07</td>\n      <td>2017-03-31</td>\n    </tr>\n    <tr>\n      <th>18</th>\n      <td>86719.0</td>\n      <td>2020-09-25T07:57:49.678146+00:00</td>\n      <td>None</td>\n      <td>POLYGON ((-60.17380 -21.19416, -60.16402 -21.1...</td>\n      <td>43679.0</td>\n      <td>86719.0</td>\n      <td>Paraguay</td>\n      <td>Boquerón</td>\n      <td>FILADELFIA</td>\n      <td>2017-12-31</td>\n      <td>174512.220879</td>\n      <td>3.070367e+07</td>\n      <td>2017-12-31</td>\n    </tr>\n    <tr>\n      <th>19</th>\n      <td>86727.0</td>\n      <td>2020-09-25T07:57:49.678146+00:00</td>\n      <td>None</td>\n      <td>POLYGON ((-60.17478 -21.20611, -60.17436 -21.2...</td>\n      <td>43679.0</td>\n      <td>86727.0</td>\n      <td>Paraguay</td>\n      <td>Boquerón</td>\n      <td>FILADELFIA</td>\n      <td>2017-12-31</td>\n      <td>174512.220879</td>\n      <td>3.070367e+07</td>\n      <td>2017-12-31</td>\n    </tr>\n    <tr>\n      <th>20</th>\n      <td>86731.0</td>\n      <td>2020-09-25T07:57:49.678146+00:00</td>\n      <td>None</td>\n      <td>POLYGON ((-60.18514 -21.19408, -60.18514 -21.1...</td>\n      <td>43679.0</td>\n      <td>86731.0</td>\n      <td>Paraguay</td>\n      <td>Boquerón</td>\n      <td>FILADELFIA</td>\n      <td>2017-12-31</td>\n      <td>174512.220879</td>\n      <td>3.070367e+07</td>\n      <td>2017-12-31</td>\n    </tr>\n    <tr>\n      <th>21</th>\n      <td>86738.0</td>\n      <td>2020-09-25T07:57:49.678146+00:00</td>\n      <td>None</td>\n      <td>POLYGON ((-60.16414 -21.20403, -60.16396 -21.2...</td>\n      <td>43679.0</td>\n      <td>86738.0</td>\n      <td>Paraguay</td>\n      <td>Boquerón</td>\n      <td>FILADELFIA</td>\n      <td>2017-12-31</td>\n      <td>174512.220879</td>\n      <td>3.070367e+07</td>\n      <td>2017-12-31</td>\n    </tr>\n    <tr>\n      <th>22</th>\n      <td>86742.0</td>\n      <td>2020-09-25T07:57:49.678146+00:00</td>\n      <td>None</td>\n      <td>POLYGON ((-60.17995 -21.19400, -60.17474 -21.1...</td>\n      <td>43679.0</td>\n      <td>86742.0</td>\n      <td>Paraguay</td>\n      <td>Boquerón</td>\n      <td>FILADELFIA</td>\n      <td>2017-12-31</td>\n      <td>174512.220879</td>\n      <td>3.070367e+07</td>\n      <td>2017-12-31</td>\n    </tr>\n    <tr>\n      <th>23</th>\n      <td>86747.0</td>\n      <td>2020-09-25T07:57:49.678146+00:00</td>\n      <td>None</td>\n      <td>POLYGON ((-60.19185 -21.20799, -60.19147 -21.2...</td>\n      <td>43679.0</td>\n      <td>86747.0</td>\n      <td>Paraguay</td>\n      <td>Boquerón</td>\n      <td>FILADELFIA</td>\n      <td>2017-12-31</td>\n      <td>174512.220879</td>\n      <td>3.070367e+07</td>\n      <td>2017-12-31</td>\n    </tr>\n    <tr>\n      <th>24</th>\n      <td>86749.0</td>\n      <td>2020-09-25T07:57:49.678146+00:00</td>\n      <td>None</td>\n      <td>POLYGON ((-60.19158 -21.20394, -60.19156 -21.2...</td>\n      <td>43679.0</td>\n      <td>86749.0</td>\n      <td>Paraguay</td>\n      <td>Boquerón</td>\n      <td>FILADELFIA</td>\n      <td>2017-12-31</td>\n      <td>174512.220879</td>\n      <td>3.070367e+07</td>\n      <td>2017-12-31</td>\n    </tr>\n    <tr>\n      <th>25</th>\n      <td>88002.0</td>\n      <td>2020-09-25T07:57:49.678146+00:00</td>\n      <td>None</td>\n      <td>POLYGON ((-60.19158 -21.20394, -60.18492 -21.2...</td>\n      <td>43800.0</td>\n      <td>88002.0</td>\n      <td>Paraguay</td>\n      <td>Boquerón</td>\n      <td>FILADELFIA</td>\n      <td>2018-01-31</td>\n      <td>74575.618180</td>\n      <td>1.049673e+07</td>\n      <td>2018-01-31</td>\n    </tr>\n    <tr>\n      <th>26</th>\n      <td>88006.0</td>\n      <td>2020-09-25T07:57:49.678146+00:00</td>\n      <td>None</td>\n      <td>POLYGON ((-60.18432 -21.19408, -60.17995 -21.1...</td>\n      <td>43800.0</td>\n      <td>88006.0</td>\n      <td>Paraguay</td>\n      <td>Boquerón</td>\n      <td>FILADELFIA</td>\n      <td>2018-01-31</td>\n      <td>74575.618180</td>\n      <td>1.049673e+07</td>\n      <td>2018-01-31</td>\n    </tr>\n    <tr>\n      <th>27</th>\n      <td>88018.0</td>\n      <td>2020-09-25T07:57:49.678146+00:00</td>\n      <td>None</td>\n      <td>POLYGON ((-60.17365 -21.20509, -60.17372 -21.2...</td>\n      <td>43800.0</td>\n      <td>88018.0</td>\n      <td>Paraguay</td>\n      <td>Boquerón</td>\n      <td>FILADELFIA</td>\n      <td>2018-01-31</td>\n      <td>74575.618180</td>\n      <td>1.049673e+07</td>\n      <td>2018-01-31</td>\n    </tr>\n    <tr>\n      <th>28</th>\n      <td>88019.0</td>\n      <td>2020-09-25T07:57:49.678146+00:00</td>\n      <td>None</td>\n      <td>POLYGON ((-60.16963 -21.21093, -60.16956 -21.2...</td>\n      <td>43800.0</td>\n      <td>88019.0</td>\n      <td>Paraguay</td>\n      <td>Boquerón</td>\n      <td>FILADELFIA</td>\n      <td>2018-01-31</td>\n      <td>74575.618180</td>\n      <td>1.049673e+07</td>\n      <td>2018-01-31</td>\n    </tr>\n    <tr>\n      <th>29</th>\n      <td>88022.0</td>\n      <td>2020-09-25T07:57:49.678146+00:00</td>\n      <td>None</td>\n      <td>POLYGON ((-60.19696 -21.20406, -60.19563 -21.2...</td>\n      <td>43800.0</td>\n      <td>88022.0</td>\n      <td>Paraguay</td>\n      <td>Boquerón</td>\n      <td>FILADELFIA</td>\n      <td>2018-01-31</td>\n      <td>74575.618180</td>\n      <td>1.049673e+07</td>\n      <td>2018-01-31</td>\n    </tr>\n    <tr>\n      <th>30</th>\n      <td>88024.0</td>\n      <td>2020-09-25T07:57:49.678146+00:00</td>\n      <td>None</td>\n      <td>POLYGON ((-60.18506 -21.20018, -60.18504 -21.2...</td>\n      <td>43800.0</td>\n      <td>88024.0</td>\n      <td>Paraguay</td>\n      <td>Boquerón</td>\n      <td>FILADELFIA</td>\n      <td>2018-01-31</td>\n      <td>74575.618180</td>\n      <td>1.049673e+07</td>\n      <td>2018-01-31</td>\n    </tr>\n    <tr>\n      <th>31</th>\n      <td>88025.0</td>\n      <td>2020-09-25T07:57:49.678146+00:00</td>\n      <td>None</td>\n      <td>POLYGON ((-60.19580 -21.21018, -60.19576 -21.2...</td>\n      <td>43800.0</td>\n      <td>88025.0</td>\n      <td>Paraguay</td>\n      <td>Boquerón</td>\n      <td>FILADELFIA</td>\n      <td>2018-01-31</td>\n      <td>74575.618180</td>\n      <td>1.049673e+07</td>\n      <td>2018-01-31</td>\n    </tr>\n    <tr>\n      <th>32</th>\n      <td>88028.0</td>\n      <td>2020-09-25T07:57:49.678146+00:00</td>\n      <td>None</td>\n      <td>POLYGON ((-60.17258 -21.19252, -60.17215 -21.1...</td>\n      <td>43800.0</td>\n      <td>88028.0</td>\n      <td>Paraguay</td>\n      <td>Boquerón</td>\n      <td>FILADELFIA</td>\n      <td>2018-01-31</td>\n      <td>74575.618180</td>\n      <td>1.049673e+07</td>\n      <td>2018-01-31</td>\n    </tr>\n    <tr>\n      <th>33</th>\n      <td>88029.0</td>\n      <td>2020-09-25T07:57:49.678146+00:00</td>\n      <td>None</td>\n      <td>POLYGON ((-60.16966 -21.19277, -60.16953 -21.1...</td>\n      <td>43800.0</td>\n      <td>88029.0</td>\n      <td>Paraguay</td>\n      <td>Boquerón</td>\n      <td>FILADELFIA</td>\n      <td>2018-01-31</td>\n      <td>74575.618180</td>\n      <td>1.049673e+07</td>\n      <td>2018-01-31</td>\n    </tr>\n    <tr>\n      <th>34</th>\n      <td>88030.0</td>\n      <td>2020-09-25T07:57:49.678146+00:00</td>\n      <td>None</td>\n      <td>POLYGON ((-60.19818 -21.20492, -60.19834 -21.2...</td>\n      <td>43800.0</td>\n      <td>88030.0</td>\n      <td>Paraguay</td>\n      <td>Boquerón</td>\n      <td>FILADELFIA</td>\n      <td>2018-01-31</td>\n      <td>74575.618180</td>\n      <td>1.049673e+07</td>\n      <td>2018-01-31</td>\n    </tr>\n    <tr>\n      <th>35</th>\n      <td>88032.0</td>\n      <td>2020-09-25T07:57:49.678146+00:00</td>\n      <td>None</td>\n      <td>POLYGON ((-60.17366 -21.20509, -60.17365 -21.2...</td>\n      <td>43800.0</td>\n      <td>88032.0</td>\n      <td>Paraguay</td>\n      <td>Boquerón</td>\n      <td>FILADELFIA</td>\n      <td>2018-01-31</td>\n      <td>74575.618180</td>\n      <td>1.049673e+07</td>\n      <td>2018-01-31</td>\n    </tr>\n    <tr>\n      <th>0</th>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>MULTIPOLYGON (((-60.21011 -21.21229, -60.20973...</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>Paraguay</td>\n      <td>Boquerón</td>\n      <td>NaN</td>\n      <td>2018-02-09</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaT</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>MULTIPOLYGON (((-60.25718 -21.21229, -60.25709...</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>Paraguay</td>\n      <td>Boquerón</td>\n      <td>NaN</td>\n      <td>2018-02-14</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaT</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>MULTIPOLYGON (((-60.12455 -21.19267, -60.12455...</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>Paraguay</td>\n      <td>Boquerón</td>\n      <td>NaN</td>\n      <td>2018-02-24</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaT</td>\n    </tr>\n  </tbody>\n</table>\n</div>","content_type":"text/html"},"text/plain":{"content":"         id                        created_at modified_at  \\\n0    9333.0  2020-09-25T07:57:39.568135+00:00        None   \n1    9347.0  2020-09-25T07:57:39.568135+00:00        None   \n2   40758.0   2020-09-25T07:57:44.48827+00:00        None   \n3   40763.0   2020-09-25T07:57:44.48827+00:00        None   \n4   40768.0   2020-09-25T07:57:44.48827+00:00        None   \n5   40770.0   2020-09-25T07:57:44.48827+00:00        None   \n6   58546.0  2020-09-25T07:57:45.943354+00:00        None   \n7   58548.0  2020-09-25T07:57:45.943354+00:00        None   \n8   66517.0   2020-09-25T07:57:47.16828+00:00        None   \n9   66518.0   2020-09-25T07:57:47.16828+00:00        None   \n10  68177.0   2020-09-25T07:57:47.16828+00:00        None   \n11  68188.0   2020-09-25T07:57:47.16828+00:00        None   \n12  68189.0   2020-09-25T07:57:47.16828+00:00        None   \n13  69469.0   2020-09-25T07:57:47.16828+00:00        None   \n14  69474.0   2020-09-25T07:57:47.16828+00:00        None   \n15  70590.0  2020-09-25T07:57:48.497587+00:00        None   \n16  70591.0  2020-09-25T07:57:48.497587+00:00        None   \n17  75456.0  2020-09-25T07:57:48.497587+00:00        None   \n18  86719.0  2020-09-25T07:57:49.678146+00:00        None   \n19  86727.0  2020-09-25T07:57:49.678146+00:00        None   \n20  86731.0  2020-09-25T07:57:49.678146+00:00        None   \n21  86738.0  2020-09-25T07:57:49.678146+00:00        None   \n22  86742.0  2020-09-25T07:57:49.678146+00:00        None   \n23  86747.0  2020-09-25T07:57:49.678146+00:00        None   \n24  86749.0  2020-09-25T07:57:49.678146+00:00        None   \n25  88002.0  2020-09-25T07:57:49.678146+00:00        None   \n26  88006.0  2020-09-25T07:57:49.678146+00:00        None   \n27  88018.0  2020-09-25T07:57:49.678146+00:00        None   \n28  88019.0  2020-09-25T07:57:49.678146+00:00        None   \n29  88022.0  2020-09-25T07:57:49.678146+00:00        None   \n30  88024.0  2020-09-25T07:57:49.678146+00:00        None   \n31  88025.0  2020-09-25T07:57:49.678146+00:00        None   \n32  88028.0  2020-09-25T07:57:49.678146+00:00        None   \n33  88029.0  2020-09-25T07:57:49.678146+00:00        None   \n34  88030.0  2020-09-25T07:57:49.678146+00:00        None   \n35  88032.0  2020-09-25T07:57:49.678146+00:00        None   \n0       NaN                               NaN         NaN   \n1       NaN                               NaN         NaN   \n2       NaN                               NaN         NaN   \n\n                                             geometry  objectid  field_id  \\\n0   POLYGON ((-60.26329 -21.27054, -60.26325 -21.2...    7784.0    9333.0   \n1   POLYGON ((-60.26322 -21.23245, -60.26334 -21.2...    7798.0    9347.0   \n2   POLYGON ((-60.26381 -21.25916, -60.26376 -21.2...   32303.0   40758.0   \n3   POLYGON ((-60.26370 -21.25423, -60.26392 -21.2...   32308.0   40763.0   \n4   POLYGON ((-60.26354 -21.24383, -60.26380 -21.2...   32313.0   40768.0   \n5   POLYGON ((-60.26355 -21.23751, -60.26350 -21.2...   32315.0   40770.0   \n6   POLYGON ((-60.19709 -21.20089, -60.19801 -21.2...   42365.0   58546.0   \n7   POLYGON ((-60.17358 -21.19005, -60.17543 -21.1...   42365.0   58548.0   \n8   POLYGON ((-60.23363 -21.25623, -60.24235 -21.2...   42700.0   66517.0   \n9   POLYGON ((-60.23382 -21.26173, -60.25247 -21.2...   42700.0   66518.0   \n10  POLYGON ((-60.23342 -21.26788, -60.23342 -21.2...   42806.0   68177.0   \n11  POLYGON ((-60.23990 -21.26734, -60.25252 -21.2...   42806.0   68188.0   \n12  POLYGON ((-60.22272 -21.27312, -60.23180 -21.2...   42806.0   68189.0   \n13  POLYGON ((-60.23374 -21.26714, -60.23990 -21.2...   42911.0   69469.0   \n14  POLYGON ((-60.23157 -21.26809, -60.23164 -21.2...   42911.0   69474.0   \n15  POLYGON ((-60.23386 -21.25709, -60.23372 -21.2...   42965.0   70590.0   \n16  POLYGON ((-60.24358 -21.25610, -60.25239 -21.2...   42965.0   70591.0   \n17  POLYGON ((-60.21706 -21.27261, -60.22272 -21.2...   43184.0   75456.0   \n18  POLYGON ((-60.17380 -21.19416, -60.16402 -21.1...   43679.0   86719.0   \n19  POLYGON ((-60.17478 -21.20611, -60.17436 -21.2...   43679.0   86727.0   \n20  POLYGON ((-60.18514 -21.19408, -60.18514 -21.1...   43679.0   86731.0   \n21  POLYGON ((-60.16414 -21.20403, -60.16396 -21.2...   43679.0   86738.0   \n22  POLYGON ((-60.17995 -21.19400, -60.17474 -21.1...   43679.0   86742.0   \n23  POLYGON ((-60.19185 -21.20799, -60.19147 -21.2...   43679.0   86747.0   \n24  POLYGON ((-60.19158 -21.20394, -60.19156 -21.2...   43679.0   86749.0   \n25  POLYGON ((-60.19158 -21.20394, -60.18492 -21.2...   43800.0   88002.0   \n26  POLYGON ((-60.18432 -21.19408, -60.17995 -21.1...   43800.0   88006.0   \n27  POLYGON ((-60.17365 -21.20509, -60.17372 -21.2...   43800.0   88018.0   \n28  POLYGON ((-60.16963 -21.21093, -60.16956 -21.2...   43800.0   88019.0   \n29  POLYGON ((-60.19696 -21.20406, -60.19563 -21.2...   43800.0   88022.0   \n30  POLYGON ((-60.18506 -21.20018, -60.18504 -21.2...   43800.0   88024.0   \n31  POLYGON ((-60.19580 -21.21018, -60.19576 -21.2...   43800.0   88025.0   \n32  POLYGON ((-60.17258 -21.19252, -60.17215 -21.1...   43800.0   88028.0   \n33  POLYGON ((-60.16966 -21.19277, -60.16953 -21.1...   43800.0   88029.0   \n34  POLYGON ((-60.19818 -21.20492, -60.19834 -21.2...   43800.0   88030.0   \n35  POLYGON ((-60.17366 -21.20509, -60.17365 -21.2...   43800.0   88032.0   \n0   MULTIPOLYGON (((-60.21011 -21.21229, -60.20973...       NaN       NaN   \n1   MULTIPOLYGON (((-60.25718 -21.21229, -60.25709...       NaN       NaN   \n2   MULTIPOLYGON (((-60.12455 -21.19267, -60.12455...       NaN       NaN   \n\n        pais  prov_dep  municipios        date     shape_leng    shape_area  \\\n0   Paraguay  Boquerón  FILADELFIA  2011-12-31    3203.541559  5.661000e+05   \n1   Paraguay  Boquerón  FILADELFIA  2011-12-31   23061.565888  4.140725e+06   \n2   Paraguay  Boquerón  FILADELFIA  2014-10-31     247.465000  1.491147e+03   \n3   Paraguay  Boquerón  FILADELFIA  2014-10-31     156.980834  8.272126e+02   \n4   Paraguay  Boquerón  FILADELFIA  2014-10-31     244.941473  2.648666e+03   \n5   Paraguay  Boquerón  FILADELFIA  2014-10-31     258.094701  2.089448e+03   \n6   Paraguay  Boquerón  FILADELFIA  2015-10-31   35369.274281  5.651093e+06   \n7   Paraguay  Boquerón  FILADELFIA  2015-10-31   35369.274281  5.651093e+06   \n8   Paraguay  Boquerón  FILADELFIA  2016-06-30   63232.505444  1.189560e+07   \n9   Paraguay  Boquerón  FILADELFIA  2016-06-30   63232.505444  1.189560e+07   \n10  Paraguay  Boquerón  FILADELFIA  2016-08-31   54236.171652  1.099213e+07   \n11  Paraguay  Boquerón  FILADELFIA  2016-08-31   54236.171652  1.099213e+07   \n12  Paraguay  Boquerón  FILADELFIA  2016-08-31   54236.171652  1.099213e+07   \n13  Paraguay  Boquerón  FILADELFIA  2016-09-30   46417.194449  7.108902e+06   \n14  Paraguay  Boquerón  FILADELFIA  2016-09-30   46417.194449  7.108902e+06   \n15  Paraguay  Boquerón  FILADELFIA  2016-11-30   96005.066733  1.744413e+07   \n16  Paraguay  Boquerón  FILADELFIA  2016-11-30   96005.066733  1.744413e+07   \n17  Paraguay  Boquerón  FILADELFIA  2017-03-31  284316.143820  4.828256e+07   \n18  Paraguay  Boquerón  FILADELFIA  2017-12-31  174512.220879  3.070367e+07   \n19  Paraguay  Boquerón  FILADELFIA  2017-12-31  174512.220879  3.070367e+07   \n20  Paraguay  Boquerón  FILADELFIA  2017-12-31  174512.220879  3.070367e+07   \n21  Paraguay  Boquerón  FILADELFIA  2017-12-31  174512.220879  3.070367e+07   \n22  Paraguay  Boquerón  FILADELFIA  2017-12-31  174512.220879  3.070367e+07   \n23  Paraguay  Boquerón  FILADELFIA  2017-12-31  174512.220879  3.070367e+07   \n24  Paraguay  Boquerón  FILADELFIA  2017-12-31  174512.220879  3.070367e+07   \n25  Paraguay  Boquerón  FILADELFIA  2018-01-31   74575.618180  1.049673e+07   \n26  Paraguay  Boquerón  FILADELFIA  2018-01-31   74575.618180  1.049673e+07   \n27  Paraguay  Boquerón  FILADELFIA  2018-01-31   74575.618180  1.049673e+07   \n28  Paraguay  Boquerón  FILADELFIA  2018-01-31   74575.618180  1.049673e+07   \n29  Paraguay  Boquerón  FILADELFIA  2018-01-31   74575.618180  1.049673e+07   \n30  Paraguay  Boquerón  FILADELFIA  2018-01-31   74575.618180  1.049673e+07   \n31  Paraguay  Boquerón  FILADELFIA  2018-01-31   74575.618180  1.049673e+07   \n32  Paraguay  Boquerón  FILADELFIA  2018-01-31   74575.618180  1.049673e+07   \n33  Paraguay  Boquerón  FILADELFIA  2018-01-31   74575.618180  1.049673e+07   \n34  Paraguay  Boquerón  FILADELFIA  2018-01-31   74575.618180  1.049673e+07   \n35  Paraguay  Boquerón  FILADELFIA  2018-01-31   74575.618180  1.049673e+07   \n0   Paraguay  Boquerón         NaN  2018-02-09            NaN           NaN   \n1   Paraguay  Boquerón         NaN  2018-02-14            NaN           NaN   \n2   Paraguay  Boquerón         NaN  2018-02-24            NaN           NaN   \n\n     datetime  \n0  2011-12-31  \n1  2011-12-31  \n2  2014-10-31  \n3  2014-10-31  \n4  2014-10-31  \n5  2014-10-31  \n6  2015-10-31  \n7  2015-10-31  \n8  2016-06-30  \n9  2016-06-30  \n10 2016-08-31  \n11 2016-08-31  \n12 2016-08-31  \n13 2016-09-30  \n14 2016-09-30  \n15 2016-11-30  \n16 2016-11-30  \n17 2017-03-31  \n18 2017-12-31  \n19 2017-12-31  \n20 2017-12-31  \n21 2017-12-31  \n22 2017-12-31  \n23 2017-12-31  \n24 2017-12-31  \n25 2018-01-31  \n26 2018-01-31  \n27 2018-01-31  \n28 2018-01-31  \n29 2018-01-31  \n30 2018-01-31  \n31 2018-01-31  \n32 2018-01-31  \n33 2018-01-31  \n34 2018-01-31  \n35 2018-01-31  \n0         NaT  \n1         NaT  \n2         NaT  ","content_type":"text/plain"}}}],"key":"HheGfNji41"}],"key":"eMoKxbtgm3"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"In this example we only filled out basic information, in the previous steps, you can calculate more of the parameters listed in the table. For now, let’s compare the polygons in the original dataset, with those in the updated dataset.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oag45SsIkO"}],"key":"sNRZjpHq0q"}],"key":"SFrHZGoyC9"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"fig, (ax, ax2) = plt.subplots(nrows=1, ncols=2, figsize=(18,12))\n\n# Plot  datasets\ngran_chaco.plot(ax=ax)\ngran_chaco_updated.plot(ax=ax2)\n\nplt.show()","key":"BK5BdzNzQN"},{"type":"output","id":"qCmVmgbDcJDm0oogtEtoS","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"bf8383c592374cadea215ca9c670d210","path":"/example-viewer/build/bf8383c592374cadea215ca9c670d210.png"},"text/plain":{"content":"<Figure size 1800x1200 with 2 Axes>","content_type":"text/plain"}}}],"key":"BApM3S37FW"}],"key":"GzA9WHOaB5"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We can see that we have detected more deforestation events in February and March 2018, a promising result. To share the dataset using geoDB, please refer to the free tutorial Jupyter Notebooks in the Marketplace.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uStpLrmIXh"}],"key":"T0P53RX7u5"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"As mentioned earlier, this basic approach is empirical and may not be robust for different areas/time of year. The goal was to get you started in creating your own scripts, and we hope to see new exciting algorithms in EDC...","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ISjx8g04Rj"}],"key":"QBDcnFYVOj"}],"key":"zMGdaSWRC0"}],"key":"RiPfJpJGVP"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"GPU-Support on EOxHub","url":"/external-notebooks/eurodatacube/notebooks/notebooks/contributions/gpu-support-eoxhub","group":"Contributions"},"next":{"title":"How To: Land-Use-Land-Cover Prediction for Slovenia - using the Batch Processing API","url":"/external-notebooks/eurodatacube/notebooks/notebooks/contributions/howtolulc-batch-updated-210621","group":"Contributions"}}},"domain":"http://localhost:3000"}