{"version":1,"kind":"Notebook","sha256":"cd5dc62bb13c17b39b408da08c32ab61f408fa5a841806bd0b9f306dd9e6549e","slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.edc-geodb-4-eurocrops-demo","location":"/external_notebooks/eurodatacube/notebooks/notebooks/contributions/EDC_GeoDB_4_eurocrops_demo.ipynb","dependencies":[],"frontmatter":{"title":"Demonstration of Eurocrops data use in geoDB","content_includes_title":true,"kernelspec":{"name":"python3","display_name":"Python 3","language":"python"},"github":"https://github.com/eurodatacube/example-viewer","subject":"Euro Data Cube Examples","numbering":{"title":{"offset":5}},"edit_url":"https://github.com/eurodatacube/example-viewer/blob/main/external_notebooks/eurodatacube/notebooks/notebooks/contributions/EDC_GeoDB_4_eurocrops_demo.ipynb","exports":[{"format":"ipynb","filename":"EDC_GeoDB_4_eurocrops_demo.ipynb","url":"/example-viewer/build/EDC_GeoDB_4_eurocrop-3228745fe0d617a5dcbe47c5cd4a345b.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-code","data":{"collapsed":true,"execution":{"iopub.execute_input":"2023-03-22T12:54:18.302023Z","iopub.status.busy":"2023-03-22T12:54:18.301421Z","iopub.status.idle":"2023-03-22T12:54:18.427486Z","shell.execute_reply":"2023-03-22T12:54:18.426200Z"},"papermill":{"duration":0.139611,"end_time":"2023-03-22T12:54:18.431875","exception":false,"start_time":"2023-03-22T12:54:18.292264","status":"completed"},"pycharm":{"name":"#%%\n"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"from edc import check_compatibility\ncheck_compatibility(\"user-2023.03-02\", dependencies=[\"GEODB\"])","visibility":"show","key":"W0RQkMVbRg"},{"type":"output","id":"g6gZqOhiC8Mq8jhR9KEsX","data":[{"output_type":"display_data","metadata":{},"data":{"text/html":{"content":"<script type=\"text/javascript\">\n        function toggle(id) {\n            el = document.getElementById(id);\n            el.style.display = el.style.display === \"none\" ? \"block\" : \"none\";\n        }\n    </script>","content_type":"text/html"},"text/plain":{"content":"<IPython.core.display.HTML object>","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"text/html":{"content":"This notebook is compatible with this base image version (user-2023.03-02).","content_type":"text/html"},"text/plain":{"content":"<IPython.core.display.HTML object>","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"text/markdown":{"content":"\n\n---------\n\nThe following environment variables are available:\n\n* `GEODB_AUTH_AUD`, `GEODB_AUTH_CLIENT_ID`, `GEODB_AUTH_DOMAIN`, `GEODB_API_SERVER_URL`, `GEODB_AUTH_CLIENT_SECRET`, `GEODB_API_SERVER_PORT`\n","content_type":"text/markdown"},"text/plain":{"content":"<IPython.core.display.Markdown object>","content_type":"text/plain"}}}],"visibility":"show","key":"vWPgYyDNIw"}],"visibility":"show","key":"jq3dcjVQE3"},{"type":"block","kind":"notebook-content","data":{"collapsed":false,"papermill":{"duration":0.013719,"end_time":"2023-03-22T12:54:18.454781","exception":false,"start_time":"2023-03-22T12:54:18.441062","status":"completed"},"pycharm":{"name":"#%% md\n"},"tags":[]},"children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demonstration of Eurocrops data use in geoDB","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mz5FFpsLqW"}],"identifier":"demonstration-of-eurocrops-data-use-in-geodb","label":"Demonstration of Eurocrops data use in geoDB","html_id":"demonstration-of-eurocrops-data-use-in-geodb","implicit":true,"key":"fMOUOIDySX"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"This notebook demonstrates how the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"VIrGKV8eTS"},{"type":"link","url":"https://github.com/maja601/EuroCrops","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Eurocrops","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"D69ROX4fBI"}],"urlSource":"https://github.com/maja601/EuroCrops","error":true,"key":"wlz7YCKa0J"},{"type":"text","value":" data can be used for analysis, using the geoDB.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"c2WHLgvZv5"}],"key":"KE9X4DERId"}],"visibility":"show","key":"jShyj19UIj"},{"type":"block","kind":"notebook-code","data":{"collapsed":false,"execution":{"iopub.execute_input":"2023-03-22T12:54:18.469176Z","iopub.status.busy":"2023-03-22T12:54:18.467714Z","iopub.status.idle":"2023-03-22T12:54:19.351276Z","shell.execute_reply":"2023-03-22T12:54:19.348010Z"},"papermill":{"duration":0.895674,"end_time":"2023-03-22T12:54:19.356639","exception":false,"start_time":"2023-03-22T12:54:18.460965","status":"completed"},"pycharm":{"name":"#%%\n"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"from xcube_geodb.core.geodb import GeoDBClient\nimport time\n\ngeodb = GeoDBClient()","visibility":"show","key":"KthoSVClwY"},{"type":"output","id":"9dOp6i9JP_mKDkISLFHNz","data":[],"visibility":"show","key":"lgijyfb71n"}],"visibility":"show","key":"Q9H7RPMBxp"},{"type":"block","kind":"notebook-code","data":{"collapsed":false,"execution":{"iopub.execute_input":"2023-03-22T12:54:19.374495Z","iopub.status.busy":"2023-03-22T12:54:19.373748Z","iopub.status.idle":"2023-03-22T12:54:19.382140Z","shell.execute_reply":"2023-03-22T12:54:19.379763Z"},"papermill":{"duration":0.02288,"end_time":"2023-03-22T12:54:19.387288","exception":false,"start_time":"2023-03-22T12:54:19.364408","status":"completed"},"pycharm":{"name":"#%%\n"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# Setting the database name; this database contains the Eurocrops data collections\ndb = 'geodb_b34bfae7-9265-4a3e-b921-06549d3c6035'","visibility":"show","key":"mRTDnMxa3k"},{"type":"output","id":"CBpXz-Z3xeKDyUxZOTKiV","data":[],"visibility":"show","key":"aQwMmDpGwv"}],"visibility":"show","key":"rCfCGn3LsT"},{"type":"block","kind":"notebook-content","data":{"collapsed":false,"papermill":{"duration":0.004361,"end_time":"2023-03-22T12:54:19.396460","exception":false,"start_time":"2023-03-22T12:54:19.392099","status":"completed"},"pycharm":{"name":"#%% md\n"},"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo #1","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Y8Qu9Akkgv"}],"identifier":"demo-1","label":"Demo #1","html_id":"demo-1","implicit":true,"key":"i3HjQ5ARDs"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"This step computes the area growing wheat in NRW (Germany), and measures the time needed to do that. Within the collection ‘DE_NRW_2021_EC21’, the crop types are identified by different codes stored in the column ‘code’; the values 112 and 115 identify wheat, therefore the respective query is ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"otmH72poYs"},{"type":"inlineCode","value":"'or=(code.eq.112,code.eq.115)'","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"oRLypcbsID"},{"type":"text","value":". The sizes of the fields are stored in the column ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"NfWEJGLwC9"},{"type":"inlineCode","value":"'area_ha'","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"Wsp9OQFUCI"},{"type":"text","value":".","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"CkNFUTcJ3V"}],"key":"Knw1GP9W98"}],"visibility":"show","key":"mVXArQ9YKq"},{"type":"block","kind":"notebook-code","data":{"collapsed":false,"execution":{"iopub.execute_input":"2023-03-22T12:54:19.415519Z","iopub.status.busy":"2023-03-22T12:54:19.414932Z","iopub.status.idle":"2023-03-22T12:54:38.324889Z","shell.execute_reply":"2023-03-22T12:54:38.323405Z"},"papermill":{"duration":18.926674,"end_time":"2023-03-22T12:54:38.328787","exception":false,"start_time":"2023-03-22T12:54:19.402113","status":"completed"},"pycharm":{"name":"#%%\n"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"tic = time.perf_counter()\ndf = geodb.get_collection('DE_NRW_2021_EC21', query='or=(code.eq.112,code.eq.115)', database=db)\narea_acc = df['area_ha'].sum()\ntoc = time.perf_counter()\nprint(f\"Computed the area growing wheat in NRW (Germany): {area_acc:0.0f} ha, within {toc - tic} seconds\")","visibility":"show","key":"mHhZ9j6SbT"},{"type":"output","id":"VgmSMr5FDz7gceLcsYiob","data":[{"name":"stdout","output_type":"stream","text":"Computed the area growing wheat in NRW (Germany): 226049 ha, within 18.902114251992316 seconds\n"}],"visibility":"show","key":"zOKKmdtpMF"}],"visibility":"show","key":"mCSd2PBv6u"},{"type":"block","kind":"notebook-content","data":{"collapsed":false,"papermill":{"duration":0.008283,"end_time":"2023-03-22T12:54:38.344240","exception":false,"start_time":"2023-03-22T12:54:38.335957","status":"completed"},"pycharm":{"name":"#%% md\n"},"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo #2","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RBqEtqm4NL"}],"identifier":"demo-2","label":"Demo #2","html_id":"demo-2","implicit":true,"key":"GH6jbK4YqM"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"This step computes the area growing wheat in Belgium, and measures the time needed to do that. Within the collection ‘BE_VLG_2021_EC21’, the crop types are identified by different codes stored in the column ‘gwscod_h’; the values 311 and 312 identify wheat, therefore the respective query is ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"YMdgVjZlnK"},{"type":"inlineCode","value":"'or=(gwscod_h.eq.311,gwscod_h.eq.312)'","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"V6bu0yjkwC"},{"type":"text","value":". The sizes of the fields are stored in the column ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"WIS9QPWarU"},{"type":"inlineCode","value":"'graf_opp'","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"zD1z9uKVAZ"}],"key":"rJxVxCQbrI"}],"visibility":"show","key":"xBy6XX8Ixd"},{"type":"block","kind":"notebook-code","data":{"collapsed":false,"execution":{"iopub.execute_input":"2023-03-22T12:54:38.361733Z","iopub.status.busy":"2023-03-22T12:54:38.361283Z","iopub.status.idle":"2023-03-22T12:54:45.204368Z","shell.execute_reply":"2023-03-22T12:54:45.202928Z"},"papermill":{"duration":6.856421,"end_time":"2023-03-22T12:54:45.208210","exception":false,"start_time":"2023-03-22T12:54:38.351789","status":"completed"},"pycharm":{"name":"#%%\n"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"tic = time.perf_counter()\ndf = geodb.get_collection('BE_VLG_2021_EC21', query='or=(gwscod_h.eq.311,gwscod_h.eq.312)', database=db)\narea_acc = df['graf_opp'].sum()\ntoc = time.perf_counter()\nprint(f\"Computed the area growing wheat in Belgium (VLG): {area_acc:0.0f} ha, within {toc - tic} seconds\")","visibility":"show","key":"Mr0FRdurIF"},{"type":"output","id":"IoWXbwIK3186820zZYHL2","data":[{"name":"stdout","output_type":"stream","text":"Computed the area growing wheat in Belgium (VLG): 71014 ha, within 6.835164927993901 seconds\n"}],"visibility":"show","key":"wV4Y2OZmZX"}],"visibility":"show","key":"MQgC9lO9PX"},{"type":"block","kind":"notebook-content","data":{"collapsed":false,"papermill":{"duration":0.004687,"end_time":"2023-03-22T12:54:45.217460","exception":false,"start_time":"2023-03-22T12:54:45.212773","status":"completed"},"pycharm":{"name":"#%% md\n"},"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo #3","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Uqmvs2a1DV"}],"identifier":"demo-3","label":"Demo #3","html_id":"demo-3","implicit":true,"key":"niN6WDuiMW"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"This step extracts 1000 fields growing wheat in Austria. Within the collection ‘AT_2021_EC21’, the crop types are identified by different codes stored in the column ‘snar_code’; the values 140, 168 and 170 identify wheat, and the column ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"E1sVnlTdcf"},{"type":"inlineCode","value":"'sl_flaeche'","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"w9keIy3VGp"},{"type":"text","value":" stores the sizes of the fields.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"dhXC64j9KK"}],"key":"pEYMe1aXOY"}],"visibility":"show","key":"bDA9E4vYWj"},{"type":"block","kind":"notebook-code","data":{"collapsed":false,"execution":{"iopub.execute_input":"2023-03-22T12:54:45.304077Z","iopub.status.busy":"2023-03-22T12:54:45.302974Z","iopub.status.idle":"2023-03-22T12:55:23.985919Z","shell.execute_reply":"2023-03-22T12:55:23.983823Z"},"papermill":{"duration":38.707864,"end_time":"2023-03-22T12:55:23.993605","exception":false,"start_time":"2023-03-22T12:54:45.285741","status":"completed"},"pycharm":{"name":"#%%\n"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"tic = time.perf_counter()\ndf = geodb.get_collection('AT_2021_EC21', query='and=(or(snar_code.eq.140,snar_code.eq.168,snar_code.eq.170),sl_flaeche.gt.1)', database=db, limit=1000)\ntoc = time.perf_counter()\nprint(f\"Extracted 1000 areas in Austria growing wheat, larger than 1 ha, within {toc - tic} seconds\")","visibility":"show","key":"L5glVdA2Fs"},{"type":"output","id":"gfycXzQBv5hosKboNhn7c","data":[{"name":"stdout","output_type":"stream","text":"Extracted 1000 areas in Austria growing wheat, larger than 1 ha, within 38.67284113999631 seconds\n"}],"visibility":"show","key":"vSNVmuICLq"}],"visibility":"show","key":"CHlZEExDK8"}],"key":"mOrFdxEOFZ"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"xcube-gen and xcube-geodb Hands-On Workshop Φ-Week 2020","url":"/external-notebooks/eurodatacube/notebooks/notebooks/contributions/edc-demo-phi-week-v2","group":"Contributions"},"next":{"title":"South Africa Crop Type Classification on Euro Data Cube (EDC)","url":"/external-notebooks/eurodatacube/notebooks/notebooks/contributions/edc-notebook-lstm","group":"Contributions"}}},"domain":"http://localhost:3000"}