{"version":1,"kind":"Notebook","sha256":"afb5984a5b7dd91237114f9a9aef76a3d171fdfbe5d42d72ac8a5ce7cb7d716f","slug":"external-notebooks.eurodatacube.notebooks.notebooks.curated.edc-sentinelhub-datafusion-basic","location":"/external_notebooks/eurodatacube/notebooks/notebooks/curated/EDC_SentinelHub_DataFusion_Basic.ipynb","dependencies":[],"frontmatter":{"title":"EDC Sentinel Hub: Data Fusion","content_includes_title":true,"kernelspec":{"name":"conda-env-users-edc-2023.10-01-py","display_name":"EDC 2021.12 (Python3)","language":"python"},"github":"https://github.com/eurodatacube/example-viewer","subject":"Euro Data Cube Examples","numbering":{"title":{"offset":5}},"edit_url":"https://github.com/eurodatacube/example-viewer/blob/main/external_notebooks/eurodatacube/notebooks/notebooks/curated/EDC_SentinelHub_DataFusion_Basic.ipynb","exports":[{"format":"ipynb","filename":"EDC_SentinelHub_DataFusion_Basic.ipynb","url":"/example-viewer/build/EDC_SentinelHub_Data-7cca6b146d922546e7970901aaf68dc1.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:56:33.502499Z","iopub.status.busy":"2023-10-24T07:56:33.502093Z","iopub.status.idle":"2023-10-24T07:56:33.551261Z","shell.execute_reply":"2023-10-24T07:56:33.550686Z"},"papermill":{"duration":0.073325,"end_time":"2023-10-24T07:56:33.552562","exception":false,"start_time":"2023-10-24T07:56:33.479237","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"from edc import check_compatibility\ncheck_compatibility(\"user-2023.10-01\", dependencies=[\"SH\"])","visibility":"show","key":"JHaTRVMGjV"},{"type":"output","id":"Hbj1W2pCep45SbygdmJCo","data":[{"output_type":"display_data","metadata":{},"data":{"text/html":{"content":"<script type=\"text/javascript\">\n        function toggle(id) {\n            el = document.getElementById(id);\n            el.style.display = el.style.display === \"none\" ? \"block\" : \"none\";\n        }\n    </script>","content_type":"text/html"},"text/plain":{"content":"<IPython.core.display.HTML object>","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"text/html":{"content":"This notebook is compatible with this base image version (user-2023.10-01).","content_type":"text/html"},"text/plain":{"content":"<IPython.core.display.HTML object>","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"text/markdown":{"content":"\n\n---------\n\nThe following environment variables are available:\n\n* `SH_CLIENT_ID`, `SH_INSTANCE_ID`, `SH_CLIENT_NAME`, `SH_CLIENT_SECRET`\n","content_type":"text/markdown"},"text/plain":{"content":"<IPython.core.display.Markdown object>","content_type":"text/plain"}}}],"visibility":"show","key":"D3DVMVlLxB"}],"visibility":"show","key":"Z6t5xEUfu3"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.021209,"end_time":"2023-10-24T07:56:33.614061","exception":false,"start_time":"2023-10-24T07:56:33.592852","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"EDC Sentinel Hub: Data Fusion","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aZdgddstvA"}],"identifier":"edc-sentinel-hub-data-fusion","label":"EDC Sentinel Hub: Data Fusion","html_id":"edc-sentinel-hub-data-fusion","implicit":true,"key":"P9Rko1HU2u"},{"type":"heading","depth":2,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Example 1: Filling clouds in a Sentinel-2 image with Sentinel-1 SAR data","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"IjavMLIckb"}],"identifier":"example-1-filling-clouds-in-a-sentinel-2-image-with-sentinel-1-sar-data","label":"Example 1: Filling clouds in a Sentinel-2 image with Sentinel-1 SAR data","html_id":"example-1-filling-clouds-in-a-sentinel-2-image-with-sentinel-1-sar-data","implicit":true,"key":"iqbiR25TyL"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"This notebook shows how to request ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"UcIHG3AFbN"},{"type":"link","url":"https://docs.sentinel-hub.com/api/latest/#/data/Sentinel-1-GRD","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"S1 GRD","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"U3pi7MYvgW"}],"urlSource":"https://docs.sentinel-hub.com/api/latest/#/data/Sentinel-1-GRD","key":"KwtN775r3t"},{"type":"text","value":" and ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"zNDuIxvEUZ"},{"type":"link","url":"https://docs.sentinel-hub.com/api/latest/#/data/Sentinel-2-L2A","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"S2 L1A","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"QiYZSnTy1U"}],"urlSource":"https://docs.sentinel-hub.com/api/latest/#/data/Sentinel-2-L2A","key":"CB1bHIlXTG"},{"type":"text","value":" from the ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"qILnnoeZoO"},{"type":"link","url":"https://docs.sentinel-hub.com/api/latest/#/API/","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Sentinel Hub API","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"karEEPaGx5"}],"urlSource":"https://docs.sentinel-hub.com/api/latest/#/API/","key":"um7LSC9FwZ"},{"type":"text","value":", and how to merge the data in an ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Uw8NoNmIFK"},{"type":"link","url":"https://docs.sentinel-hub.com/api/latest/#/Evalscript/","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"evalscript","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"JTWkhW8OpD"}],"urlSource":"https://docs.sentinel-hub.com/api/latest/#/Evalscript/","key":"pC8ewEXXeH"},{"type":"text","value":".","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"FP3U8BexUQ"}],"key":"TRW6jQlwKS"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"The S2 True Color composition is returned (R: B04, G: B03, B: B02), whereas cloud covered areas are replaced by the S1 VV polarization band.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"mjb87rGtFS"}],"key":"rnrB6BAlue"},{"type":"heading","depth":3,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Prerequisites","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"vsXI6FLXdl"}],"identifier":"prerequisites","label":"Prerequisites","html_id":"prerequisites","implicit":true,"key":"oOXYzNuKBJ"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"This notebook requires an active subscription to:","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"G3WY8m2985"}],"key":"NtcUxqRh0J"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"EDC Sentinel Hub","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"jKTZMSFp4w"}],"key":"FAyqn5geOR"}],"key":"QGaeNrpLJm"}],"visibility":"show","key":"NnKRjcjsra"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:56:33.671120Z","iopub.status.busy":"2023-10-24T07:56:33.670714Z","iopub.status.idle":"2023-10-24T07:56:33.695942Z","shell.execute_reply":"2023-10-24T07:56:33.695556Z"},"papermill":{"duration":0.050262,"end_time":"2023-10-24T07:56:33.697019","exception":false,"start_time":"2023-10-24T07:56:33.646757","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# Request tools imports\nfrom oauthlib.oauth2 import BackendApplicationClient\nfrom requests_oauthlib import OAuth2Session","visibility":"show","key":"cZ7u1EXrKP"},{"type":"output","id":"Sml_Ny82oQXmdS0A8XFwd","data":[],"visibility":"show","key":"p714Vv1hkh"}],"visibility":"show","key":"rpwiCGqTLj"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:56:33.755017Z","iopub.status.busy":"2023-10-24T07:56:33.754622Z","iopub.status.idle":"2023-10-24T07:56:33.935490Z","shell.execute_reply":"2023-10-24T07:56:33.934966Z"},"papermill":{"duration":0.204824,"end_time":"2023-10-24T07:56:33.936901","exception":false,"start_time":"2023-10-24T07:56:33.732077","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# Utilities\nimport os\nimport shapely.geometry\nimport IPython.display","visibility":"show","key":"zGy5ng9tiB"},{"type":"output","id":"MtNZzPDpK6p41Dg8Yuxco","data":[],"visibility":"show","key":"O4IoDX6Zjp"}],"visibility":"show","key":"Jdz8s1OgIc"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:56:33.990832Z","iopub.status.busy":"2023-10-24T07:56:33.990327Z","iopub.status.idle":"2023-10-24T07:56:34.380131Z","shell.execute_reply":"2023-10-24T07:56:34.379667Z"},"papermill":{"duration":0.410318,"end_time":"2023-10-24T07:56:34.381531","exception":false,"start_time":"2023-10-24T07:56:33.971213","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"%matplotlib inline","visibility":"show","key":"YZXncePZfk"},{"type":"output","id":"F1DYUlAkudwNu1Uskmmeo","data":[],"visibility":"show","key":"AityLpOCui"}],"visibility":"show","key":"tMv4N6Rtui"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.019967,"end_time":"2023-10-24T07:56:34.435750","exception":false,"start_time":"2023-10-24T07:56:34.415783","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Setup","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lbyGkNxwqP"}],"identifier":"setup","label":"Setup","html_id":"setup","implicit":true,"key":"GGyB3wGOwi"}],"visibility":"show","key":"lM8yPrvlNv"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:56:34.495595Z","iopub.status.busy":"2023-10-24T07:56:34.495184Z","iopub.status.idle":"2023-10-24T07:56:34.498484Z","shell.execute_reply":"2023-10-24T07:56:34.498049Z"},"papermill":{"duration":0.024398,"end_time":"2023-10-24T07:56:34.499442","exception":false,"start_time":"2023-10-24T07:56:34.475044","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# Pass the Sentinel Hub Client ID and Secret to variables to be used in the request.\nmy_client_id = %env SH_CLIENT_ID\nmy_client_secret = %env SH_CLIENT_SECRET","visibility":"show","key":"DQjKMNbcrU"},{"type":"output","id":"fTZW8yNbqpuo9ad-CVsY1","data":[],"visibility":"show","key":"OLQFdFGfhG"}],"visibility":"show","key":"lnq9IovWOX"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:56:34.563334Z","iopub.status.busy":"2023-10-24T07:56:34.562885Z","iopub.status.idle":"2023-10-24T07:56:34.565867Z","shell.execute_reply":"2023-10-24T07:56:34.565455Z"},"papermill":{"duration":0.025819,"end_time":"2023-10-24T07:56:34.566817","exception":false,"start_time":"2023-10-24T07:56:34.540998","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# Create an OAuth2 session based on the client ID\nclient = BackendApplicationClient(client_id=my_client_id)\noauth = OAuth2Session(client=client)","visibility":"show","key":"OIHRZZk1q4"},{"type":"output","id":"82oUces5ruTtbLWSs50Py","data":[],"visibility":"show","key":"T1MXm5U6Ce"}],"visibility":"show","key":"yLH6X32L3B"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.020859,"end_time":"2023-10-24T07:56:34.618017","exception":false,"start_time":"2023-10-24T07:56:34.597158","status":"completed"},"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The Sentinel Hub API uses OAuth2 Authentication and requires that you have an ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MkFKGMNlqk"},{"type":"link","url":"https://docs.sentinel-hub.com/api/latest/#/API/authentication","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"access token","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IT2MPNqBgS"}],"urlSource":"https://docs.sentinel-hub.com/api/latest/#/API/authentication","key":"QQMU6WNkIk"},{"type":"text","value":". These tokens are limited in time, but a new one can be requested with the following command.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KA6vmqtcyF"}],"key":"gnmxFbVUdI"}],"visibility":"show","key":"aTFcVFck4y"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:56:34.672152Z","iopub.status.busy":"2023-10-24T07:56:34.671754Z","iopub.status.idle":"2023-10-24T07:56:34.732192Z","shell.execute_reply":"2023-10-24T07:56:34.731627Z"},"papermill":{"duration":0.083735,"end_time":"2023-10-24T07:56:34.733701","exception":false,"start_time":"2023-10-24T07:56:34.649966","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# Get a token for the session\ntoken = oauth.fetch_token(token_url='https://services.sentinel-hub.com/oauth/token',\n                          client_id=my_client_id, client_secret=my_client_secret)","visibility":"show","key":"Xe0iKFWuJw"},{"type":"output","id":"eDeXYFLmXolfwu1ulSGlU","data":[],"visibility":"show","key":"CogAVwI48a"}],"visibility":"show","key":"lLkD6LgPhU"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.020019,"end_time":"2023-10-24T07:56:34.788944","exception":false,"start_time":"2023-10-24T07:56:34.768925","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Setting an area of interest","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CyWqAhwwBm"}],"identifier":"setting-an-area-of-interest","label":"Setting an area of interest","html_id":"setting-an-area-of-interest","implicit":true,"key":"FtwGSjUjOO"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"We will download Sentinel-1 and Sentinel-2  imagery of the hills located to the North of # Ljubljana, Slovenia.\nThe bounding box is in the WGS84 coordinate system, and consists of the longitude and latitude coordinates of lower left and upper right corners.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"jBmFtRL2lR"}],"key":"EkJ7YxBsrz"}],"visibility":"show","key":"Lzm4kjAbw9"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:56:34.843878Z","iopub.status.busy":"2023-10-24T07:56:34.843517Z","iopub.status.idle":"2023-10-24T07:56:34.846400Z","shell.execute_reply":"2023-10-24T07:56:34.845976Z"},"papermill":{"duration":0.025788,"end_time":"2023-10-24T07:56:34.847378","exception":false,"start_time":"2023-10-24T07:56:34.821590","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# Set bounding box coordinates for the area of interest\nbbox = (14.37595, 46.09347, 14.56924, 46.19266)","visibility":"show","key":"pqNNCGR2VM"},{"type":"output","id":"4LV44AXThs5Aupehu6C8o","data":[],"visibility":"show","key":"A4zjHKH2Nl"}],"visibility":"show","key":"GHzHd42beS"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:56:34.900119Z","iopub.status.busy":"2023-10-24T07:56:34.899796Z","iopub.status.idle":"2023-10-24T07:56:34.904115Z","shell.execute_reply":"2023-10-24T07:56:34.903705Z"},"papermill":{"duration":0.026028,"end_time":"2023-10-24T07:56:34.905118","exception":false,"start_time":"2023-10-24T07:56:34.879090","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# Display the coordinates on a map\nIPython.display.GeoJSON(shapely.geometry.box(*bbox).__geo_interface__)","visibility":"show","key":"pEqHInNtEf"},{"type":"output","id":"O0iTpNGoac6J66XTsRWZW","data":[{"output_type":"display_data","metadata":{"application/geo+json":{"expanded":false,"root":"root"}},"data":{"application/geo+json":{"content":"{\"coordinates\":[[[14.56924,46.09347],[14.56924,46.19266],[14.37595,46.19266],[14.37595,46.09347],[14.56924,46.09347]]],\"type\":\"Polygon\"}","content_type":"application/geo+json"},"text/plain":{"content":"<IPython.display.GeoJSON object>","content_type":"text/plain"}}}],"visibility":"show","key":"SYcH9TwKnV"}],"visibility":"show","key":"yqheYTSfJ1"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.021401,"end_time":"2023-10-24T07:56:34.957205","exception":false,"start_time":"2023-10-24T07:56:34.935804","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"API request","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Yh78g7AFgn"}],"identifier":"api-request","label":"API request","html_id":"api-request","implicit":true,"key":"f4cWVQ63Zg"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We need to specify arguments to send a POST request, more information about all the availaible options ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ROWQjHMjiT"},{"type":"link","url":"https://docs.sentinel-hub.com/api/latest/reference/#operation/process","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"here","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"dnbFTH8JuM"}],"urlSource":"https://docs.sentinel-hub.com/api/latest/reference/#operation/process","key":"j30J7BsqD3"},{"type":"text","value":":","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Bv5YK8Rayq"}],"key":"EmoVBSGZk9"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"The access point URL:  set it to ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"U1xeni2JcW"},{"type":"inlineCode","value":"https://services.sentinel-hub.com/api/v1/process","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"QINgnRnJVl"}],"key":"IUGr0zOemk"}],"key":"n4lBhMYjRP"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"inlineCode","value":"json","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"wqsd8jIUwC"},{"type":"text","value":" - the contents of the request containing:","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"AzMQ2K8oX2"}],"key":"yxGU0l70Nr"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":8,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"inlineCode","value":"input","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"Ru8DMxAQfb"},{"type":"text","value":": (required) specifies the data to request:","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"UghrRs0lQS"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":9,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"inlineCode","value":"bounds","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"VuNFaYxpkZ"},{"type":"text","value":": defines the request bounds by specifying the bounding box and/or geometry for the request.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"O1ALIdy4oS"}],"key":"VzRo3PBFCa"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"inlineCode","value":"data","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"G0SORvucfR"},{"type":"text","value":": describes the data being requested along with certain processing and filtering parameters.","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"JOwj5C0V3H"}],"key":"GN6vgd1YVl"}],"key":"W3hA5JZg6s"}],"key":"J6iFAKgWZw"},{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"inlineCode","value":"output","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"nrCLAcrguz"},{"type":"text","value":": (optional) allows to set parameters for the returned data","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"PVsITyYPq7"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":12,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"inlineCode","value":"width","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"e2onkrGjOs"},{"type":"text","value":": The request image width. Must be an integer between 1 and 2500.","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"o8XbUwVxWH"}],"key":"eoPZ1LkhXt"},{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"inlineCode","value":"height","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"TrdtQUdceX"},{"type":"text","value":": The request image height. Must be an integer between 1 and 2500.","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"olyxhmslpP"}],"key":"DLGWcXRX18"}],"key":"TQ52CbYMXn"}],"key":"AsSrf9TTwV"},{"type":"listItem","spread":true,"position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"inlineCode","value":"evalscript","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"wzlMMDRgZP"},{"type":"text","value":": calculates the output values for each pixel","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"tgBudv9RMw"}],"key":"VJexi19czK"}],"key":"QuKZIW0yYs"}],"key":"nG41gkfWXx"}],"key":"x11XbKeUYV"}],"visibility":"show","key":"bGVozhzMEE"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.022497,"end_time":"2023-10-24T07:56:35.012624","exception":false,"start_time":"2023-10-24T07:56:34.990127","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Step 1","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DT5esVaooC"}],"identifier":"step-1","label":"Step 1","html_id":"step-1","implicit":true,"key":"R5QbR924pL"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"First, set the input options. The options are set in the form of a dictionary with key/values pairs.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"ydhBQ1h584"}],"key":"PE0P9zGa9E"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":4,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Specify the bounds of your request using the bounding box previously described and specifying the ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"kvWXJznAbg"},{"type":"link","url":"https://docs.sentinel-hub.com/api/latest/#/API/crs?id=crs-support","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"projection","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"LyylV5Kju4"}],"urlSource":"https://docs.sentinel-hub.com/api/latest/#/API/crs?id=crs-support","key":"JYjFMyNnl9"},{"type":"text","value":" (one of the CRS supported by Sentinel Hub API).","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"JnlLGARByp"}],"key":"TuUi5BZd2q"}],"key":"lINMWsfphj"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Specify the data to fetch. As in this example there are 2 data sources (Sentinel-1 and Sentinel-2), the options for each sensor are specified in a list of dictionaries.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"J4kKflB3pC"}],"key":"clMnrHa44o"}],"key":"fqjxOpuaKy"}],"key":"elfn0lT4GQ"}],"visibility":"show","key":"bM0kFJkdAY"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:56:35.068394Z","iopub.status.busy":"2023-10-24T07:56:35.068044Z","iopub.status.idle":"2023-10-24T07:56:35.071649Z","shell.execute_reply":"2023-10-24T07:56:35.071142Z"},"papermill":{"duration":0.025214,"end_time":"2023-10-24T07:56:35.072662","exception":false,"start_time":"2023-10-24T07:56:35.047448","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# 1. Bounds \nbounds = {\"properties\":{\"crs\":\"http://www.opengis.net/def/crs/OGC/1.3/CRS84\"}, \"bbox\": bbox}\n\n# 2. Data\ndata = [{\"id\": \"s1\", \n         \"type\": \"S1GRD\",\n          \"dataFilter\": {\"timeRange\": {\"from\": \"2020-02-01T00:00:00Z\",\n                                       \"to\": \"2020-02-06T00:00:00Z\"},\n                         \"mosaickingOrder\": \"mostRecent\"}},\n         {\"id\": \"l2a\",\n          \"type\": \"S2L2A\",\n          \"dataFilter\": {\"timeRange\": {\"from\": \"2020-02-01T00:00:00Z\",\n                                       \"to\": \"2020-02-06T00:00:00Z\"},\n                         \"mosaickingOrder\": \"mostRecent\"}}]\n# Set the options to the input\ninput_options = {\"bounds\": bounds, \"data\": data,}","visibility":"show","key":"wpvrruqeWn"},{"type":"output","id":"2QhhsAQNP8yu6teudQUmb","data":[],"visibility":"show","key":"JR10neKMtL"}],"visibility":"show","key":"mBRqDjmlMZ"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.020207,"end_time":"2023-10-24T07:56:35.130107","exception":false,"start_time":"2023-10-24T07:56:35.109900","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Step 2","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kD6dYyK5pS"}],"identifier":"step-2","label":"Step 2","html_id":"step-2","implicit":true,"key":"z9RmSzq5cW"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Then set the output options. The default output size of the requested image is 256x256 pixels, so here we will modify the output to be larger. The result will be displayed only, therefore we also set the output format to jpeg.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"aFJ3Mg5JNU"}],"key":"w6MDdJ4rME"}],"visibility":"show","key":"AlKv2Z8IDw"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:56:35.190526Z","iopub.status.busy":"2023-10-24T07:56:35.190195Z","iopub.status.idle":"2023-10-24T07:56:35.193917Z","shell.execute_reply":"2023-10-24T07:56:35.193288Z"},"papermill":{"duration":0.026234,"end_time":"2023-10-24T07:56:35.195114","exception":false,"start_time":"2023-10-24T07:56:35.168880","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"output_options = {\"width\": 640, \"height\": 640, \"responses\": [{\"format\": {\"type\": \"image/jpeg\",\n                                                                         \"quality\": 90}}]}","visibility":"show","key":"uunsEI8JpE"},{"type":"output","id":"TY0HTfLSSVUCFDG-CBdrQ","data":[],"visibility":"show","key":"uOEeIWal9V"}],"visibility":"show","key":"zWvLc0dBl2"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.021376,"end_time":"2023-10-24T07:56:35.255508","exception":false,"start_time":"2023-10-24T07:56:35.234132","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Step 3","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NMeRuEjtob"}],"identifier":"step-3","label":"Step 3","html_id":"step-3","implicit":true,"key":"NvdEvdtRMC"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"yjGwrcjbmF"},{"type":"link","url":"https://docs.sentinel-hub.com/api/latest/#/Evalscript/","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"evalscript","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"kqNrNtH7Zg"}],"urlSource":"https://docs.sentinel-hub.com/api/latest/#/Evalscript/","key":"crNI9H7php"},{"type":"text","value":" is a piece of javascript code that allows to process the pixels of the images that are returned.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"t8M4o7vUVm"}],"key":"PALOhilu97"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"In the current example, the S1 and S2 bands needed are called in the ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"MB1WzAhTkv"},{"type":"inlineCode","value":"setup","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"GSgjWj2jmA"},{"type":"text","value":" function of the script.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"cpi7jMZzW0"}],"key":"hixLriCd8j"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"xEm4PLlJDe"},{"type":"inlineCode","value":"evaluatePixel","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"vzrRm5j2Su"},{"type":"text","value":" function returns the S1 VV polarization band for the pixels in the S2-L2A SCL band (see ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"tEiLSyseK9"},{"type":"link","url":"https://docs.sentinel-hub.com/api/latest/#/data/Sentinel-2-L2A","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"here","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"b7p9sKjYPJ"}],"urlSource":"https://docs.sentinel-hub.com/api/latest/#/data/Sentinel-2-L2A","key":"ydkXq3yivY"},{"type":"text","value":") classified as:","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"fVboTpG0zj"}],"key":"Z0zr2wJIJD"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":9,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"7 - Clouds low probability / Unclassified","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"CaW4ndZN1c"}],"key":"Fx3kkRRDtE"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"8 - Clouds medium probability","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"Fima5aTh2i"}],"key":"k9n2m58VIA"},{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"9 - Clouds high probability","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"A5fByQ5tAE"}],"key":"rfGNHmW4aH"},{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"10 - Cirrus","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"lGnF2lMxQx"}],"key":"s3cj5uwNMN"}],"key":"aSw0XkdxFA"},{"type":"paragraph","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"For all the other pixels the S2 ","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"Ph20pY5Vwo"},{"type":"link","url":"https://www.sentinel-hub.com/eoproducts/true-color","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"True Color","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"ldQVdF3tXa"}],"urlSource":"https://www.sentinel-hub.com/eoproducts/true-color","key":"ObkIOq8so2"},{"type":"text","value":" visualisation is returned (scaled by 2.5 for better viewing).","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"tRFv6K4NLv"}],"key":"zlUxJbMSHp"}],"visibility":"show","key":"uEAuhPmQlx"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:56:35.313419Z","iopub.status.busy":"2023-10-24T07:56:35.313093Z","iopub.status.idle":"2023-10-24T07:56:35.315998Z","shell.execute_reply":"2023-10-24T07:56:35.315604Z"},"papermill":{"duration":0.02479,"end_time":"2023-10-24T07:56:35.316910","exception":false,"start_time":"2023-10-24T07:56:35.292120","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"evascript = \"\"\"\n//VERSION=3\nfunction setup (){\n  return {\n    input: [\n      {datasource: \"s1\", bands:[\"VV\"]},\n      {datasource: \"l2a\", bands:[\"B02\", \"B03\", \"B04\", \"SCL\"], units:[\"REFLECTANCE\", \"REFLECTANCE\", \"REFLECTANCE\", \"DN\"]}],\n    output: [\n      {id: \"default\", bands: 3, sampleType: SampleType.AUTO}\n    ]\n  }\n}\nfunction evaluatePixel(samples, inputData, inputMetadata, customData, outputMetadata) {\n  var sample = samples.s1[0]\n  var sample2 = samples.l2a[0]\n  \n  if ([7, 8, 9, 10].includes(sample2.SCL)) {\n    return {\n      default: [sample.VV, sample.VV, sample.VV]\n    }\n  } else {\n    return {\n      default: [sample2.B04*2.5, sample2.B03*2.5, sample2.B02*2.5]\n    }\n  }\n}\n\"\"\"","visibility":"show","key":"SE7e99I98C"},{"type":"output","id":"LzeQSKGzS9g2TCoVkiyGJ","data":[],"visibility":"show","key":"o24AHM41uQ"}],"visibility":"show","key":"TG9YAmI8rd"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.022966,"end_time":"2023-10-24T07:56:35.375716","exception":false,"start_time":"2023-10-24T07:56:35.352750","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Step 4 (final)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"f3YYktFmqd"}],"identifier":"step-4-final","label":"Step 4 (final)","html_id":"step-4-final","implicit":true,"key":"ah3Auwuvlm"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The different parts of the request built above are merged together in the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"TdjSEWXQm5"},{"type":"inlineCode","value":"oauth.post","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"YMF2r0wtUw"},{"type":"text","value":" command and the request is posted. If all the elements are correct, the command should return a ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"khvbN2iMuJ"},{"type":"inlineCode","value":"200","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"myFVY3FWck"},{"type":"text","value":" status.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"jrU76zK7Ue"}],"key":"Zp1VksQ0q7"}],"visibility":"show","key":"rJ7HEK0NhY"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:56:35.430469Z","iopub.status.busy":"2023-10-24T07:56:35.430217Z","iopub.status.idle":"2023-10-24T07:56:37.370814Z","shell.execute_reply":"2023-10-24T07:56:37.369560Z"},"papermill":{"duration":1.963775,"end_time":"2023-10-24T07:56:37.372005","exception":false,"start_time":"2023-10-24T07:56:35.408230","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"response = oauth.post('https://services.sentinel-hub.com/api/v1/process',\n  json={\"input\": input_options,\n        \"evalscript\": evascript,\n        \"output\": output_options,\n})\n\nprint(\"Request status: %s, %s\" % (response.status_code, response.reason))","visibility":"show","key":"ot4X4GcXCL"},{"type":"output","id":"9gD0YjvSs0pjM785eqhBP","data":[{"name":"stdout","output_type":"stream","text":"Request status: 200, OK\n"}],"visibility":"show","key":"FJC8wVeNKz"}],"visibility":"show","key":"GUj0fh9RVF"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.019299,"end_time":"2023-10-24T07:56:37.425915","exception":false,"start_time":"2023-10-24T07:56:37.406616","status":"completed"},"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"If the request was successful, you can now observe the image:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XTEfN0qkLq"}],"key":"ZjaXP6HKqE"}],"visibility":"show","key":"cF4WvVMysX"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:56:37.479052Z","iopub.status.busy":"2023-10-24T07:56:37.478715Z","iopub.status.idle":"2023-10-24T07:56:37.523228Z","shell.execute_reply":"2023-10-24T07:56:37.522775Z"},"papermill":{"duration":0.067192,"end_time":"2023-10-24T07:56:37.525023","exception":false,"start_time":"2023-10-24T07:56:37.457831","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"IPython.display.Image(response.content)","visibility":"show","key":"jlfgZMpTdn"},{"type":"output","id":"UOUZERpGaKHH5MWNY18GP","data":[{"output_type":"execute_result","execution_count":14,"metadata":{},"data":{"image/jpeg":{"content_type":"image/jpeg","hash":"dac62c10216069ba7aba60bb63c78e69","path":"/example-viewer/build/dac62c10216069ba7aba60bb63c78e69.jpeg"},"text/plain":{"content":"<IPython.core.display.Image object>","content_type":"text/plain"}}}],"visibility":"show","key":"cM2qsnhcFI"}],"visibility":"show","key":"MIHw5HaIve"}],"key":"dUqE10b38F"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"EDC Sentinel Hub - data access using xcube","url":"/external-notebooks/eurodatacube/notebooks/notebooks/curated/edc-sentinel-hub-data-access","group":"Curated"},"next":{"title":"EDC Sentinel Hub: Data Fusion","url":"/external-notebooks/eurodatacube/notebooks/notebooks/curated/edc-sentinelhub-datafusion-ndvi","group":"Curated"}}},"domain":"http://localhost:3000"}